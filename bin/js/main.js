"use strict";var é=function(e){return document.querySelector(e)},ç=function(e){return document.createElement(e)},Parser=function(){function e(e){var t={ajax:function(e,t){var n=new Promise(function(n,r){var i=new XMLHttpRequest,a=t;i.open(e,a),i.send(),i.onload=function(){this.status>=200&&this.status<300?n(this.response):r(this.statusText)},i.onerror=function(){r(this.statusText)}});return n}};return{get:function(){return t.ajax("GET",e)}}}return{fetchContent:function(){function t(t,n){var r=n?t:"bin/js/json/"+t+".json",i={success:function(e){e=n?e:JSON.parse(e),n?Render.getPart(e,n):Render.buildList(e,t)},error:function(e){throw new Error(e)}};e(r).get().then(i.success).catch(i.error)}var n=new Map([["header","bin/partials/header.html"],[".contact","bin/partials/contact.html"],["aside","bin/partials/aside.html"]]),r=["experience"],i=!0,a=!1,s=void 0;try{for(var o,c=n[Symbol.iterator]();!(i=(o=c.next()).done);i=!0){var l=o.value;t(l[1],l[0])}}catch(e){a=!0,s=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw s}}var d=!0,u=!1,g=void 0;try{for(var f,h=r[Symbol.iterator]();!(d=(f=h.next()).done);d=!0){var m=f.value;t(m)}}catch(e){u=!0,g=e}finally{try{!d&&h.return&&h.return()}finally{if(u)throw g}}},fetchGigs:function(){var t="//spreadsheets.google.com/feeds/list/1Tf2vRy6me9F3knQSA5FpfvrTLuNetlkd0Mmb2P20Jqo/1/public/values?alt=json",n={success:function(e){var t=JSON.parse(e),n=t.feed.entry,r=t.feed.updated.$t;r="Last updated: "+r.substr(0,10),é(".mdl-spinner").remove(),é("#scroll-tab-1 .mdl-tooltip").innerHTML=r;var i=document.getElementById("giglist");for(var a in n)if(a>0&&Gigs.gigList(n[a].gsx$headline.$t,n[a].gsx$text.$t,n[a].gsx$startdate.$t),a==n.length-1){sorttable.makeSortable(i);var s={valueNames:["gig-name","gig-location","gig-date"]};new List("attended-gigs",s)}},error:function(e){throw new Error(e)}};e(t).get().then(n.success).catch(n.error)}}}(),Render={settings:{createEl:"div",parentEl:"main"},buildList:function(e,t){function n(e,t,n){return e=ç(e),e.appendChild(document.createTextNode(t)),n&&e.setAttribute("href","//"+t),e}e=e.items;var r=é("."+t),i=ç("ul"),a=!0,s=!1,o=void 0;try{for(var c,l=e[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){for(var d=c.value,u=ç("li"),g=[n("h2",d.title),n("h3",d.position),n("time",d.dateFrom),n("span","—"),n("time",d.dateTo),d.url&&n("a",d.url,1)],f=document.createDocumentFragment(),h=0;h<g.length;h++)g[h]&&f.appendChild(g[h]);u.appendChild(f),i.appendChild(u)}}catch(e){s=!0,o=e}finally{try{!a&&l.return&&l.return()}finally{if(s)throw o}}r.appendChild(i)},getPart:function(e,t){if(~t.indexOf(".")){t=t.substr(1);var n=ç(this.settings.createEl);n.classList.add(t),n.innerHTML=e,n.onclick=Interact.toggleClicked;var r=é(this.settings.parentEl);r.appendChild(n)}else{var i=é(t);n=ç(t),n.innerHTML=e,n.onclick=Interact.toggleClicked,document.body.replaceChild(n,i),~t.indexOf("aside")&&Age.calc()}},init:function(){Request.isIndex()&&Parser.fetchContent(),Request.isPage("/gigs/")&&Parser.fetchGigs()}},Interact={toggleClicked:function(){var e=this.nodeName;if("HEADER"==e||"contact"==this.classList){var t=é("header");"clicked"==t.className?t.className="reverse":t.className="clicked"}}},Age={calc:function(){var e=é("time"),t=e.getAttribute("datetime"),n=new Date,r=[n.getFullYear(),n.getMonth()+1,("0"+n.getDate()).slice(-2)],i=[t.slice(0,4),t.slice(5,7),t.slice(8,10)];r=r.join(""),i=i.join("");var a=(r-i).toString().slice(0,2);e.innerHTML=a+","}},Request={isIndex:function(){if("/"==document.location.pathname)return!0},isPage:function(e){if(document.location.pathname==e)return!0}},Gigs={gigList:function(e,t,n){var r=document.createDocumentFragment(),i=é("#giglist tbody"),a='<td class="mdl-data-table__cell--non-numeric gig-name">\n                '+e+'\n            </td>\n            <td class="mdl-data-table__cell--non-numeric gig-location">\n                '+t+'\n            </td>\n            <td class="gig-date">'+n+"</td>",s=ç("tr");s.innerHTML=a,r.appendChild(s),i.appendChild(r)}};window.addEventListener("DOMContentLoaded",function(){Render.init()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiw6kiLCJzZWxlY3RvciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIsOnIiwiY3JlYXRlRWxlbWVudCIsIlBhcnNlciIsIiRodHRwIiwidXJsIiwiY29yZSIsImFqYXgiLCJtZXRob2QiLCJwcm9taXNlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJjbGllbnQiLCJYTUxIdHRwUmVxdWVzdCIsInVyaSIsIm9wZW4iLCJzZW5kIiwic3RhdHVzIiwidGhpcyIsIm9ubG9hZCIsInJlc3BvbnNlIiwic3RhdHVzVGV4dCIsIm9uZXJyb3IiLCJnZXQiLCJmZXRjaENvbnRlbnQiLCJmZXRjaEZpbGUiLCJmIiwiZSIsImZpbGUiLCJjYWxsYmFjayIsInN1Y2Nlc3MiLCJkYXRhIiwiSlNPTiIsInBhcnNlIiwiUmVuZGVyIiwiZ2V0UGFydCIsImJ1aWxkTGlzdCIsImVycm9yIiwiRXJyb3IiLCJ0aGVuIiwiY2F0Y2giLCJwYXJ0aWFscyIsIk1hcCIsImZpbGVzIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiIsIl9kaWRJdGVyYXRvckVycm9yIiwiX2l0ZXJhdG9yRXJyb3IiLCJ1bmRlZmluZWQiLCJfc3RlcCIsIl9pdGVyYXRvciIsIlN5bWJvbCIsIml0ZXJhdG9yIiwibmV4dCIsImRvbmUiLCJwYXJ0IiwidmFsdWUiLCJlcnIiLCJyZXR1cm4iLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiIsIl9kaWRJdGVyYXRvckVycm9yMiIsIl9pdGVyYXRvckVycm9yMiIsIl9zdGVwMiIsIl9pdGVyYXRvcjIiLCJmZXRjaEdpZ3MiLCJnaWdzIiwiY2VsbHMiLCJ0aXRsZSIsImZlZWQiLCJlbnRyeSIsInVwZGF0ZWQiLCIkdCIsInN1YnN0ciIsInJlbW92ZSIsImlubmVySFRNTCIsInNvcnQiLCJnZXRFbGVtZW50QnlJZCIsInQiLCJHaWdzIiwiZ2lnTGlzdCIsImdzeCRoZWFkbGluZSIsImdzeCR0ZXh0IiwiZ3N4JHN0YXJ0ZGF0ZSIsImxlbmd0aCIsInNvcnR0YWJsZSIsIm1ha2VTb3J0YWJsZSIsIm9wdGlvbnMiLCJ2YWx1ZU5hbWVzIiwiTGlzdCIsInNldHRpbmdzIiwicGFyZW50RWwiLCJidWlsZCIsImVsZW1lbnQiLCJjb250ZW50IiwiYXR0ciIsImFwcGVuZENoaWxkIiwidWwiLCJfc3RlcDMiLCJfaXRlcmF0b3IzIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjMiLCJuIiwibGkiLCJ0ZW1wIiwiZGF0ZUZyb20iLCJkb2NGcmFnIiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsImkiLCJjcmVhdGVFbCIsImluZGV4T2YiLCJjbGFzc0xpc3QiLCJhZGQiLCJvbmNsaWNrIiwiSW50ZXJhY3QiLCJ0b2dnbGVDbGlja2VkIiwicGFyZW50IiwiZWxlbSIsImJvZHkiLCJyZXBsYWNlQ2hpbGQiLCJBZ2UiLCJjYWxjIiwiaW5pdCIsIlJlcXVlc3QiLCJpc0luZGV4IiwiaXNQYWdlIiwibm9kZU5hbWUiLCJjbGlja2VkIiwiZWwiLCJjbGFzc05hbWUiLCJ0aW1lIiwiZ2V0QXR0cmlidXRlIiwidG9kYXkiLCJnZXRNb250aCIsImdldERhdGUiLCJzbGljZSIsImJpcnRoIiwibm93Iiwiam9pbiIsImFnZSIsInRvU3RyaW5nIiwicGF0aG5hbWUiLCJsb2NhdGlvbiIsImRhdGUiLCJmcmFnIiwiZ2lnIiwibmFtZSIsInRyIiwibGlzdCIsIkRhdGUiXSwibWFwcGluZ3MiOiJZQUFBLElBQUlBLEdBQUksU0FBVUMsR0FDZCxNQUFPQyxVQUFTQyxjQUFjRixJQURsQ0csRUFBQSxTQUFBSCxHQUtJLE1BQU9DLFVBQVNHLGNBQWNKLElBRGxDSyxPQUFBLFdBSUlBLFFBQVVDLEdBQUFDLEdBR04sR0FBSUMsSUFEUkMsS0FBQSxTQUFtQkMsRUFBQUgsR0FDWEMsR0FBT0csR0FBQSxHQUFBQyxTQUFBLFNBQUFDLEVBQUFDLEdBQ0QsR0FBQUMsR0FBU0wsR0FBQUEsZ0JBQ1BDLEVBQVVKLENBQ1ZRLEdBQUlBLEtBQUFBLEVBQWFDLEdB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LFFBQUEsV0FDQTNILEdBQTJCdUcsS0FBM0J2RyxTQUFTcUgsU0FBS0MsU0FDZCxPQUFNVCxHQUlkWSxPQUFNLFNBQUFuSCxHQUNGLEdBQUlvSCxTQUFRQyxTQUFaaUIsVUFBOEJsSCxFQUMxQmdHLE9BQUFBLElBb0RSM0MsTUEzQ0lDLFFBQUc4QyxTQUFBQSxFQUFXZSxFQUFVQyxHQUNwQixHQUFBQyxHQUFJaEIsU0FBT3JCLHlCQUNYcUIsRUFBR0MsRUFBQUEsa0JBQ05nQixFQUFBQSw0RUFDSkMsRUFESSxpSEFrRFNKLEVBbERULHlEQW9EMEJDLEVBcEQxQixRQVFHZixFQUFLakksRUFBRSxLQUNYb0osR0FBQXZFLFVBQWN1RCxFQStDZGEsRUFBSy9DLFlBQVlrRCxHQTdDakJDLEVBQUloQixZQUFZaUIsSUFLaEJiLFFBQUFBLGlCQUFjRSxtQkFBZCxXQStDSnJHLE9BQU9xRiIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIMOpID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xufTtcblxudmFyIMOnID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoc2VsZWN0b3IpO1xufTtcblxudmFyIFBhcnNlciA9IChmdW5jdGlvbigpIHtcblxuICAgIGZ1bmN0aW9uICRodHRwKHVybCl7XG4gICAgICAgIHZhciBjb3JlID0ge1xuICAgICAgICAgICAgYWpheDogZnVuY3Rpb24obWV0aG9kLCB1cmwpIHtcbiAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2xpZW50ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmkgPSB1cmw7XG4gICAgICAgICAgICAgICAgICAgIGNsaWVudC5vcGVuKG1ldGhvZCwgdXJpKTtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50LnNlbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyA+PSAyMDAgJiYgdGhpcy5zdGF0dXMgPCAzMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMucmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QodGhpcy5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50Lm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QodGhpcy5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICdnZXQnOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29yZS5hamF4KCdHRVQnLCB1cmwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgZmV0Y2hDb250ZW50OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGxldCBwYXJ0aWFscyA9IG5ldyBNYXAoW1xuICAgICAgICAgICAgICAgIFsnaGVhZGVyJywgJ2Jpbi9wYXJ0aWFscy9oZWFkZXIuaHRtbCddLFxuICAgICAgICAgICAgICAgIFsnLmNvbnRhY3QnLCAnYmluL3BhcnRpYWxzL2NvbnRhY3QuaHRtbCddLFxuICAgICAgICAgICAgICAgIFsnYXNpZGUnLCAnYmluL3BhcnRpYWxzL2FzaWRlLmh0bWwnXVxuICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICBsZXQgZmlsZXMgPSBbXG4gICAgICAgICAgICAgICAgJ2V4cGVyaWVuY2UnXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgZm9yIChjb25zdCBwYXJ0IG9mIHBhcnRpYWxzKSB7XG4gICAgICAgICAgICAgICAgZmV0Y2hGaWxlKHBhcnRbMV0sIHBhcnRbMF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICAgICAgICAgICAgZmV0Y2hGaWxlKGZpbGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnVuY3Rpb24gZmV0Y2hGaWxlKGYsIGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmlsZSA9IGUgPyBmIDogJ2Jpbi9qcy9qc29uLycrZisnLmpzb24nO1xuICAgICAgICAgICAgICAgIHZhciBjYWxsYmFjayA9IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGUgPyBkYXRhIDogSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVuZGVyLmdldFBhcnQoZGF0YSwgZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgUmVuZGVyLmJ1aWxkTGlzdChkYXRhLCBmKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgJGh0dHAoZmlsZSkuZ2V0KClcbiAgICAgICAgICAgICAgICAudGhlbihjYWxsYmFjay5zdWNjZXNzKVxuICAgICAgICAgICAgICAgIC5jYXRjaChjYWxsYmFjay5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGZldGNoR2lnczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gRk9SIFRIRSAvZ2lncy8gUEFHRSBPTkxZXG4gICAgICAgICAgICBsZXQgZ2lncyA9ICcvL3NwcmVhZHNoZWV0cy5nb29nbGUuY29tL2ZlZWRzL2xpc3QvMVRmMnZSeTZtZTlGM2tuUVNBNUZwZnZyVEx1TmV0bGtkME1tYjJQMjBKcW8vMS9wdWJsaWMvdmFsdWVzP2FsdD1qc29uJztcblxuICAgICAgICAgICAgdmFyIGNhbGxiYWNrID0ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNlbGxzID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gY2VsbHMuZmVlZC5lbnRyeTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVwZGF0ZWQgPSBjZWxscy5mZWVkLnVwZGF0ZWQuJHQ7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWQgPSBgTGFzdCB1cGRhdGVkOiAke3VwZGF0ZWQuc3Vic3RyKDAsMTApfWA7XG4gICAgICAgICAgICAgICAgICAgIMOpKCcubWRsLXNwaW5uZXInKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgw6koJyNzY3JvbGwtdGFiLTEgLm1kbC10b29sdGlwJykuaW5uZXJIVE1MID0gdXBkYXRlZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNvcnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2lnbGlzdCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHQgaW4gdGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ID4gMCkgR2lncy5naWdMaXN0KHRpdGxlW3RdLmdzeCRoZWFkbGluZS4kdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlW3RdLmdzeCR0ZXh0LiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVbdF0uZ3N4JHN0YXJ0ZGF0ZS4kdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodCA9PSB0aXRsZS5sZW5ndGgtMSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ydHRhYmxlLm1ha2VTb3J0YWJsZShzb3J0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVOYW1lczogWydnaWctbmFtZScsICdnaWctbG9jYXRpb24nLCAnZ2lnLWRhdGUnXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJMaXN0ID0gbmV3IExpc3QoJ2F0dGVuZGVkLWdpZ3MnLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAkaHR0cChnaWdzKS5nZXQoKVxuICAgICAgICAgICAgLnRoZW4oY2FsbGJhY2suc3VjY2VzcylcbiAgICAgICAgICAgIC5jYXRjaChjYWxsYmFjay5lcnJvcik7XG4gICAgICAgIH1cblxuICAgIH07XG5cbn0pKCk7XG5cbnZhciBSZW5kZXIgPSB7XG5cbiAgICBzZXR0aW5nczoge1xuICAgICAgICBjcmVhdGVFbDogJ2RpdicsXG4gICAgICAgIHBhcmVudEVsOiAnbWFpbidcbiAgICB9LFxuXG4gICAgYnVpbGRMaXN0OiBmdW5jdGlvbihkYXRhLCBmKSB7XG4gICAgICAgIGRhdGEgPSBkYXRhLml0ZW1zO1xuICAgICAgICB2YXIgcGFyZW50ID0gw6koJy4nKyBmKTtcbiAgICAgICAgdmFyIHVsID0gw6coJ3VsJyk7XG5cbiAgICAgICAgZnVuY3Rpb24gYnVpbGQoZWxlbWVudCwgY29udGVudCwgYXR0cikge1xuICAgICAgICAgICAgZWxlbWVudCA9IMOnKGVsZW1lbnQpO1xuICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjb250ZW50KSk7XG4gICAgICAgICAgICBhdHRyICYmIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdocmVmJywgJy8vJyArIGNvbnRlbnQpO1xuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgZGF0YSkge1xuICAgICAgICAgICAgdmFyIGxpID0gw6coJ2xpJyk7XG5cbiAgICAgICAgICAgIHZhciB0ZW1wID0gW1xuICAgICAgICAgICAgICAgIGJ1aWxkKCdoMicsIG4udGl0bGUpLFxuICAgICAgICAgICAgICAgIGJ1aWxkKCdoMycsIG4ucG9zaXRpb24pLFxuICAgICAgICAgICAgICAgIGJ1aWxkKCd0aW1lJywgbi5kYXRlRnJvbSksXG4gICAgICAgICAgICAgICAgYnVpbGQoJ3NwYW4nLCAn4oCUJyksXG4gICAgICAgICAgICAgICAgYnVpbGQoJ3RpbWUnLCBuLmRhdGVUbyksXG4gICAgICAgICAgICAgICAgbi51cmwgJiYgYnVpbGQoJ2EnLCBuLnVybCwgMSlcbiAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgIHZhciBkb2NGcmFnID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRlbXAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0ZW1wW2ldICYmIGRvY0ZyYWcuYXBwZW5kQ2hpbGQodGVtcFtpXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxpLmFwcGVuZENoaWxkKGRvY0ZyYWcpO1xuICAgICAgICAgICAgdWwuYXBwZW5kQ2hpbGQobGkpO1xuICAgICAgICB9XG5cbiAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKHVsKTtcbiAgICB9LFxuXG4gICAgZ2V0UGFydDogZnVuY3Rpb24oZGF0YSwgZSkge1xuICAgICAgICBpZiAofmUuaW5kZXhPZignLicpKSB7XG5cbiAgICAgICAgICAgIC8vIGUgcmVmZXJzIHRvIGEgY2xhc3NuYW1lXG4gICAgICAgICAgICBlID0gZS5zdWJzdHIoMSk7XG5cbiAgICAgICAgICAgIC8vIGNyZWF0aW5nIGEgZGl2IHdpdGggY2xhc3NuYW1lIGVcbiAgICAgICAgICAgIHZhciB0ZW1wID0gw6codGhpcy5zZXR0aW5ncy5jcmVhdGVFbCk7XG4gICAgICAgICAgICB0ZW1wLmNsYXNzTGlzdC5hZGQoZSk7XG5cbiAgICAgICAgICAgIC8vIGFkZCBkYXRhIGFuZCBhdHRhY2ggY2xpY2sgaGFuZGxlclxuICAgICAgICAgICAgdGVtcC5pbm5lckhUTUwgPSBkYXRhO1xuICAgICAgICAgICAgdGVtcC5vbmNsaWNrID0gSW50ZXJhY3QudG9nZ2xlQ2xpY2tlZDtcblxuICAgICAgICAgICAgLy8gYXBwZW5kIHRvIHBhcmVudCA8bWFpbj5cbiAgICAgICAgICAgIHZhciBwYXJlbnQgPSDDqSh0aGlzLnNldHRpbmdzLnBhcmVudEVsKTtcbiAgICAgICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZCh0ZW1wKTtcblxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAvLyBlIHJlZmVycyB0byBhbiBleGlzdGluZyBlbGVtZW50XG4gICAgICAgICAgICB2YXIgZWxlbSA9IMOpKGUpO1xuXG4gICAgICAgICAgICAvLyBjcmVhdGUgdGhlIChuZXcpIGVsZW1lbnRcbiAgICAgICAgICAgIHRlbXAgPSDDpyhlKTtcblxuICAgICAgICAgICAgLy8gYWRkIGRhdGFcbiAgICAgICAgICAgIHRlbXAuaW5uZXJIVE1MID0gZGF0YTtcblxuICAgICAgICAgICAgdGVtcC5vbmNsaWNrID0gSW50ZXJhY3QudG9nZ2xlQ2xpY2tlZDtcblxuICAgICAgICAgICAgLy8gcmVwbGFjZSBleGlzdGluZyBlbGVtZW50IHdpdGggbmV3XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlcGxhY2VDaGlsZCh0ZW1wLCBlbGVtKTtcbiAgICAgICAgICAgIGlmKH5lLmluZGV4T2YoJ2FzaWRlJykpIEFnZS5jYWxjKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgaW5pdDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChSZXF1ZXN0LmlzSW5kZXgoKSkgUGFyc2VyLmZldGNoQ29udGVudCgpO1xuICAgICAgICBpZiAoUmVxdWVzdC5pc1BhZ2UoJy9naWdzLycpKSBQYXJzZXIuZmV0Y2hHaWdzKCk7XG4gICAgfVxuXG59O1xuXG52YXIgSW50ZXJhY3QgPSB7XG5cbiAgICB0b2dnbGVDbGlja2VkOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNsaWNrZWQgPSB0aGlzLm5vZGVOYW1lO1xuICAgICAgICBpZihjbGlja2VkID09ICdIRUFERVInfHx0aGlzLmNsYXNzTGlzdCA9PSAnY29udGFjdCcpe1xuICAgICAgICAgICAgdmFyIGVsID0gw6koJ2hlYWRlcicpO1xuICAgICAgICAgICAgZWwuY2xhc3NOYW1lID09ICdjbGlja2VkJyA/IGVsLmNsYXNzTmFtZSA9ICdyZXZlcnNlJyA6IGVsLmNsYXNzTmFtZSA9ICdjbGlja2VkJztcbiAgICAgICAgfVxuICAgIH1cblxufTtcblxudmFyIEFnZSA9IHtcblxuICAgIGNhbGM6IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZWwgPSDDqSgndGltZScpO1xuICAgICAgICB2YXIgdGltZSA9IGVsLmdldEF0dHJpYnV0ZSgnZGF0ZXRpbWUnKTtcblxuICAgICAgICB2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpO1xuICAgICAgICB2YXIgbm93ID0gW3RvZGF5LmdldEZ1bGxZZWFyKCksIHRvZGF5LmdldE1vbnRoKCkrMSwgKCcwJyArIHRvZGF5LmdldERhdGUoKSkuc2xpY2UoLTIpXTtcbiAgICAgICAgdmFyIGJpcnRoID0gW3RpbWUuc2xpY2UoMCw0KSwgdGltZS5zbGljZSg1LDcpLCB0aW1lLnNsaWNlKDgsMTApXTtcblxuICAgICAgICBub3cgPSBub3cuam9pbignJyk7XG4gICAgICAgIGJpcnRoID0gYmlydGguam9pbignJyk7XG5cbiAgICAgICAgdmFyIGFnZSA9IChub3cgLSBiaXJ0aCkudG9TdHJpbmcoKS5zbGljZSgwLDIpO1xuICAgICAgICBlbC5pbm5lckhUTUwgPSBhZ2UgKyAnLCc7XG4gICAgfVxuXG59O1xuXG52YXIgUmVxdWVzdCA9IHtcblxuICAgIGlzSW5kZXg6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoZG9jdW1lbnQubG9jYXRpb24ucGF0aG5hbWUgPT0gJy8nKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBpc1BhZ2U6IGZ1bmN0aW9uKHVybCkge1xuICAgICAgICBpZiAoZG9jdW1lbnQubG9jYXRpb24ucGF0aG5hbWUgPT0gdXJsKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxufTtcblxudmFyIEdpZ3MgPSB7XG4gICAgLy8gTk9UIFVTRUQgT04gTUFJTiBQQUdFXG5cbiAgICBnaWdMaXN0OiBmdW5jdGlvbihuYW1lLCBsb2NhdGlvbiwgZGF0ZSkge1xuICAgICAgICB2YXIgZnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgdmFyIGxpc3QgPSDDqSgnI2dpZ2xpc3QgdGJvZHknKTtcbiAgICAgICAgdmFyIGdpZyA9IGA8dGQgY2xhc3M9XCJtZGwtZGF0YS10YWJsZV9fY2VsbC0tbm9uLW51bWVyaWMgZ2lnLW5hbWVcIj5cbiAgICAgICAgICAgICAgICAke25hbWV9XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwibWRsLWRhdGEtdGFibGVfX2NlbGwtLW5vbi1udW1lcmljIGdpZy1sb2NhdGlvblwiPlxuICAgICAgICAgICAgICAgICR7bG9jYXRpb259XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwiZ2lnLWRhdGVcIj4ke2RhdGV9PC90ZD5gO1xuXG4gICAgICAgIHZhciB0ciA9IMOnKCd0cicpO1xuICAgICAgICB0ci5pbm5lckhUTUwgPSBnaWc7XG4gICAgICAgIGZyYWcuYXBwZW5kQ2hpbGQodHIpO1xuICAgICAgICBsaXN0LmFwcGVuZENoaWxkKGZyYWcpO1xuICAgIH1cblxufTtcblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHtcbiAgICBSZW5kZXIuaW5pdCgpO1xufSk7XG4iXX0=
