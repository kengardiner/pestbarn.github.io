"use strict";var é=function(e){return document.querySelector(e)},ç=function(e){return document.createElement(e)},Parser=function(){function e(e){var t={ajax:function(e,t){var n=new Promise(function(n,r){var a=new XMLHttpRequest,i=t;a.open(e,i),a.send(),a.onload=function(){this.status>=200&&this.status<300?n(this.response):r(this.statusText)},a.onerror=function(){r(this.statusText)}});return n}};return{get:function(){return t.ajax("GET",e)}}}return{fetchContent:function(){function t(t,n){var r=n?t:"bin/js/json/"+t+".json",a={success:function(e){e=n?e:JSON.parse(e),n?Render.getPart(e,n):Render.buildList(e,t)},error:function(e){throw new Error(e)}};e(r).get().then(a.success).catch(a.error)}var n=new Map([["header","bin/partials/header.html"],[".contact","bin/partials/contact.html"],["aside","bin/partials/aside.html"]]),r=["experience"],a=!0,i=!1,s=void 0;try{for(var o,c=n[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var d=o.value;t(d[1],d[0])}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}var l=!0,u=!1,g=void 0;try{for(var f,m=r[Symbol.iterator]();!(l=(f=m.next()).done);l=!0){var h=f.value;t(h)}}catch(e){u=!0,g=e}finally{try{!l&&m.return&&m.return()}finally{if(u)throw g}}},fetchGigs:function(){var t="//spreadsheets.google.com/feeds/list/1Tf2vRy6me9F3knQSA5FpfvrTLuNetlkd0Mmb2P20Jqo/1/public/values?alt=json",n={success:function(e){var t=JSON.parse(e),n=t.feed.entry,r=t.feed.updated.$t;r="Last updated: "+r.substr(0,10),é("#attended-gigs .mdl-spinner").remove(),é("#gigs .mdl-tooltip").innerHTML=r;var a=document.getElementById("giglist");for(var i in n)if(i>0&&Tables.gigList(n[i].gsx$headline.$t,n[i].gsx$text.$t,n[i].gsx$startdate.$t),i==n.length-1){sorttable.makeSortable(a);var s={valueNames:["gig-name","gig-location","gig-date"]};new List("attended-gigs",s)}},error:function(e){throw new Error(e)}};e(t).get().then(n.success).catch(n.error)},fetchBeer:function(){var t="//spreadsheets.google.com/feeds/list/1a056ruITWMr8oeJECb8QM6ePe00IqTTEIkrkhY-QeMI/1/public/values?alt=json",n={success:function(e){var t=JSON.parse(e),n=t.feed.entry,r=t.feed.updated.$t;r="Last updated: "+r.substr(0,10),é("#untappd-stats .mdl-spinner").remove(),é("#beers .mdl-tooltip").innerHTML=r;var a=document.getElementById("beerlist");for(var i in n){var s=n[i].gsx$createdat.$t;if(s=s.substr(0,10),i>0&&Tables.beerList(n[i].gsx$breweryname.$t,n[i].gsx$beername.$t,n[i].gsx$beertype.$t,n[i].gsx$beerabv.$t,n[i].gsx$ratingscore.$t,s),i==n.length-1){sorttable.makeSortable(a);var o={valueNames:["brewery","beer-name","beer-type","beer-abv","beer-rating","beer-date"]};new List("untappd-stats",o)}}},error:function(e){throw new Error(e)}};e(t).get().then(n.success).catch(n.error)}}}(),Render={settings:{createEl:"div",parentEl:"main"},buildList:function(e,t){function n(e,t,n){return e=ç(e),e.appendChild(document.createTextNode(t)),n&&e.setAttribute("href","//"+t),e}e=e.items;var r=é("."+t),a=ç("ul"),i=!0,s=!1,o=void 0;try{for(var c,d=e[Symbol.iterator]();!(i=(c=d.next()).done);i=!0){for(var l=c.value,u=ç("li"),g=[n("h2",l.title),n("h3",l.position),n("time",l.dateFrom),n("span","—"),n("time",l.dateTo),l.url&&n("a",l.url,1)],f=document.createDocumentFragment(),m=0;m<g.length;m++)g[m]&&f.appendChild(g[m]);u.appendChild(f),a.appendChild(u)}}catch(e){s=!0,o=e}finally{try{!i&&d.return&&d.return()}finally{if(s)throw o}}r.appendChild(a)},getPart:function(e,t){if(~t.indexOf(".")){t=t.substr(1);var n=ç(Render.settings.createEl);n.classList.add(t),n.innerHTML=e,n.onclick=Interact.toggleClicked;var r=é(Render.settings.parentEl);r.appendChild(n)}else{var a=é(t);n=ç(t),n.innerHTML=e,n.onclick=Interact.toggleClicked,document.body.replaceChild(n,a),~t.indexOf("aside")&&Age.calc()}},init:function(){if(Request.isIndex()&&Parser.fetchContent(),Request.isPage("/stats/")){Parser.fetchGigs(),Parser.fetchBeer();var e=document.location.hash;e&&!function(){var t=é('a[href="'+e+'"]');window.addEventListener("load",function(){t.click()})}()}}},Interact={toggleClicked:function(){var e=(void 0).nodeName;if("HEADER"==e||"contact"==(void 0).classList){var t=é("header");"clicked"==t.className?t.className="reverse":t.className="clicked"}}},Age={calc:function(){var e=é("time"),t=e.getAttribute("datetime"),n=new Date,r=[n.getFullYear(),n.getMonth()+1,("0"+n.getDate()).slice(-2)],a=[t.slice(0,4),t.slice(5,7),t.slice(8,10)];r=r.join(""),a=a.join("");var i=(r-a).toString().slice(0,2);e.innerHTML=i+","}},Request={isIndex:function(){if("/"==document.location.pathname)return!0},isPage:function(e){if(document.location.pathname==e)return!0}},Tables={gigList:function(e,t,n){var r=document.createDocumentFragment(),a=é("#giglist tbody"),i='<td class="mdl-data-table__cell--non-numeric gig-name">\n                '+e+'\n            </td>\n            <td class="mdl-data-table__cell--non-numeric gig-location">\n                '+t+'\n            </td>\n            <td class="gig-date">'+n+"</td>",s=ç("tr");s.innerHTML=i,r.appendChild(s),a.appendChild(r)},beerList:function(e,t,n,r,a,i){var s=document.createDocumentFragment(),o=é("#beerlist tbody"),c='<td class="mdl-data-table__cell--non-numeric brewery">\n                '+e+'\n            </td>\n            <td class="mdl-data-table__cell--non-numeric beer-name">\n                '+t+'\n            </td>\n            <td class="mdl-data-table__cell--non-numeric beer-type">\n                '+n+'\n            </td>\n            <td class="beer-abv">'+r+'</td>\n            <td class="beer-rating">'+a+'</td>\n            <td class="beer-date">'+i+"</td>",d=ç("tr");d.innerHTML=c,s.appendChild(d),o.appendChild(s)}};window.addEventListener("DOMContentLoaded",function(){Render.init()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiw6kiLCJzZWxlY3RvciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIsOnIiwiY3JlYXRlRWxlbWVudCIsIiRodHRwIiwidXJsIiwiY29yZSIsImFqYXgiLCJtZXRob2QiLCJwcm9taXNlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJjbGllbnQiLCJYTUxIdHRwUmVxdWVzdCIsInVyaSIsIm9wZW4iLCJzZW5kIiwib25sb2FkIiwic3RhdHVzIiwidGhpcyIsIm9uZXJyb3IiLCJzdGF0dXNUZXh0IiwiZ2V0IiwiZmV0Y2hDb250ZW50IiwiZmV0Y2hGaWxlIiwiZiIsImUiLCJmaWxlIiwic3VjY2VzcyIsImRhdGEiLCJKU09OIiwicGFyc2UiLCJSZW5kZXIiLCJnZXRQYXJ0IiwiYnVpbGRMaXN0IiwiZXJyb3IiLCJFcnJvciIsInRoZW4iLCJjYWxsYmFjayIsImNhdGNoIiwicGFydGlhbHMiLCJNYXAiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uIiwiX2RpZEl0ZXJhdG9yRXJyb3IiLCJfaXRlcmF0b3JFcnJvciIsInVuZGVmaW5lZCIsIl9zdGVwIiwiX2l0ZXJhdG9yIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJuZXh0IiwiZG9uZSIsInBhcnQiLCJ2YWx1ZSIsImVyciIsInJldHVybiIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yIiwiX2RpZEl0ZXJhdG9yRXJyb3IyIiwiX2l0ZXJhdG9yRXJyb3IyIiwiX3N0ZXAyIiwiX2l0ZXJhdG9yMiIsImZpbGVzIiwiZmV0Y2hHaWdzIiwiZ2lncyIsImNlbGxzIiwidGl0bGUiLCJlbnRyeSIsImZlZWQiLCJ1cGRhdGVkIiwiJHQiLCJzdWJzdHIiLCJyZW1vdmUiLCJpbm5lckhUTUwiLCJzb3J0IiwiZ2V0RWxlbWVudEJ5SWQiLCJ0IiwiVGFibGVzIiwiZ2lnTGlzdCIsImdzeCRoZWFkbGluZSIsImdzeCR0ZXh0IiwiZ3N4JHN0YXJ0ZGF0ZSIsImxlbmd0aCIsInNvcnR0YWJsZSIsIm1ha2VTb3J0YWJsZSIsIm9wdGlvbnMiLCJ2YWx1ZU5hbWVzIiwiTGlzdCIsImZldGNoQmVlciIsImdzeCRjcmVhdGVkYXQiLCJnc3gkYmVlcmFidiIsImdzeCRyYXRpbmdzY29yZSIsImRhdGVUcmltIiwiYmVlciIsImVsZW1lbnQiLCJjb250ZW50IiwiYXR0ciIsInNldEF0dHJpYnV0ZSIsIml0ZW1zIiwidWwiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyIsIl9kaWRJdGVyYXRvckVycm9yMyIsIl9pdGVyYXRvckVycm9yMyIsIl9zdGVwMyIsIl9pdGVyYXRvcjMiLCJzZXR0aW5ncyIsIm4iLCJ0ZW1wIiwiYnVpbGQiLCJkYXRlRnJvbSIsImRhdGVUbyIsImRvY0ZyYWciLCJjcmVhdGVEb2N1bWVudEZyYWdtZW50IiwiaSIsImNyZWF0ZUVsIiwiYXBwZW5kQ2hpbGQiLCJsaSIsInBhcmVudCIsImNsYXNzTGlzdCIsImFkZCIsIm9uY2xpY2siLCJJbnRlcmFjdCIsInRvZ2dsZUNsaWNrZWQiLCJwYXJlbnRFbCIsImVsZW0iLCJib2R5IiwicmVwbGFjZUNoaWxkIiwiaW5kZXhPZiIsIkFnZSIsImNhbGMiLCJpbml0IiwiUmVxdWVzdCIsImlzSW5kZXgiLCJQYXJzZXIiLCJpc1BhZ2UiLCJoYXNoIiwibG9jYXRpb24iLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwicmVsTGluayIsImNsaWNrIiwiY2xpY2tlZCIsIm5vZGVOYW1lIiwiZWwiLCJjbGFzc05hbWUiLCJ0aW1lIiwiZ2V0QXR0cmlidXRlIiwidG9kYXkiLCJEYXRlIiwibm93IiwiZ2V0RGF0ZSIsInNsaWNlIiwiYmlydGgiLCJqb2luIiwiYWdlIiwidG9TdHJpbmciLCJwYXRobmFtZSIsIm5hbWUiLCJkYXRlIiwiZnJhZyIsInRyIiwibGlzdCIsImJlZXJMaXN0IiwiYnJld2VyeSIsImJOYW1lIiwiYlR5cGUiLCJiQWJ2IiwiYlJhdGluZyIsImJEYXRlIiwiYnJldyJdLCJtYXBwaW5ncyI6IllBQUEsSUFB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V0x0QixRQUFBQyxpQkFBQSxtQkFBQSxXQUNBc0IsT0FBR3ZGIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgw6kgPSBzZWxlY3RvciA9PiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbnZhciDDpyA9IHNlbGVjdG9yID0+IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoc2VsZWN0b3IpO1xuXG4vKiBnbG9iYWwgc29ydHRhYmxlLCBMaXN0ICovXG5cbnZhciBQYXJzZXIgPSAoKCkgPT4ge1xuXG4gICAgZnVuY3Rpb24gJGh0dHAodXJsKXtcbiAgICAgICAgdmFyIGNvcmUgPSB7XG4gICAgICAgICAgICBhamF4OiAobWV0aG9kLCB1cmwpID0+IHtcbiAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2xpZW50ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmkgPSB1cmw7XG4gICAgICAgICAgICAgICAgICAgIGNsaWVudC5vcGVuKG1ldGhvZCwgdXJpKTtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50LnNlbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyA+PSAyMDAgJiYgdGhpcy5zdGF0dXMgPCAzMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMucmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QodGhpcy5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50Lm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QodGhpcy5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICdnZXQnOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvcmUuYWpheCgnR0VUJywgdXJsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAgIGZldGNoQ29udGVudDogKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHBhcnRpYWxzID0gbmV3IE1hcChbXG4gICAgICAgICAgICAgICAgWydoZWFkZXInLCAnYmluL3BhcnRpYWxzL2hlYWRlci5odG1sJ10sXG4gICAgICAgICAgICAgICAgWycuY29udGFjdCcsICdiaW4vcGFydGlhbHMvY29udGFjdC5odG1sJ10sXG4gICAgICAgICAgICAgICAgWydhc2lkZScsICdiaW4vcGFydGlhbHMvYXNpZGUuaHRtbCddXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgICAgIGxldCBmaWxlcyA9IFtcbiAgICAgICAgICAgICAgICAnZXhwZXJpZW5jZSdcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBhcnQgb2YgcGFydGlhbHMpIHtcbiAgICAgICAgICAgICAgICBmZXRjaEZpbGUocGFydFsxXSwgcGFydFswXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgICAgICAgICAgICBmZXRjaEZpbGUoZmlsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmdW5jdGlvbiBmZXRjaEZpbGUoZiwgZSkge1xuICAgICAgICAgICAgICAgIHZhciBmaWxlID0gZSA/IGYgOiAnYmluL2pzL2pzb24vJytmKycuanNvbic7XG4gICAgICAgICAgICAgICAgdmFyIGNhbGxiYWNrID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBlID8gZGF0YSA6IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlbmRlci5nZXRQYXJ0KGRhdGEsIGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIFJlbmRlci5idWlsZExpc3QoZGF0YSwgZik7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgJGh0dHAoZmlsZSkuZ2V0KClcbiAgICAgICAgICAgICAgICAudGhlbihjYWxsYmFjay5zdWNjZXNzKVxuICAgICAgICAgICAgICAgIC5jYXRjaChjYWxsYmFjay5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGZldGNoR2lnczogKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGdpZ3MgPSAnLy9zcHJlYWRzaGVldHMuZ29vZ2xlLmNvbS9mZWVkcy9saXN0LzFUZjJ2Unk2bWU5RjNrblFTQTVGcGZ2clRMdU5ldGxrZDBNbWIyUDIwSnFvLzEvcHVibGljL3ZhbHVlcz9hbHQ9anNvbic7XG5cbiAgICAgICAgICAgIHZhciBjYWxsYmFjayA9IHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNlbGxzID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gY2VsbHMuZmVlZC5lbnRyeTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVwZGF0ZWQgPSBjZWxscy5mZWVkLnVwZGF0ZWQuJHQ7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWQgPSBgTGFzdCB1cGRhdGVkOiAke3VwZGF0ZWQuc3Vic3RyKDAsMTApfWA7XG4gICAgICAgICAgICAgICAgICAgIMOpKCcjYXR0ZW5kZWQtZ2lncyAubWRsLXNwaW5uZXInKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgw6koJyNnaWdzIC5tZGwtdG9vbHRpcCcpLmlubmVySFRNTCA9IHVwZGF0ZWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzb3J0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dpZ2xpc3QnKTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCB0IGluIHRpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodCA+IDApIFRhYmxlcy5naWdMaXN0KHRpdGxlW3RdLmdzeCRoZWFkbGluZS4kdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlW3RdLmdzeCR0ZXh0LiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVbdF0uZ3N4JHN0YXJ0ZGF0ZS4kdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodCA9PSB0aXRsZS5sZW5ndGgtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvcnR0YWJsZS5tYWtlU29ydGFibGUoc29ydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlTmFtZXM6IFsnZ2lnLW5hbWUnLCAnZ2lnLWxvY2F0aW9uJywgJ2dpZy1kYXRlJ11cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBMaXN0KCdhdHRlbmRlZC1naWdzJywgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAkaHR0cChnaWdzKS5nZXQoKVxuICAgICAgICAgICAgLnRoZW4oY2FsbGJhY2suc3VjY2VzcylcbiAgICAgICAgICAgIC5jYXRjaChjYWxsYmFjay5lcnJvcik7XG4gICAgICAgIH0sXG4gICAgICAgIGZldGNoQmVlcjogKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGJlZXIgPSAnLy9zcHJlYWRzaGVldHMuZ29vZ2xlLmNvbS9mZWVkcy9saXN0LzFhMDU2cnVJVFdNcjhvZUpFQ2I4UU02ZVBlMDBJcVRURUlrcmtoWS1RZU1JLzEvcHVibGljL3ZhbHVlcz9hbHQ9anNvbic7XG5cbiAgICAgICAgICAgIHZhciBjYWxsYmFjayA9IHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNlbGxzID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gY2VsbHMuZmVlZC5lbnRyeTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVwZGF0ZWQgPSBjZWxscy5mZWVkLnVwZGF0ZWQuJHQ7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWQgPSBgTGFzdCB1cGRhdGVkOiAke3VwZGF0ZWQuc3Vic3RyKDAsMTApfWA7XG4gICAgICAgICAgICAgICAgICAgIMOpKCcjdW50YXBwZC1zdGF0cyAubWRsLXNwaW5uZXInKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgw6koJyNiZWVycyAubWRsLXRvb2x0aXAnKS5pbm5lckhUTUwgPSB1cGRhdGVkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc29ydCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiZWVybGlzdCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHQgaW4gdGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRlVHJpbSA9IHRpdGxlW3RdLmdzeCRjcmVhdGVkYXQuJHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlVHJpbSA9IGRhdGVUcmltLnN1YnN0cigwLDEwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ID4gMCkgVGFibGVzLmJlZXJMaXN0KHRpdGxlW3RdLmdzeCRicmV3ZXJ5bmFtZS4kdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlW3RdLmdzeCRiZWVybmFtZS4kdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlW3RdLmdzeCRiZWVydHlwZS4kdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlW3RdLmdzeCRiZWVyYWJ2LiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVbdF0uZ3N4JHJhdGluZ3Njb3JlLiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVRyaW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQgPT0gdGl0bGUubGVuZ3RoLTEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvcnR0YWJsZS5tYWtlU29ydGFibGUoc29ydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlTmFtZXM6IFsnYnJld2VyeScsICdiZWVyLW5hbWUnLCAnYmVlci10eXBlJywgJ2JlZXItYWJ2JywgJ2JlZXItcmF0aW5nJywgJ2JlZXItZGF0ZSddXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTGlzdCgndW50YXBwZC1zdGF0cycsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihkYXRhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgJGh0dHAoYmVlcikuZ2V0KClcbiAgICAgICAgICAgIC50aGVuKGNhbGxiYWNrLnN1Y2Nlc3MpXG4gICAgICAgICAgICAuY2F0Y2goY2FsbGJhY2suZXJyb3IpO1xuICAgICAgICB9XG5cbiAgICB9O1xuXG59KSgpO1xuXG52YXIgUmVuZGVyID0ge1xuXG4gICAgc2V0dGluZ3M6IHtcbiAgICAgICAgY3JlYXRlRWw6ICdkaXYnLFxuICAgICAgICBwYXJlbnRFbDogJ21haW4nXG4gICAgfSxcblxuICAgIGJ1aWxkTGlzdDogKGRhdGEsIGYpID0+IHtcbiAgICAgICAgZGF0YSA9IGRhdGEuaXRlbXM7XG4gICAgICAgIHZhciBwYXJlbnQgPSDDqSgnLicrIGYpO1xuICAgICAgICB2YXIgdWwgPSDDpygndWwnKTtcblxuICAgICAgICBmdW5jdGlvbiBidWlsZChlbGVtZW50LCBjb250ZW50LCBhdHRyKSB7XG4gICAgICAgICAgICBlbGVtZW50ID0gw6coZWxlbWVudCk7XG4gICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNvbnRlbnQpKTtcbiAgICAgICAgICAgIGF0dHIgJiYgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCAnLy8nICsgY29udGVudCk7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoY29uc3QgbiBvZiBkYXRhKSB7XG4gICAgICAgICAgICB2YXIgbGkgPSDDpygnbGknKTtcblxuICAgICAgICAgICAgdmFyIHRlbXAgPSBbXG4gICAgICAgICAgICAgICAgYnVpbGQoJ2gyJywgbi50aXRsZSksXG4gICAgICAgICAgICAgICAgYnVpbGQoJ2gzJywgbi5wb3NpdGlvbiksXG4gICAgICAgICAgICAgICAgYnVpbGQoJ3RpbWUnLCBuLmRhdGVGcm9tKSxcbiAgICAgICAgICAgICAgICBidWlsZCgnc3BhbicsICfigJQnKSxcbiAgICAgICAgICAgICAgICBidWlsZCgndGltZScsIG4uZGF0ZVRvKSxcbiAgICAgICAgICAgICAgICBuLnVybCAmJiBidWlsZCgnYScsIG4udXJsLCAxKVxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgdmFyIGRvY0ZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgdGVtcC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHRlbXBbaV0gJiYgZG9jRnJhZy5hcHBlbmRDaGlsZCh0ZW1wW2ldKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbGkuYXBwZW5kQ2hpbGQoZG9jRnJhZyk7XG4gICAgICAgICAgICB1bC5hcHBlbmRDaGlsZChsaSk7XG4gICAgICAgIH1cblxuICAgICAgICBwYXJlbnQuYXBwZW5kQ2hpbGQodWwpO1xuICAgIH0sXG5cbiAgICBnZXRQYXJ0OiAoZGF0YSwgZSkgPT4ge1xuICAgICAgICBpZiAofmUuaW5kZXhPZignLicpKSB7XG5cbiAgICAgICAgICAgIC8vIGUgcmVmZXJzIHRvIGEgY2xhc3NuYW1lXG4gICAgICAgICAgICBlID0gZS5zdWJzdHIoMSk7XG5cbiAgICAgICAgICAgIC8vIGNyZWF0aW5nIGEgZGl2IHdpdGggY2xhc3NuYW1lIGVcbiAgICAgICAgICAgIHZhciB0ZW1wID0gw6coUmVuZGVyLnNldHRpbmdzLmNyZWF0ZUVsKTtcbiAgICAgICAgICAgIHRlbXAuY2xhc3NMaXN0LmFkZChlKTtcblxuICAgICAgICAgICAgLy8gYWRkIGRhdGEgYW5kIGF0dGFjaCBjbGljayBoYW5kbGVyXG4gICAgICAgICAgICB0ZW1wLmlubmVySFRNTCA9IGRhdGE7XG4gICAgICAgICAgICB0ZW1wLm9uY2xpY2sgPSBJbnRlcmFjdC50b2dnbGVDbGlja2VkO1xuXG4gICAgICAgICAgICAvLyBhcHBlbmQgdG8gcGFyZW50IDxtYWluPlxuICAgICAgICAgICAgdmFyIHBhcmVudCA9IMOpKFJlbmRlci5zZXR0aW5ncy5wYXJlbnRFbCk7XG4gICAgICAgICAgICBwYXJlbnQuYXBwZW5kQ2hpbGQodGVtcCk7XG5cbiAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgLy8gZSByZWZlcnMgdG8gYW4gZXhpc3RpbmcgZWxlbWVudFxuICAgICAgICAgICAgdmFyIGVsZW0gPSDDqShlKTtcblxuICAgICAgICAgICAgLy8gY3JlYXRlIHRoZSAobmV3KSBlbGVtZW50XG4gICAgICAgICAgICB0ZW1wID0gw6coZSk7XG5cbiAgICAgICAgICAgIC8vIGFkZCBkYXRhXG4gICAgICAgICAgICB0ZW1wLmlubmVySFRNTCA9IGRhdGE7XG5cbiAgICAgICAgICAgIHRlbXAub25jbGljayA9IEludGVyYWN0LnRvZ2dsZUNsaWNrZWQ7XG5cbiAgICAgICAgICAgIC8vIHJlcGxhY2UgZXhpc3RpbmcgZWxlbWVudCB3aXRoIG5ld1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZXBsYWNlQ2hpbGQodGVtcCwgZWxlbSk7XG4gICAgICAgICAgICBpZih+ZS5pbmRleE9mKCdhc2lkZScpKSBBZ2UuY2FsYygpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGluaXQ6ICgpID0+IHtcbiAgICAgICAgaWYgKFJlcXVlc3QuaXNJbmRleCgpKSBQYXJzZXIuZmV0Y2hDb250ZW50KCk7XG4gICAgICAgIGlmIChSZXF1ZXN0LmlzUGFnZSgnL3N0YXRzLycpKXtcbiAgICAgICAgICAgIFBhcnNlci5mZXRjaEdpZ3MoKTtcbiAgICAgICAgICAgIFBhcnNlci5mZXRjaEJlZXIoKTtcblxuICAgICAgICAgICAgdmFyIGhhc2ggPSBkb2N1bWVudC5sb2NhdGlvbi5oYXNoO1xuICAgICAgICAgICAgaWYgKGhhc2gpIHtcbiAgICAgICAgICAgICAgICBsZXQgcmVsTGluayA9IMOpKCdhW2hyZWY9XCInKyBoYXNoICsnXCJdJyk7XG4gICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJlbExpbmsuY2xpY2soKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufTtcblxudmFyIEludGVyYWN0ID0ge1xuXG4gICAgdG9nZ2xlQ2xpY2tlZDogKCkgPT4ge1xuICAgICAgICB2YXIgY2xpY2tlZCA9IHRoaXMubm9kZU5hbWU7XG4gICAgICAgIGlmKGNsaWNrZWQgPT0gJ0hFQURFUid8fHRoaXMuY2xhc3NMaXN0ID09ICdjb250YWN0Jyl7XG4gICAgICAgICAgICB2YXIgZWwgPSDDqSgnaGVhZGVyJyk7XG4gICAgICAgICAgICBlbC5jbGFzc05hbWUgPT0gJ2NsaWNrZWQnID8gZWwuY2xhc3NOYW1lID0gJ3JldmVyc2UnIDogZWwuY2xhc3NOYW1lID0gJ2NsaWNrZWQnO1xuICAgICAgICB9XG4gICAgfVxuXG59O1xuXG52YXIgQWdlID0ge1xuXG4gICAgY2FsYzogKCkgPT4ge1xuICAgICAgICB2YXIgZWwgPSDDqSgndGltZScpO1xuICAgICAgICB2YXIgdGltZSA9IGVsLmdldEF0dHJpYnV0ZSgnZGF0ZXRpbWUnKTtcblxuICAgICAgICB2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpO1xuICAgICAgICB2YXIgbm93ID0gW1xuICAgICAgICAgICAgdG9kYXkuZ2V0RnVsbFllYXIoKSxcbiAgICAgICAgICAgIHRvZGF5LmdldE1vbnRoKCkrMSxcbiAgICAgICAgICAgICgnMCcgKyB0b2RheS5nZXREYXRlKCkpLnNsaWNlKC0yKVxuICAgICAgICBdO1xuICAgICAgICB2YXIgYmlydGggPSBbXG4gICAgICAgICAgICB0aW1lLnNsaWNlKDAsNCksXG4gICAgICAgICAgICB0aW1lLnNsaWNlKDUsNyksXG4gICAgICAgICAgICB0aW1lLnNsaWNlKDgsMTApXG4gICAgICAgIF07XG5cbiAgICAgICAgbm93ID0gbm93LmpvaW4oJycpO1xuICAgICAgICBiaXJ0aCA9IGJpcnRoLmpvaW4oJycpO1xuXG4gICAgICAgIHZhciBhZ2UgPSAobm93IC0gYmlydGgpLnRvU3RyaW5nKCkuc2xpY2UoMCwyKTtcbiAgICAgICAgZWwuaW5uZXJIVE1MID0gYWdlICsgJywnO1xuICAgIH1cblxufTtcblxudmFyIFJlcXVlc3QgPSB7XG5cbiAgICBpc0luZGV4OiAoKSA9PiB7XG4gICAgICAgIGlmIChkb2N1bWVudC5sb2NhdGlvbi5wYXRobmFtZSA9PSAnLycpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGlzUGFnZTogKHVybCkgPT4ge1xuICAgICAgICBpZiAoZG9jdW1lbnQubG9jYXRpb24ucGF0aG5hbWUgPT0gdXJsKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxufTtcblxudmFyIFRhYmxlcyA9IHtcbiAgICAvLyBOT1QgVVNFRCBPTiBNQUlOIFBBR0VcblxuICAgIGdpZ0xpc3Q6IChuYW1lLCBsb2NhdGlvbiwgZGF0ZSkgPT4ge1xuICAgICAgICB2YXIgZnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgdmFyIGxpc3QgPSDDqSgnI2dpZ2xpc3QgdGJvZHknKTtcbiAgICAgICAgdmFyIGdpZyA9IGA8dGQgY2xhc3M9XCJtZGwtZGF0YS10YWJsZV9fY2VsbC0tbm9uLW51bWVyaWMgZ2lnLW5hbWVcIj5cbiAgICAgICAgICAgICAgICAke25hbWV9XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwibWRsLWRhdGEtdGFibGVfX2NlbGwtLW5vbi1udW1lcmljIGdpZy1sb2NhdGlvblwiPlxuICAgICAgICAgICAgICAgICR7bG9jYXRpb259XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwiZ2lnLWRhdGVcIj4ke2RhdGV9PC90ZD5gO1xuXG4gICAgICAgIHZhciB0ciA9IMOnKCd0cicpO1xuICAgICAgICB0ci5pbm5lckhUTUwgPSBnaWc7XG4gICAgICAgIGZyYWcuYXBwZW5kQ2hpbGQodHIpO1xuICAgICAgICBsaXN0LmFwcGVuZENoaWxkKGZyYWcpO1xuICAgIH0sXG5cbiAgICBiZWVyTGlzdDogKGJyZXdlcnksIGJOYW1lLCBiVHlwZSwgYkFidiwgYlJhdGluZywgYkRhdGUpID0+IHtcbiAgICAgICAgdmFyIGZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgIHZhciBsaXN0ID0gw6koJyNiZWVybGlzdCB0Ym9keScpO1xuXG4gICAgICAgIHZhciBicmV3ID0gYDx0ZCBjbGFzcz1cIm1kbC1kYXRhLXRhYmxlX19jZWxsLS1ub24tbnVtZXJpYyBicmV3ZXJ5XCI+XG4gICAgICAgICAgICAgICAgJHticmV3ZXJ5fVxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDx0ZCBjbGFzcz1cIm1kbC1kYXRhLXRhYmxlX19jZWxsLS1ub24tbnVtZXJpYyBiZWVyLW5hbWVcIj5cbiAgICAgICAgICAgICAgICAke2JOYW1lfVxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDx0ZCBjbGFzcz1cIm1kbC1kYXRhLXRhYmxlX19jZWxsLS1ub24tbnVtZXJpYyBiZWVyLXR5cGVcIj5cbiAgICAgICAgICAgICAgICAke2JUeXBlfVxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDx0ZCBjbGFzcz1cImJlZXItYWJ2XCI+JHtiQWJ2fTwvdGQ+XG4gICAgICAgICAgICA8dGQgY2xhc3M9XCJiZWVyLXJhdGluZ1wiPiR7YlJhdGluZ308L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwiYmVlci1kYXRlXCI+JHtiRGF0ZX08L3RkPmA7XG5cbiAgICAgICAgdmFyIHRyID0gw6coJ3RyJyk7XG4gICAgICAgIHRyLmlubmVySFRNTCA9IGJyZXc7XG4gICAgICAgIGZyYWcuYXBwZW5kQ2hpbGQodHIpO1xuICAgICAgICBsaXN0LmFwcGVuZENoaWxkKGZyYWcpO1xuICAgIH1cblxufTtcblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7XG4gICAgUmVuZGVyLmluaXQoKTtcbn0pO1xuIl19
