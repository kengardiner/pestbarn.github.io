"use strict";var é=function(e){return document.querySelector(e)},ç=function(e){return document.createElement(e)},Parser=function(){function e(e){var t={ajax:function(e,t){var n=new Promise(function(n,r){var a=new XMLHttpRequest,i=t;a.open(e,i),a.send(),a.onload=function(){this.status>=200&&this.status<300?n(this.response):r(this.statusText)},a.onerror=function(){r(this.statusText)}});return n}};return{get:function(){return t.ajax("GET",e)}}}return{fetchContent:function(){function t(t,n){var r=n?t:"bin/js/json/"+t+".json",a={success:function(e){e=n?e:JSON.parse(e),n?Render.getPart(e,n):Render.buildList(e,t)},error:function(e){throw new Error(e)}};e(r).get().then(a.success).catch(a.error)}var n=new Map([["header","bin/partials/header.html"],[".contact","bin/partials/contact.html"],["aside","bin/partials/aside.html"]]),r=["experience"],a=!0,i=!1,s=void 0;try{for(var o,c=n[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var d=o.value;t(d[1],d[0])}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}var l=!0,u=!1,g=void 0;try{for(var f,m=r[Symbol.iterator]();!(l=(f=m.next()).done);l=!0){var h=f.value;t(h)}}catch(e){u=!0,g=e}finally{try{!l&&m.return&&m.return()}finally{if(u)throw g}}},fetchGigs:function(){var t="//spreadsheets.google.com/feeds/list/1Tf2vRy6me9F3knQSA5FpfvrTLuNetlkd0Mmb2P20Jqo/1/public/values?alt=json",n={success:function(e){var t=JSON.parse(e),n=t.feed.entry,r=t.feed.updated.$t;r="Last updated: "+r.substr(0,10),é("#attended-gigs .mdl-spinner").remove(),é("#gigs .mdl-tooltip").innerHTML=r;var a=document.getElementById("giglist");for(var i in n)if(i>0&&Tables.gigList(n[i].gsx$headline.$t,n[i].gsx$text.$t,n[i].gsx$startdate.$t),i==n.length-1){sorttable.makeSortable(a);var s={valueNames:["gig-name","gig-location","gig-date"]};new List("attended-gigs",s)}},error:function(e){throw new Error(e)}};e(t).get().then(n.success).catch(n.error)},fetchBeer:function(){var t="//spreadsheets.google.com/feeds/list/1a056ruITWMr8oeJECb8QM6ePe00IqTTEIkrkhY-QeMI/1/public/values?alt=json",n={success:function(e){var t=JSON.parse(e),n=t.feed.entry,r=t.feed.updated.$t;r="Last updated: "+r.substr(0,10),é("#untappd-stats .mdl-spinner").remove(),é("#beers .mdl-tooltip").innerHTML=r;var a=document.getElementById("beerlist");for(var i in n){var s=n[i].gsx$createdat.$t;if(s=s.substr(0,10),i>0&&Tables.beerList(n[i].gsx$breweryname.$t,n[i].gsx$beername.$t,n[i].gsx$beertype.$t,n[i].gsx$beerabv.$t,n[i].gsx$ratingscore.$t,s),i==n.length-1){sorttable.makeSortable(a);var o={valueNames:["brewery","beer-name","beer-type","beer-abv","beer-rating","beer-date"]};new List("untappd-stats",o)}}},error:function(e){throw new Error(e)}};e(t).get().then(n.success).catch(n.error)}}}(),Render={settings:{createEl:"div",parentEl:"main"},buildList:function(e,t){function n(e,t,n){return e=ç(e),e.appendChild(document.createTextNode(t)),n&&e.setAttribute("href","//"+t),e}e=e.items;var r=é("."+t),a=ç("ul"),i=!0,s=!1,o=void 0;try{for(var c,d=e[Symbol.iterator]();!(i=(c=d.next()).done);i=!0){for(var l=c.value,u=ç("li"),g=[n("h2",l.title),n("h3",l.position),n("time",l.dateFrom),n("span","—"),n("time",l.dateTo),l.url&&n("a",l.url,1)],f=document.createDocumentFragment(),m=0;m<g.length;m++)g[m]&&f.appendChild(g[m]);u.appendChild(f),a.appendChild(u)}}catch(e){s=!0,o=e}finally{try{!i&&d.return&&d.return()}finally{if(s)throw o}}r.appendChild(a)},getPart:function(e,t){if(~t.indexOf(".")){t=t.substr(1);var n=ç(Render.settings.createEl);n.classList.add(t),n.innerHTML=e,n.onclick=Interact.toggleClicked;var r=é(Render.settings.parentEl);r.appendChild(n)}else{var a=é(t),i=ç(t);i.innerHTML=e,i.onclick=Interact.toggleClicked,document.body.replaceChild(i,a),~t.indexOf("header")&&Pizazz.check(),~t.indexOf("aside")&&Age.calc()}},init:function(){if(Request.isIndex()&&Parser.fetchContent(),Request.isPage("/stats/")){Parser.fetchGigs(),Parser.fetchBeer();var e=document.location.hash;e&&!function(){var t=é('a[href="'+e+'"]');window.addEventListener("load",function(){t.click()})}()}}},Interact={toggleClicked:function(e){var t=e.target.parentElement.nodeName,n=e.target.classList;if("HEADER"==t||"MAIN"==t||"locate"==n){var r=é("header");"clicked"==r.className?r.className="reverse":r.className="clicked"}}},Age={calc:function(){var e=é("time"),t=e.getAttribute("datetime"),n=new Date,r=n.getMonth()+1<=9?""+n.getMonth()+1:n.getMonth()+1,a=[n.getFullYear(),r,parseInt(("0"+n.getDate()).slice(-2))],i=[t.slice(0,4),t.slice(5,7),t.slice(8,10)];a=a.join(""),i=i.join("");var s=(a-i).toString().slice(0,2);e.innerHTML=s+","}},Request={isIndex:function(){if("/"==document.location.pathname)return!0},isPage:function(e){if(document.location.pathname==e)return!0}},Tables={gigList:function(e,t,n){var r=document.createDocumentFragment(),a=é("#giglist tbody"),i='<td class="mdl-data-table__cell--non-numeric gig-name">\n                '+e+'\n            </td>\n            <td class="mdl-data-table__cell--non-numeric gig-location">\n                '+t+'\n            </td>\n            <td class="gig-date">'+n+"</td>",s=ç("tr");s.innerHTML=i,r.appendChild(s),a.appendChild(r)},beerList:function(e,t,n,r,a,i){var s=document.createDocumentFragment(),o=é("#beerlist tbody"),c='<td class="mdl-data-table__cell--non-numeric brewery">\n                '+e+'\n            </td>\n            <td class="mdl-data-table__cell--non-numeric beer-name">\n                '+t+'\n            </td>\n            <td class="mdl-data-table__cell--non-numeric beer-type">\n                '+n+'\n            </td>\n            <td class="beer-abv">'+r+'</td>\n            <td class="beer-rating">'+a+'</td>\n            <td class="beer-date">'+i+"</td>",d=ç("tr");d.innerHTML=c,s.appendChild(d),o.appendChild(s)}},Pizazz={check:function(){var e=navigator.userAgent;if(e.indexOf("Firefox")!=-1||e.indexOf("Safari")){var t=ç("img"),n="src/img/logotype.svg";t.setAttribute("src",n);var r=document.getElementById("logotype"),a=é("header");a.replaceChild(t,r)}}};window.addEventListener("DOMContentLoaded",function(){Render.init()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9zcmMvanMvbWFpbi5qcyJdLCJuYW1lcyI6WyLDqSIsInNlbGVjdG9yIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiw6ciLCJjcmVhdGVFbGVtZW50IiwiJGh0dHAiLCJ1cmwiLCJjb3JlIiwiYWpheCIsIm1ldGhvZCIsInByb21pc2UiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImNsaWVudCIsIlhNTEh0dHBSZXF1ZXN0IiwidXJpIiwib3BlbiIsInNlbmQiLCJvbmxvYWQiLCJzdGF0dXMiLCJ0aGlzIiwib25lcnJvciIsInN0YXR1c1RleHQiLCJnZXQiLCJmZXRjaENvbnRlbnQiLCJmZXRjaEZpbGUiLCJmIiwiZSIsImZpbGUiLCJzdWNjZXNzIiwiZGF0YSIsIkpTT04iLCJwYXJzZSIsIlJlbmRlciIsImdldFBhcnQiLCJidWlsZExpc3QiLCJlcnJvciIsIkVycm9yIiwidGhlbiIsImNhbGxiYWNrIiwiY2F0Y2giLCJwYXJ0aWFscyIsIk1hcCIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24iLCJfZGlkSXRlcmF0b3JFcnJvciIsIl9pdGVyYXRvckVycm9yIiwidW5kZWZpbmVkIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm5leHQiLCJkb25lIiwicGFydCIsInZhbHVlIiwiZXJyIiwicmV0dXJuIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIiLCJfZGlkSXRlcmF0b3JFcnJvcjIiLCJfaXRlcmF0b3JFcnJvcjIiLCJfc3RlcDIiLCJfaXRlcmF0b3IyIiwiZmlsZXMiLCJmZXRjaEdpZ3MiLCJnaWdzIiwiY2VsbHMiLCJ0aXRsZSIsImVudHJ5IiwiZmVlZCIsInVwZGF0ZWQiLCIkdCIsInN1YnN0ciIsInJlbW92ZSIsImlubmVySFRNTCIsInNvcnQiLCJnZXRFbGVtZW50QnlJZCIsInQiLCJUYWJsZXMiLCJnaWdMaXN0IiwiZ3N4JGhlYWRsaW5lIiwiZ3N4JHRleHQiLCJnc3gkc3RhcnRkYXRlIiwibGVuZ3RoIiwic29ydHRhYmxlIiwibWFrZVNvcnRhYmxlIiwib3B0aW9ucyIsInZhbHVlTmFtZXMiLCJMaXN0IiwiZmV0Y2hCZWVyIiwiZ3N4JGNyZWF0ZWRhdCIsImdzeCRiZWVyYWJ2IiwiZ3N4JHJhdGluZ3Njb3JlIiwiZGF0ZVRyaW0iLCJiZWVyIiwiZWxlbWVudCIsImNvbnRlbnQiLCJhdHRyIiwic2V0QXR0cmlidXRlIiwiaXRlbXMiLCJ1bCIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zIiwiX2RpZEl0ZXJhdG9yRXJyb3IzIiwiX2l0ZXJhdG9yRXJyb3IzIiwiX3N0ZXAzIiwiX2l0ZXJhdG9yMyIsInNldHRpbmdzIiwibiIsInRlbXAiLCJidWlsZCIsImRhdGVGcm9tIiwiZGF0ZVRvIiwiZG9jRnJhZyIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJpIiwiY3JlYXRlRWwiLCJhcHBlbmRDaGlsZCIsImxpIiwicGFyZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwib25jbGljayIsIkludGVyYWN0IiwidG9nZ2xlQ2xpY2tlZCIsInBhcmVudEVsIiwiZWxlbSIsImJvZHkiLCJyZXBsYWNlQ2hpbGQiLCJpbmRleE9mIiwiUGl6YXp6IiwiY2hlY2siLCJBZ2UiLCJjYWxjIiwiaW5pdCIsIlJlcXVlc3QiLCJpc0luZGV4IiwiUGFyc2VyIiwiaXNQYWdlIiwiaGFzaCIsImxvY2F0aW9uIiwicmVsTGluayIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGljayIsImRpdiIsImVsIiwiY2xhc3NOYW1lIiwidGltZSIsImdldEF0dHJpYnV0ZSIsInRvZGF5IiwiRGF0ZSIsImdldE1vbnRoIiwibm93IiwiZ2V0RnVsbFllYXIiLCJtb250aCIsInBhcnNlSW50IiwiZ2V0RGF0ZSIsInNsaWNlIiwiYmlydGgiLCJqb2luIiwicGF0aG5hbWUiLCJuYW1lIiwiZGF0ZSIsInRyIiwiYWdlIiwibGlzdCIsImZyYWciLCJiZWVyTGlzdCIsImJyZXdlcnkiLCJiTmFtZSIsImJUeXBlIiwiYkFidiIsImJS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LEdBQVVnQyxHQUFBckssU0FBQWdILHlCQXNDRm9ELEVBQU90SyxFQUFFLG1CQXBDbkJ3SSxFQUFBQSwyRUFDUXRJLEVBRFJzSSw4R0FGWWtDLEVBRVpsQyw4R0FPUXRJLEVBUFJzSSx5REFTS29DLEVBVExwQyw4Q0FVQ3FDLEVBVkRyQyw0Q0FnRGdDc0MsRUFoRGhDdEMsUUFrRFU0QixFQUFLaEssRUFBRSxLQXBDZjJFLEdBQUFBLFVBQVNnRyxFQUNYUixFQUFBbEQsWUFBQStDLEdBc0NJRSxFQUFLakQsWUFBWWtELEtBS25CckMsUUE3QkVrQyxNQUFHekYsV0FDSDRGLEdBQUFBLEdBQUtsRCxVQUFZK0MsU0FrQ2pCLElBQUd4RCxFQUFFcUIsUUFBUSxhQUFjLEdBQU1yQixFQUFFcUIsUUFBUSxVQUFVLENBOUJ6RHVDLEdBQVVRLEdBQUE1SyxFQUFBLE9BQ0FtSyxFQUFnQnJELHNCQUNoQm9ELEdBQVNuRSxhQUFBLE1BQWY4RSxFQWlDSSxJQUFNQyxHQUFNaEwsU0FBUzJFLGVBQWUsWUFuQjdCekUsRUFBWEosRUFBQSxTQUVBdUssR0FBS2xELGFBQUwyRCxFQUFBRSxLQXlCUnBDLFFBQU9DLGlCQUFpQixtQkFBb0IsV0FuQnRDYixPQUFBQSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgw6kgPSBzZWxlY3RvciA9PiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbmNvbnN0IMOnID0gc2VsZWN0b3IgPT4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChzZWxlY3Rvcik7XG5cbi8qIGdsb2JhbCBzb3J0dGFibGUsIExpc3QgKi9cblxuY29uc3QgUGFyc2VyID0gKCgpID0+IHtcblxuICAgIGZ1bmN0aW9uICRodHRwKHVybCl7XG4gICAgICAgIGNvbnN0IGNvcmUgPSB7XG4gICAgICAgICAgICBhamF4OiAobWV0aG9kLCB1cmwpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsaWVudCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1cmkgPSB1cmw7XG4gICAgICAgICAgICAgICAgICAgIGNsaWVudC5vcGVuKG1ldGhvZCwgdXJpKTtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50LnNlbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyA+PSAyMDAgJiYgdGhpcy5zdGF0dXMgPCAzMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMucmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QodGhpcy5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50Lm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QodGhpcy5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICdnZXQnOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvcmUuYWpheCgnR0VUJywgdXJsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAgIGZldGNoQ29udGVudDogKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHBhcnRpYWxzID0gbmV3IE1hcChbXG4gICAgICAgICAgICAgICAgWydoZWFkZXInLCAnYmluL3BhcnRpYWxzL2hlYWRlci5odG1sJ10sXG4gICAgICAgICAgICAgICAgWycuY29udGFjdCcsICdiaW4vcGFydGlhbHMvY29udGFjdC5odG1sJ10sXG4gICAgICAgICAgICAgICAgWydhc2lkZScsICdiaW4vcGFydGlhbHMvYXNpZGUuaHRtbCddXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgICAgIGxldCBmaWxlcyA9IFtcbiAgICAgICAgICAgICAgICAnZXhwZXJpZW5jZSdcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHBhcnQgb2YgcGFydGlhbHMpIHtcbiAgICAgICAgICAgICAgICBmZXRjaEZpbGUocGFydFsxXSwgcGFydFswXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgICAgICAgICAgICBmZXRjaEZpbGUoZmlsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmdW5jdGlvbiBmZXRjaEZpbGUoZiwgZSkge1xuICAgICAgICAgICAgICAgIGxldCBmaWxlID0gZSA/IGYgOiAnYmluL2pzL2pzb24vJytmKycuanNvbic7XG4gICAgICAgICAgICAgICAgY29uc3QgY2FsbGJhY2sgPSB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGUgPyBkYXRhIDogSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVuZGVyLmdldFBhcnQoZGF0YSwgZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgUmVuZGVyLmJ1aWxkTGlzdChkYXRhLCBmKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAkaHR0cChmaWxlKS5nZXQoKVxuICAgICAgICAgICAgICAgIC50aGVuKGNhbGxiYWNrLnN1Y2Nlc3MpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGNhbGxiYWNrLmVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZmV0Y2hHaWdzOiAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgZ2lncyA9ICcvL3NwcmVhZHNoZWV0cy5nb29nbGUuY29tL2ZlZWRzL2xpc3QvMVRmMnZSeTZtZTlGM2tuUVNBNUZwZnZyVEx1TmV0bGtkME1tYjJQMjBKcW8vMS9wdWJsaWMvdmFsdWVzP2FsdD1qc29uJztcblxuICAgICAgICAgICAgY29uc3QgY2FsbGJhY2sgPSB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbGxzID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGl0bGUgPSBjZWxscy5mZWVkLmVudHJ5O1xuICAgICAgICAgICAgICAgICAgICBsZXQgdXBkYXRlZCA9IGNlbGxzLmZlZWQudXBkYXRlZC4kdDtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZCA9IGBMYXN0IHVwZGF0ZWQ6ICR7dXBkYXRlZC5zdWJzdHIoMCwxMCl9YDtcbiAgICAgICAgICAgICAgICAgICAgw6koJyNhdHRlbmRlZC1naWdzIC5tZGwtc3Bpbm5lcicpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICDDqSgnI2dpZ3MgLm1kbC10b29sdGlwJykuaW5uZXJIVE1MID0gdXBkYXRlZDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc29ydCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnaWdsaXN0Jyk7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgdCBpbiB0aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQgPiAwKSBUYWJsZXMuZ2lnTGlzdCh0aXRsZVt0XS5nc3gkaGVhZGxpbmUuJHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZVt0XS5nc3gkdGV4dC4kdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlW3RdLmdzeCRzdGFydGRhdGUuJHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQgPT0gdGl0bGUubGVuZ3RoLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3J0dGFibGUubWFrZVNvcnRhYmxlKHNvcnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlTmFtZXM6IFsnZ2lnLW5hbWUnLCAnZ2lnLWxvY2F0aW9uJywgJ2dpZy1kYXRlJ11cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBMaXN0KCdhdHRlbmRlZC1naWdzJywgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAkaHR0cChnaWdzKS5nZXQoKVxuICAgICAgICAgICAgLnRoZW4oY2FsbGJhY2suc3VjY2VzcylcbiAgICAgICAgICAgIC5jYXRjaChjYWxsYmFjay5lcnJvcik7XG4gICAgICAgIH0sXG4gICAgICAgIGZldGNoQmVlcjogKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGJlZXIgPSAnLy9zcHJlYWRzaGVldHMuZ29vZ2xlLmNvbS9mZWVkcy9saXN0LzFhMDU2cnVJVFdNcjhvZUpFQ2I4UU02ZVBlMDBJcVRURUlrcmtoWS1RZU1JLzEvcHVibGljL3ZhbHVlcz9hbHQ9anNvbic7XG5cbiAgICAgICAgICAgIGNvbnN0IGNhbGxiYWNrID0ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjZWxscyA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpdGxlID0gY2VsbHMuZmVlZC5lbnRyeTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHVwZGF0ZWQgPSBjZWxscy5mZWVkLnVwZGF0ZWQuJHQ7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWQgPSBgTGFzdCB1cGRhdGVkOiAke3VwZGF0ZWQuc3Vic3RyKDAsMTApfWA7XG4gICAgICAgICAgICAgICAgICAgIMOpKCcjdW50YXBwZC1zdGF0cyAubWRsLXNwaW5uZXInKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgw6koJyNiZWVycyAubWRsLXRvb2x0aXAnKS5pbm5lckhUTUwgPSB1cGRhdGVkO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzb3J0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JlZXJsaXN0Jyk7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgdCBpbiB0aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGVUcmltID0gdGl0bGVbdF0uZ3N4JGNyZWF0ZWRhdC4kdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVUcmltID0gZGF0ZVRyaW0uc3Vic3RyKDAsMTApO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQgPiAwKSBUYWJsZXMuYmVlckxpc3QodGl0bGVbdF0uZ3N4JGJyZXdlcnluYW1lLiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVbdF0uZ3N4JGJlZXJuYW1lLiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVbdF0uZ3N4JGJlZXJ0eXBlLiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVbdF0uZ3N4JGJlZXJhYnYuJHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZVt0XS5nc3gkcmF0aW5nc2NvcmUuJHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlVHJpbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodCA9PSB0aXRsZS5sZW5ndGgtMSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ydHRhYmxlLm1ha2VTb3J0YWJsZShzb3J0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZU5hbWVzOiBbJ2JyZXdlcnknLCAnYmVlci1uYW1lJywgJ2JlZXItdHlwZScsICdiZWVyLWFidicsICdiZWVyLXJhdGluZycsICdiZWVyLWRhdGUnXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IExpc3QoJ3VudGFwcGQtc3RhdHMnLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICRodHRwKGJlZXIpLmdldCgpXG4gICAgICAgICAgICAudGhlbihjYWxsYmFjay5zdWNjZXNzKVxuICAgICAgICAgICAgLmNhdGNoKGNhbGxiYWNrLmVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgfTtcblxufSkoKTtcblxuY29uc3QgUmVuZGVyID0ge1xuXG4gICAgc2V0dGluZ3M6IHtcbiAgICAgICAgY3JlYXRlRWw6ICdkaXYnLFxuICAgICAgICBwYXJlbnRFbDogJ21haW4nXG4gICAgfSxcblxuICAgIGJ1aWxkTGlzdDogKGRhdGEsIGYpID0+IHtcbiAgICAgICAgZGF0YSA9IGRhdGEuaXRlbXM7XG4gICAgICAgIGNvbnN0IHBhcmVudCA9IMOpKCcuJysgZik7XG4gICAgICAgIGNvbnN0IHVsID0gw6coJ3VsJyk7XG5cbiAgICAgICAgZnVuY3Rpb24gYnVpbGQoZWxlbWVudCwgY29udGVudCwgYXR0cikge1xuICAgICAgICAgICAgZWxlbWVudCA9IMOnKGVsZW1lbnQpO1xuICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjb250ZW50KSk7XG4gICAgICAgICAgICBhdHRyICYmIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdocmVmJywgJy8vJyArIGNvbnRlbnQpO1xuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgZGF0YSkge1xuICAgICAgICAgICAgY29uc3QgbGkgPSDDpygnbGknKTtcblxuICAgICAgICAgICAgbGV0IHRlbXAgPSBbXG4gICAgICAgICAgICAgICAgYnVpbGQoJ2gyJywgbi50aXRsZSksXG4gICAgICAgICAgICAgICAgYnVpbGQoJ2gzJywgbi5wb3NpdGlvbiksXG4gICAgICAgICAgICAgICAgYnVpbGQoJ3RpbWUnLCBuLmRhdGVGcm9tKSxcbiAgICAgICAgICAgICAgICBidWlsZCgnc3BhbicsICfigJQnKSxcbiAgICAgICAgICAgICAgICBidWlsZCgndGltZScsIG4uZGF0ZVRvKSxcbiAgICAgICAgICAgICAgICBuLnVybCAmJiBidWlsZCgnYScsIG4udXJsLCAxKVxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgY29uc3QgZG9jRnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0ZW1wLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGVtcFtpXSAmJiBkb2NGcmFnLmFwcGVuZENoaWxkKHRlbXBbaV0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsaS5hcHBlbmRDaGlsZChkb2NGcmFnKTtcbiAgICAgICAgICAgIHVsLmFwcGVuZENoaWxkKGxpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZCh1bCk7XG4gICAgfSxcblxuICAgIGdldFBhcnQ6IChkYXRhLCBlKSA9PiB7XG4gICAgICAgIGlmICh+ZS5pbmRleE9mKCcuJykpIHtcblxuICAgICAgICAgICAgLy8gZSByZWZlcnMgdG8gYSBjbGFzc25hbWVcbiAgICAgICAgICAgIGUgPSBlLnN1YnN0cigxKTtcblxuICAgICAgICAgICAgLy8gY3JlYXRpbmcgYSBkaXYgd2l0aCBjbGFzc25hbWUgZVxuICAgICAgICAgICAgbGV0IHRlbXAgPSDDpyhSZW5kZXIuc2V0dGluZ3MuY3JlYXRlRWwpO1xuICAgICAgICAgICAgdGVtcC5jbGFzc0xpc3QuYWRkKGUpO1xuXG4gICAgICAgICAgICAvLyBhZGQgZGF0YSBhbmQgYXR0YWNoIGNsaWNrIGhhbmRsZXJcbiAgICAgICAgICAgIHRlbXAuaW5uZXJIVE1MID0gZGF0YTtcbiAgICAgICAgICAgIHRlbXAub25jbGljayA9IEludGVyYWN0LnRvZ2dsZUNsaWNrZWQ7XG5cbiAgICAgICAgICAgIC8vIGFwcGVuZCB0byBwYXJlbnQgPG1haW4+XG4gICAgICAgICAgICBjb25zdCBwYXJlbnQgPSDDqShSZW5kZXIuc2V0dGluZ3MucGFyZW50RWwpO1xuICAgICAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKHRlbXApO1xuXG4gICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgIC8vIGUgcmVmZXJzIHRvIGFuIGV4aXN0aW5nIGVsZW1lbnRcbiAgICAgICAgICAgIGNvbnN0IGVsZW0gPSDDqShlKTtcblxuICAgICAgICAgICAgLy8gY3JlYXRlIHRoZSAobmV3KSBlbGVtZW50XG4gICAgICAgICAgICBsZXQgdGVtcCA9IMOnKGUpO1xuXG4gICAgICAgICAgICAvLyBhZGQgZGF0YVxuICAgICAgICAgICAgdGVtcC5pbm5lckhUTUwgPSBkYXRhO1xuXG4gICAgICAgICAgICB0ZW1wLm9uY2xpY2sgPSBJbnRlcmFjdC50b2dnbGVDbGlja2VkO1xuXG4gICAgICAgICAgICAvLyByZXBsYWNlIGV4aXN0aW5nIGVsZW1lbnQgd2l0aCBuZXdcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVwbGFjZUNoaWxkKHRlbXAsIGVsZW0pO1xuICAgICAgICAgICAgaWYofmUuaW5kZXhPZignaGVhZGVyJykpIFBpemF6ei5jaGVjaygpO1xuICAgICAgICAgICAgaWYofmUuaW5kZXhPZignYXNpZGUnKSkgQWdlLmNhbGMoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBpbml0OiAoKSA9PiB7XG4gICAgICAgIGlmIChSZXF1ZXN0LmlzSW5kZXgoKSkgUGFyc2VyLmZldGNoQ29udGVudCgpO1xuICAgICAgICBpZiAoUmVxdWVzdC5pc1BhZ2UoJy9zdGF0cy8nKSl7XG4gICAgICAgICAgICBQYXJzZXIuZmV0Y2hHaWdzKCk7XG4gICAgICAgICAgICBQYXJzZXIuZmV0Y2hCZWVyKCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGhhc2ggPSBkb2N1bWVudC5sb2NhdGlvbi5oYXNoO1xuICAgICAgICAgICAgaWYgKGhhc2gpIHtcbiAgICAgICAgICAgICAgICBsZXQgcmVsTGluayA9IMOpKCdhW2hyZWY9XCInKyBoYXNoICsnXCJdJyk7XG4gICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJlbExpbmsuY2xpY2soKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufTtcblxuY29uc3QgSW50ZXJhY3QgPSB7XG5cbiAgICB0b2dnbGVDbGlja2VkOiAoZSkgPT4ge1xuICAgICAgICBjb25zdCBwYXJlbnQgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50Lm5vZGVOYW1lO1xuICAgICAgICBjb25zdCBkaXYgPSBlLnRhcmdldC5jbGFzc0xpc3Q7XG4gICAgICAgIGlmKHBhcmVudCA9PSAnSEVBREVSJyB8fCBwYXJlbnQgPT0gJ01BSU4nIHx8IGRpdiA9PSAnbG9jYXRlJyl7XG4gICAgICAgICAgICBjb25zdCBlbCA9IMOpKCdoZWFkZXInKTtcbiAgICAgICAgICAgIGVsLmNsYXNzTmFtZSA9PSAnY2xpY2tlZCcgPyBlbC5jbGFzc05hbWUgPSAncmV2ZXJzZScgOiBlbC5jbGFzc05hbWUgPSAnY2xpY2tlZCc7XG4gICAgICAgIH1cbiAgICB9XG5cbn07XG5cbmNvbnN0IEFnZSA9IHtcblxuICAgIGNhbGM6ICgpID0+IHtcbiAgICAgICAgY29uc3QgZWwgPSDDqSgndGltZScpO1xuICAgICAgICBjb25zdCB0aW1lID0gZWwuZ2V0QXR0cmlidXRlKCdkYXRldGltZScpO1xuICAgICAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGNvbnN0IG1vbnRoID0gdG9kYXkuZ2V0TW9udGgoKSsxIDw9IDkgPyAnJyt0b2RheS5nZXRNb250aCgpKzEgOiB0b2RheS5nZXRNb250aCgpKzE7XG5cbiAgICAgICAgbGV0IG5vdyA9IFtcbiAgICAgICAgICAgIHRvZGF5LmdldEZ1bGxZZWFyKCksXG4gICAgICAgICAgICBtb250aCxcbiAgICAgICAgICAgIHBhcnNlSW50KCgnMCcgKyB0b2RheS5nZXREYXRlKCkpLnNsaWNlKC0yKSlcbiAgICAgICAgXTtcbiAgICAgICAgbGV0IGJpcnRoID0gW1xuICAgICAgICAgICAgdGltZS5zbGljZSgwLDQpLFxuICAgICAgICAgICAgdGltZS5zbGljZSg1LDcpLFxuICAgICAgICAgICAgdGltZS5zbGljZSg4LDEwKVxuICAgICAgICBdO1xuXG4gICAgICAgIG5vdyA9IG5vdy5qb2luKCcnKTtcbiAgICAgICAgYmlydGggPSBiaXJ0aC5qb2luKCcnKTtcblxuICAgICAgICBjb25zdCBhZ2UgPSAobm93IC0gYmlydGgpLnRvU3RyaW5nKCkuc2xpY2UoMCwyKTtcbiAgICAgICAgZWwuaW5uZXJIVE1MID0gYWdlICsgJywnO1xuICAgIH1cblxufTtcblxuY29uc3QgUmVxdWVzdCA9IHtcblxuICAgIGlzSW5kZXg6ICgpID0+IHtcbiAgICAgICAgaWYgKGRvY3VtZW50LmxvY2F0aW9uLnBhdGhuYW1lID09ICcvJykge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgaXNQYWdlOiAodXJsKSA9PiB7XG4gICAgICAgIGlmIChkb2N1bWVudC5sb2NhdGlvbi5wYXRobmFtZSA9PSB1cmwpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG59O1xuXG5jb25zdCBUYWJsZXMgPSB7XG4gICAgLy8gTk9UIFVTRUQgT04gTUFJTiBQQUdFXG5cbiAgICBnaWdMaXN0OiAobmFtZSwgbG9jYXRpb24sIGRhdGUpID0+IHtcbiAgICAgICAgY29uc3QgZnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgY29uc3QgbGlzdCA9IMOpKCcjZ2lnbGlzdCB0Ym9keScpO1xuICAgICAgICBsZXQgZ2lnID0gYDx0ZCBjbGFzcz1cIm1kbC1kYXRhLXRhYmxlX19jZWxsLS1ub24tbnVtZXJpYyBnaWctbmFtZVwiPlxuICAgICAgICAgICAgICAgICR7bmFtZX1cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8dGQgY2xhc3M9XCJtZGwtZGF0YS10YWJsZV9fY2VsbC0tbm9uLW51bWVyaWMgZ2lnLWxvY2F0aW9uXCI+XG4gICAgICAgICAgICAgICAgJHtsb2NhdGlvbn1cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8dGQgY2xhc3M9XCJnaWctZGF0ZVwiPiR7ZGF0ZX08L3RkPmA7XG5cbiAgICAgICAgY29uc3QgdHIgPSDDpygndHInKTtcbiAgICAgICAgdHIuaW5uZXJIVE1MID0gZ2lnO1xuICAgICAgICBmcmFnLmFwcGVuZENoaWxkKHRyKTtcbiAgICAgICAgbGlzdC5hcHBlbmRDaGlsZChmcmFnKTtcbiAgICB9LFxuXG4gICAgYmVlckxpc3Q6IChicmV3ZXJ5LCBiTmFtZSwgYlR5cGUsIGJBYnYsIGJSYXRpbmcsIGJEYXRlKSA9PiB7XG4gICAgICAgIGNvbnN0IGZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgIGNvbnN0IGxpc3QgPSDDqSgnI2JlZXJsaXN0IHRib2R5Jyk7XG4gICAgICAgIGxldCBicmV3ID0gYDx0ZCBjbGFzcz1cIm1kbC1kYXRhLXRhYmxlX19jZWxsLS1ub24tbnVtZXJpYyBicmV3ZXJ5XCI+XG4gICAgICAgICAgICAgICAgJHticmV3ZXJ5fVxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDx0ZCBjbGFzcz1cIm1kbC1kYXRhLXRhYmxlX19jZWxsLS1ub24tbnVtZXJpYyBiZWVyLW5hbWVcIj5cbiAgICAgICAgICAgICAgICAke2JOYW1lfVxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDx0ZCBjbGFzcz1cIm1kbC1kYXRhLXRhYmxlX19jZWxsLS1ub24tbnVtZXJpYyBiZWVyLXR5cGVcIj5cbiAgICAgICAgICAgICAgICAke2JUeXBlfVxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDx0ZCBjbGFzcz1cImJlZXItYWJ2XCI+JHtiQWJ2fTwvdGQ+XG4gICAgICAgICAgICA8dGQgY2xhc3M9XCJiZWVyLXJhdGluZ1wiPiR7YlJhdGluZ308L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwiYmVlci1kYXRlXCI+JHtiRGF0ZX08L3RkPmA7XG5cbiAgICAgICAgY29uc3QgdHIgPSDDpygndHInKTtcbiAgICAgICAgdHIuaW5uZXJIVE1MID0gYnJldztcbiAgICAgICAgZnJhZy5hcHBlbmRDaGlsZCh0cik7XG4gICAgICAgIGxpc3QuYXBwZW5kQ2hpbGQoZnJhZyk7XG4gICAgfVxuXG59O1xuXG5jb25zdCBQaXphenogPSB7XG4gICAgLy8gZmFsbGJhY2tzIGZvciB2aXN1YWwgZ29vZGllc1xuICAgIGNoZWNrOiAoKSA9PiB7XG4gICAgICAgIGxldCBuID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcbiAgICAgICAgLy8geWVhaCB5ZWFoLCBzaG91bGRuJ3QgdXNlIGJyb3dzZXIgc25pZmZpbmcsIGJ1dCB3aGF0ZXZlci4uLlxuXG4gICAgICAgIGlmKG4uaW5kZXhPZignRmlyZWZveCcpICE9IC0xIHx8IG4uaW5kZXhPZignU2FmYXJpJykpe1xuICAgICAgICAgICAgbGV0IHN2Z1JlcGxhY2UgPSDDpygnaW1nJyk7XG4gICAgICAgICAgICBjb25zdCBpbWFnZVJlcGxhY2VtZW50ID0gJ3NyYy9pbWcvbG9nb3R5cGUuc3ZnJztcbiAgICAgICAgICAgIHN2Z1JlcGxhY2Uuc2V0QXR0cmlidXRlKCdzcmMnLCBpbWFnZVJlcGxhY2VtZW50KTtcblxuICAgICAgICAgICAgY29uc3Qgc3ZnID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ290eXBlJyk7XG4gICAgICAgICAgICBjb25zdCBoZWFkZXIgPSDDqSgnaGVhZGVyJyk7XG5cbiAgICAgICAgICAgIGhlYWRlci5yZXBsYWNlQ2hpbGQoc3ZnUmVwbGFjZSwgc3ZnKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xuICAgIFJlbmRlci5pbml0KCk7XG59KTtcbiJdfQ==
