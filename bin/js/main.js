"use strict";var é=function(e){return document.querySelector(e)},ç=function(e){return document.createElement(e)},Parser=function(){function e(e){var t={ajax:function(e,t){var n=new Promise(function(n,r){var a=new XMLHttpRequest,i=t;a.open(e,i),a.send(),a.onload=function(){this.status>=200&&this.status<300?n(this.response):r(this.statusText)},a.onerror=function(){r(this.statusText)}});return n}};return{get:function(){return t.ajax("GET",e)}}}return{fetchContent:function(){function t(t,n){var r=n?t:"bin/js/json/"+t+".json",a={success:function(e){e=n?e:JSON.parse(e),n?Render.getPart(e,n):Render.buildList(e,t)},error:function(e){throw new Error(e)}};e(r).get().then(a.success).catch(a.error)}var n=new Map([["header","bin/partials/header.html"],[".contact","bin/partials/contact.html"],["aside","bin/partials/aside.html"]]),r=["experience"],a=!0,i=!1,s=void 0;try{for(var o,c=n[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var d=o.value;t(d[1],d[0])}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}var l=!0,u=!1,g=void 0;try{for(var f,m=r[Symbol.iterator]();!(l=(f=m.next()).done);l=!0){var h=f.value;t(h)}}catch(e){u=!0,g=e}finally{try{!l&&m.return&&m.return()}finally{if(u)throw g}}},fetchGigs:function(){var t="//spreadsheets.google.com/feeds/list/1Tf2vRy6me9F3knQSA5FpfvrTLuNetlkd0Mmb2P20Jqo/1/public/values?alt=json",n={success:function(e){var t=JSON.parse(e),n=t.feed.entry,r=t.feed.updated.$t;r="Last updated: "+r.substr(0,10),é("#attended-gigs .mdl-spinner").remove(),é("#gigs .mdl-tooltip").innerHTML=r;var a=document.getElementById("giglist");for(var i in n){var s=[n[i].gsx$headline.$t,n[i].gsx$text.$t,n[i].gsx$startdate.$t],o=s[0],c=s[1],d=s[2];if(i>0&&Tables.gigList(o,c,d),i==n.length-1){sorttable.makeSortable(a);var l={valueNames:["gig-name","gig-location","gig-date"]};new List("attended-gigs",l)}}},error:function(e){throw new Error(e)}};e(t).get().then(n.success).catch(n.error)},fetchBeer:function(){var t="//spreadsheets.google.com/feeds/list/1a056ruITWMr8oeJECb8QM6ePe00IqTTEIkrkhY-QeMI/1/public/values?alt=json",n={success:function(e){var t=JSON.parse(e),n=t.feed.entry,r=t.feed.updated.$t;r="Last updated: "+r.substr(0,10),é("#untappd-stats .mdl-spinner").remove(),é("#beers .mdl-tooltip").innerHTML=r;var a=document.getElementById("beerlist");for(var i in n){var s=[n[i].gsx$breweryname.$t,n[i].gsx$beername.$t,n[i].gsx$beertype.$t,n[i].gsx$beerabv.$t,n[i].gsx$ratingscore.$t,n[i].gsx$createdat.$t.substr(0,10)],o=s[0],c=s[1],d=s[2],l=s[3],u=s[4],g=s[5];if(i>0&&Tables.beerList(o,c,d,l,u,g),i==n.length-1){sorttable.makeSortable(a);var f={valueNames:["brewery","beer-name","beer-type","beer-abv","beer-rating","beer-date"]};new List("untappd-stats",f)}}},error:function(e){throw new Error(e)}};e(t).get().then(n.success).catch(n.error)}}}(),Render={settings:{createEl:"div",parentEl:"main"},buildList:function(e,t){function n(e,t,n){return e=ç(e),e.appendChild(document.createTextNode(t)),n&&e.setAttribute("href","//"+t),e}e=e.items;var r=é("."+t),a=ç("ul"),i=!0,s=!1,o=void 0;try{for(var c,d=e[Symbol.iterator]();!(i=(c=d.next()).done);i=!0){for(var l=c.value,u=ç("li"),g=[n("h2",l.title),n("h3",l.position),n("time",l.dateFrom),n("span","—"),n("time",l.dateTo),l.url&&n("a",l.url,1)],f=document.createDocumentFragment(),m=0;m<g.length;m++)g[m]&&f.appendChild(g[m]);u.appendChild(f),a.appendChild(u)}}catch(e){s=!0,o=e}finally{try{!i&&d.return&&d.return()}finally{if(s)throw o}}r.appendChild(a)},getPart:function(e,t){if(~t.indexOf(".")){t=t.substr(1);var n=ç(Render.settings.createEl);n.classList.add(t),n.innerHTML=e,n.onclick=Interact.toggleClicked;var r=é(Render.settings.parentEl);r.appendChild(n)}else{var a=é(t),i=ç(t);i.innerHTML=e,i.onclick=Interact.toggleClicked,document.body.replaceChild(i,a),~t.indexOf("header")&&Pizazz.check(),~t.indexOf("aside")&&Age.calc()}},init:function(){if(Request.isIndex()&&Parser.fetchContent(),Request.isPage("/stats/")){Parser.fetchGigs(),Parser.fetchBeer();var e=document.location.hash;e&&!function(){var t=é('a[href="'+e+'"]');window.addEventListener("load",function(){t.click()})}()}}},Interact={toggleClicked:function(e){var t=e.target.parentElement.nodeName,n=e.target.classList;if("HEADER"==t||"MAIN"==t||"locate"==n){var r=é("header");"clicked"==r.className?r.className="reverse":r.className="clicked"}}},Age={calc:function(){var e=é("time"),t=e.getAttribute("datetime"),n=new Date,r=n.getMonth()+1<=9?""+n.getMonth()+1:n.getMonth()+1,a=[n.getFullYear(),r,parseInt(("0"+n.getDate()).slice(-2))],i=[t.slice(0,4),t.slice(5,7),t.slice(8,10)];a=a.join(""),i=i.join("");var s=(a-i).toString().slice(0,2);e.innerHTML=s+","}},Request={isIndex:function(){if("/"==document.location.pathname)return!0},isPage:function(e){if(document.location.pathname==e)return!0}},Tables={gigList:function(e,t,n){var r=document.createDocumentFragment(),a=é("#giglist tbody"),i='<td class="mdl-data-table__cell--non-numeric gig-name">\n                '+e+'\n            </td>\n            <td class="mdl-data-table__cell--non-numeric gig-location">\n                '+t+'\n            </td>\n            <td class="gig-date">'+n+"</td>",s=ç("tr");s.innerHTML=i,r.appendChild(s),a.appendChild(r)},beerList:function(e,t,n,r,a,i){var s=document.createDocumentFragment(),o=é("#beerlist tbody"),c='<td class="mdl-data-table__cell--non-numeric brewery">\n                '+e+'\n            </td>\n            <td class="mdl-data-table__cell--non-numeric beer-name">\n                '+t+'\n            </td>\n            <td class="mdl-data-table__cell--non-numeric beer-type">\n                '+n+'\n            </td>\n            <td class="beer-abv">'+r+'</td>\n            <td class="beer-rating">'+a+'</td>\n            <td class="beer-date">'+i+"</td>",d=ç("tr");d.innerHTML=c,s.appendChild(d),o.appendChild(s)}},Pizazz={check:function(){var e=navigator.userAgent,t=e.indexOf("Firefox")!=-1||e.indexOf("Safari")!=-1,n=e.indexOf("Chrome")!=-1;if(t&&!n){var r=ç("img"),a="src/img/logotype.svg";r.setAttribute("src",a);var i=document.getElementById("logotype"),s=é("header");s.replaceChild(r,i)}}};window.addEventListener("DOMContentLoaded",function(){Render.init()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9zcmMvanMvbWFpbi5qcyJdLCJuYW1lcyI6WyLDqSIsInNlbGVjdG9yIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiw6ciLCJjcmVhdGVFbGVtZW50IiwiJGh0dHAiLCJ1cmwiLCJjb3JlIiwiYWpheCIsIm1ldGhvZCIsInByb21pc2UiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImNsaWVudCIsIlhNTEh0dHBSZXF1ZXN0IiwidXJpIiwib3BlbiIsInNlbmQiLCJvbmxvYWQiLCJzdGF0dXMiLCJ0aGlzIiwib25lcnJvciIsInN0YXR1c1RleHQiLCJnZXQiLCJmZXRjaENvbnRlbnQiLCJmZXRjaEZpbGUiLCJmIiwiZSIsImZpbGUiLCJzdWNjZXNzIiwiZGF0YSIsIkpTT04iLCJwYXJzZSIsIlJlbmRlciIsImdldFBhcnQiLCJidWlsZExpc3QiLCJlcnJvciIsIkVycm9yIiwidGhlbiIsImNhbGxiYWNrIiwiY2F0Y2giLCJwYXJ0aWFscyIsIk1hcCIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24iLCJfZGlkSXRlcmF0b3JFcnJvciIsIl9pdGVyYXRvckVycm9yIiwidW5kZWZpbmVkIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm5leHQiLCJkb25lIiwicGFydCIsInZhbHVlIiwiZXJyIiwicmV0dXJuIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIiLCJfZGlkSXRlcmF0b3JFcnJvcjIiLCJfaXRlcmF0b3JFcnJvcjIiLCJfc3RlcDIiLCJfaXRlcmF0b3IyIiwiZmlsZXMiLCJmZXRjaEdpZ3MiLCJnaWdzIiwiY2VsbHMiLCJ0aXRsZSIsImVudHJ5IiwiZmVlZCIsInVwZGF0ZWQiLCIkdCIsInN1YnN0ciIsInJlbW92ZSIsImlubmVySFRNTCIsInNvcnQiLCJnZXRFbGVtZW50QnlJZCIsInQiLCJfcmVmIiwiZ3N4JGhlYWRsaW5lIiwiZ3N4JHRleHQiLCJnc3gkc3RhcnRkYXRlIiwibmFtZSIsImxvY2F0aW9uIiwiZGF0ZSIsIlRhYmxlcyIsImdpZ0xpc3QiLCJsZW5ndGgiLCJzb3J0dGFibGUiLCJtYWtlU29ydGFibGUiLCJvcHRpb25zIiwidmFsdWVOYW1lcyIsIkxpc3QiLCJiZWVyIiwiX3JlZjIiLCJnc3gkYnJld2VyeW5hbWUiLCJnc3gkYmVlcnR5cGUiLCJicmV3ZXJ5IiwiYk5hbWUiLCJiVHlwZSIsImJlZXJMaXN0IiwiYkFidiIsImJSYXRpbmciLCJkYXRlVHJpbSIsInNldHRpbmdzIiwiY3JlYXRlRWwiLCJwYXJlbnRFbCIsImJ1aWxkIiwiZWxlbWVudCIsImNvbnRlbnQiLCJhdHRyIiwiYXBwZW5kQ2hpbGQiLCJjcmVhdGVUZXh0Tm9kZSIsInNldEF0dHJpYnV0ZSIsIml0ZW1zIiwicGFyZW50IiwidWwiLCJfc3RlcDMiLCJfaXRlcmF0b3IzIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjMiLCJuIiwibGkiLCJ0ZW1wIiwicG9zaXRpb24iLCJkYXRlRnJvbSIsImRhdGVUbyIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJpIiwiZG9jRnJhZyIsImluZGV4T2YiLCJjbGFzc0xpc3QiLCJhZGQiLCJvbmNsaWNrIiwiZWxlbSIsIkludGVyYWN0IiwidG9nZ2xlQ2xpY2tlZCIsImJvZHkiLCJyZXBsYWNlQ2hpbGQiLCJQaXphenoiLCJjaGVjayIsIkFnZSIsImNhbGMiLCJpbml0IiwiUmVxdWVzdCIsImlzSW5kZXgiLCJQYXJzZXIiLCJpc1BhZ2UiLCJmZXRjaEJlZXIiLCJyZWxMaW5rIiwiaGFzaCIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGljayIsInRhcmdldCIsInBhcmVudEVsZW1lbnQiLCJub2RlTmFtZSIsImRpdiIsImVsIiwiY2xhc3NOYW1lIiwidGltZSIsImdldEF0dHJpYnV0ZSIsInRvZGF5IiwiRGF0ZSIsImdldE1vbnRoIiwibW9udGgiLCJwYXJzZUludCIsInNsaWNlIiwiYmlydGgiLCJub3ciLCJqb2luIiwiYWdlIiwidG9TdHJpbmciLCJwYXRobmFtZSIsImZyYWciLCJ0ciIsImdpZyIsImxpc3QiLCJiRGF0ZSIsImJyZXciLCJjaHJvbWUiLCJzdmdSZXBsYWNlIiwiaW1hZ2VSZXBsYWNlbWVudCIsInN2ZyIsImhlYWRlciIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCJdLCJtYXBwaW5ncyI6IllBQUEsSUFBTUEsR0FBSSxTQUFBQyxHQUFBLE1BQVlDLFVBQVNDLGNBQWNGLElBQ3ZDRyxFQUFJLFNBQUFILEdBQUEsTUFBWUMsVUFBU0csY0FBY0osSUFBdkNHLE9BQUksV0FBVixRQUFBRSxHQUFBQyxHQU9RLEdBQU1DLElBTGRDLEtBQUEsU0FBQUMsRUFBQUgsR0FPZ0IsR0FBTUksR0FBVSxHQUFJQyxTQUFRLFNBQVNDLEVBQVNDLEdBTDlDLEdBQU1DLEdBQUEsR0FBQUMsZ0JBT0lDLEVBQU1WLENBTGJBLEdBQUlXLEtBQUFSLEVBQUFPLEdBQ0ZGLEVBQUFJLE9BQ0hKLEVBQUFLLE9BQUNWLFdBQ0dDLEtBQVVVLFFBQVksS0FBQUMsS0FBU1QsT0FBU0MsSUFDcENDLEVBQVNPLEtBQUlOLFVBRVpFLEVBQUtSLEtBQVFPLGFBR2hCRixFQUFBUSxRQUFTRixXQUNMUixFQUFBQSxLQUFRVyxjQUdYLE9BQUFiLElBR0RHLFFBQ0hXLElBQUEsV0FDSixNQWZEakIsR0FBQUMsS0FBQSxNQUFBRixLQW9CSixPQUVDbUIsYUFBQSxXQWU0QixRQUFBQyxHQUFBQyxFQUFBQyxHQU96QixHQUFJQyxHQUFPRCxFQUFJRCxFQUFJLGVBQWVBLEVBQUUsUUFOcENELEdBQ0hJLFFBQUEsU0FBQUMsR0FYZUEsRUFBQUgsRUFBQUcsRUFBQUMsS0FBQUMsTUFBQUYsR0FBQUgsRUFBQU0sT0FBQUMsUUFBQUosRUFBQUgsR0FBQU0sT0FBQUUsVUFBQUwsRUFBQUosSUFBQVUsTUFBQSxTQUFBTixHQUFBLEtBQUEsSUFBQU8sT0FBQVAsSUFBQTFCLEdBQUF3QixHQUFBTCxNQUFBZSxLQUFBQyxFQUFBVixTQUFBVyxNQUFBRCxFQUFBSCxPQVRwQixHQUFBSyxHQUFBLEdBQUFDLE9BS0gsU0FB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b3IgPT4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG5jb25zdCDDpyA9IHNlbGVjdG9yID0+IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoc2VsZWN0b3IpO1xuXG4vKiBnbG9iYWwgc29ydHRhYmxlLCBMaXN0ICovXG5cbmNvbnN0IFBhcnNlciA9ICgoKSA9PiB7XG5cbiAgICBmdW5jdGlvbiAkaHR0cCh1cmwpe1xuICAgICAgICBjb25zdCBjb3JlID0ge1xuICAgICAgICAgICAgYWpheDogKG1ldGhvZCwgdXJsKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjbGllbnQgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXJpID0gdXJsO1xuICAgICAgICAgICAgICAgICAgICBjbGllbnQub3BlbihtZXRob2QsIHVyaSk7XG4gICAgICAgICAgICAgICAgICAgIGNsaWVudC5zZW5kKCk7XG4gICAgICAgICAgICAgICAgICAgIGNsaWVudC5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGF0dXMgPj0gMjAwICYmIHRoaXMuc3RhdHVzIDwgMzAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLnJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHRoaXMuc3RhdHVzVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGNsaWVudC5vbmVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHRoaXMuc3RhdHVzVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAnZ2V0JzogKCkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBjb3JlLmFqYXgoJ0dFVCcsIHVybCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICBmZXRjaENvbnRlbnQ6ICgpID0+IHtcbiAgICAgICAgICAgIGxldCBwYXJ0aWFscyA9IG5ldyBNYXAoW1xuICAgICAgICAgICAgICAgIFsnaGVhZGVyJywgJ2Jpbi9wYXJ0aWFscy9oZWFkZXIuaHRtbCddLFxuICAgICAgICAgICAgICAgIFsnLmNvbnRhY3QnLCAnYmluL3BhcnRpYWxzL2NvbnRhY3QuaHRtbCddLFxuICAgICAgICAgICAgICAgIFsnYXNpZGUnLCAnYmluL3BhcnRpYWxzL2FzaWRlLmh0bWwnXVxuICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICBsZXQgZmlsZXMgPSBbXG4gICAgICAgICAgICAgICAgJ2V4cGVyaWVuY2UnXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgZm9yIChjb25zdCBwYXJ0IG9mIHBhcnRpYWxzKSB7XG4gICAgICAgICAgICAgICAgZmV0Y2hGaWxlKHBhcnRbMV0sIHBhcnRbMF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICAgICAgICAgICAgZmV0Y2hGaWxlKGZpbGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnVuY3Rpb24gZmV0Y2hGaWxlKGYsIGUpIHtcbiAgICAgICAgICAgICAgICBsZXQgZmlsZSA9IGUgPyBmIDogJ2Jpbi9qcy9qc29uLycrZisnLmpzb24nO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNhbGxiYWNrID0ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBlID8gZGF0YSA6IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlbmRlci5nZXRQYXJ0KGRhdGEsIGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIFJlbmRlci5idWlsZExpc3QoZGF0YSwgZik7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgJGh0dHAoZmlsZSkuZ2V0KClcbiAgICAgICAgICAgICAgICAudGhlbihjYWxsYmFjay5zdWNjZXNzKVxuICAgICAgICAgICAgICAgIC5jYXRjaChjYWxsYmFjay5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGZldGNoR2lnczogKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZ2lncyA9ICcvL3NwcmVhZHNoZWV0cy5nb29nbGUuY29tL2ZlZWRzL2xpc3QvMVRmMnZSeTZtZTlGM2tuUVNBNUZwZnZyVEx1TmV0bGtkME1tYjJQMjBKcW8vMS9wdWJsaWMvdmFsdWVzP2FsdD1qc29uJztcblxuICAgICAgICAgICAgY29uc3QgY2FsbGJhY2sgPSB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbGxzID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGl0bGUgPSBjZWxscy5mZWVkLmVudHJ5O1xuICAgICAgICAgICAgICAgICAgICBsZXQgdXBkYXRlZCA9IGNlbGxzLmZlZWQudXBkYXRlZC4kdDtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZCA9IGBMYXN0IHVwZGF0ZWQ6ICR7dXBkYXRlZC5zdWJzdHIoMCwxMCl9YDtcbiAgICAgICAgICAgICAgICAgICAgw6koJyNhdHRlbmRlZC1naWdzIC5tZGwtc3Bpbm5lcicpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICDDqSgnI2dpZ3MgLm1kbC10b29sdGlwJykuaW5uZXJIVE1MID0gdXBkYXRlZDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc29ydCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnaWdsaXN0Jyk7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgdCBpbiB0aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IFtuYW1lLCBsb2NhdGlvbiwgZGF0ZV0gPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVbdF0uZ3N4JGhlYWRsaW5lLiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlW3RdLmdzeCR0ZXh0LiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlW3RdLmdzeCRzdGFydGRhdGUuJHRcbiAgICAgICAgICAgICAgICAgICAgICAgIF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ID4gMCkgVGFibGVzLmdpZ0xpc3QobmFtZSwgbG9jYXRpb24sIGRhdGUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodCA9PSB0aXRsZS5sZW5ndGgtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvcnR0YWJsZS5tYWtlU29ydGFibGUoc29ydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVOYW1lczogWydnaWctbmFtZScsICdnaWctbG9jYXRpb24nLCAnZ2lnLWRhdGUnXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IExpc3QoJ2F0dGVuZGVkLWdpZ3MnLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICRodHRwKGdpZ3MpLmdldCgpXG4gICAgICAgICAgICAudGhlbihjYWxsYmFjay5zdWNjZXNzKVxuICAgICAgICAgICAgLmNhdGNoKGNhbGxiYWNrLmVycm9yKTtcbiAgICAgICAgfSxcbiAgICAgICAgZmV0Y2hCZWVyOiAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBiZWVyID0gJy8vc3ByZWFkc2hlZXRzLmdvb2dsZS5jb20vZmVlZHMvbGlzdC8xYTA1NnJ1SVRXTXI4b2VKRUNiOFFNNmVQZTAwSXFUVEVJa3JraFktUWVNSS8xL3B1YmxpYy92YWx1ZXM/YWx0PWpzb24nO1xuXG4gICAgICAgICAgICBjb25zdCBjYWxsYmFjayA9IHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2VsbHMgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0aXRsZSA9IGNlbGxzLmZlZWQuZW50cnk7XG4gICAgICAgICAgICAgICAgICAgIGxldCB1cGRhdGVkID0gY2VsbHMuZmVlZC51cGRhdGVkLiR0O1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVkID0gYExhc3QgdXBkYXRlZDogJHt1cGRhdGVkLnN1YnN0cigwLDEwKX1gO1xuICAgICAgICAgICAgICAgICAgICDDqSgnI3VudGFwcGQtc3RhdHMgLm1kbC1zcGlubmVyJykucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgIMOpKCcjYmVlcnMgLm1kbC10b29sdGlwJykuaW5uZXJIVE1MID0gdXBkYXRlZDtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc29ydCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiZWVybGlzdCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHQgaW4gdGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJld2VyeSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiQWJ2LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJSYXRpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVRyaW1cbiAgICAgICAgICAgICAgICAgICAgICAgIF0gPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVbdF0uZ3N4JGJyZXdlcnluYW1lLiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlW3RdLmdzeCRiZWVybmFtZS4kdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZVt0XS5nc3gkYmVlcnR5cGUuJHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVbdF0uZ3N4JGJlZXJhYnYuJHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVbdF0uZ3N4JHJhdGluZ3Njb3JlLiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlW3RdLmdzeCRjcmVhdGVkYXQuJHQuc3Vic3RyKDAsMTApXG4gICAgICAgICAgICAgICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodCA+IDApIFRhYmxlcy5iZWVyTGlzdChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmV3ZXJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJUeXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJBYnYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYlJhdGluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlVHJpbVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ID09IHRpdGxlLmxlbmd0aC0xKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3J0dGFibGUubWFrZVNvcnRhYmxlKHNvcnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlTmFtZXM6IFsnYnJld2VyeScsICdiZWVyLW5hbWUnLCAnYmVlci10eXBlJywgJ2JlZXItYWJ2JywgJ2JlZXItcmF0aW5nJywgJ2JlZXItZGF0ZSddXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTGlzdCgndW50YXBwZC1zdGF0cycsIG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihkYXRhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgJGh0dHAoYmVlcikuZ2V0KClcbiAgICAgICAgICAgIC50aGVuKGNhbGxiYWNrLnN1Y2Nlc3MpXG4gICAgICAgICAgICAuY2F0Y2goY2FsbGJhY2suZXJyb3IpO1xuICAgICAgICB9XG5cbiAgICB9O1xuXG59KSgpO1xuXG5jb25zdCBSZW5kZXIgPSB7XG5cbiAgICBzZXR0aW5nczoge1xuICAgICAgICBjcmVhdGVFbDogJ2RpdicsXG4gICAgICAgIHBhcmVudEVsOiAnbWFpbidcbiAgICB9LFxuXG4gICAgYnVpbGRMaXN0OiAoZGF0YSwgZikgPT4ge1xuICAgICAgICBkYXRhID0gZGF0YS5pdGVtcztcbiAgICAgICAgY29uc3QgcGFyZW50ID0gw6koJy4nKyBmKTtcbiAgICAgICAgY29uc3QgdWwgPSDDpygndWwnKTtcblxuICAgICAgICBmdW5jdGlvbiBidWlsZChlbGVtZW50LCBjb250ZW50LCBhdHRyKSB7XG4gICAgICAgICAgICBlbGVtZW50ID0gw6coZWxlbWVudCk7XG4gICAgICAgICAgICBlbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNvbnRlbnQpKTtcbiAgICAgICAgICAgIGF0dHIgJiYgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCAnLy8nICsgY29udGVudCk7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoY29uc3QgbiBvZiBkYXRhKSB7XG4gICAgICAgICAgICBjb25zdCBsaSA9IMOnKCdsaScpO1xuXG4gICAgICAgICAgICBsZXQgdGVtcCA9IFtcbiAgICAgICAgICAgICAgICBidWlsZCgnaDInLCBuLnRpdGxlKSxcbiAgICAgICAgICAgICAgICBidWlsZCgnaDMnLCBuLnBvc2l0aW9uKSxcbiAgICAgICAgICAgICAgICBidWlsZCgndGltZScsIG4uZGF0ZUZyb20pLFxuICAgICAgICAgICAgICAgIGJ1aWxkKCdzcGFuJywgJ+KAlCcpLFxuICAgICAgICAgICAgICAgIGJ1aWxkKCd0aW1lJywgbi5kYXRlVG8pLFxuICAgICAgICAgICAgICAgIG4udXJsICYmIGJ1aWxkKCdhJywgbi51cmwsIDEpXG4gICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICBjb25zdCBkb2NGcmFnID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHRlbXAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB0ZW1wW2ldICYmIGRvY0ZyYWcuYXBwZW5kQ2hpbGQodGVtcFtpXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxpLmFwcGVuZENoaWxkKGRvY0ZyYWcpO1xuICAgICAgICAgICAgdWwuYXBwZW5kQ2hpbGQobGkpO1xuICAgICAgICB9XG5cbiAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKHVsKTtcbiAgICB9LFxuXG4gICAgZ2V0UGFydDogKGRhdGEsIGUpID0+IHtcbiAgICAgICAgaWYgKH5lLmluZGV4T2YoJy4nKSkge1xuXG4gICAgICAgICAgICAvLyBlIHJlZmVycyB0byBhIGNsYXNzbmFtZVxuICAgICAgICAgICAgZSA9IGUuc3Vic3RyKDEpO1xuXG4gICAgICAgICAgICAvLyBjcmVhdGluZyBhIGRpdiB3aXRoIGNsYXNzbmFtZSBlXG4gICAgICAgICAgICBsZXQgdGVtcCA9IMOnKFJlbmRlci5zZXR0aW5ncy5jcmVhdGVFbCk7XG4gICAgICAgICAgICB0ZW1wLmNsYXNzTGlzdC5hZGQoZSk7XG5cbiAgICAgICAgICAgIC8vIGFkZCBkYXRhIGFuZCBhdHRhY2ggY2xpY2sgaGFuZGxlclxuICAgICAgICAgICAgdGVtcC5pbm5lckhUTUwgPSBkYXRhO1xuICAgICAgICAgICAgdGVtcC5vbmNsaWNrID0gSW50ZXJhY3QudG9nZ2xlQ2xpY2tlZDtcblxuICAgICAgICAgICAgLy8gYXBwZW5kIHRvIHBhcmVudCA8bWFpbj5cbiAgICAgICAgICAgIGNvbnN0IHBhcmVudCA9IMOpKFJlbmRlci5zZXR0aW5ncy5wYXJlbnRFbCk7XG4gICAgICAgICAgICBwYXJlbnQuYXBwZW5kQ2hpbGQodGVtcCk7XG5cbiAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgLy8gZSByZWZlcnMgdG8gYW4gZXhpc3RpbmcgZWxlbWVudFxuICAgICAgICAgICAgY29uc3QgZWxlbSA9IMOpKGUpO1xuXG4gICAgICAgICAgICAvLyBjcmVhdGUgdGhlIChuZXcpIGVsZW1lbnRcbiAgICAgICAgICAgIGxldCB0ZW1wID0gw6coZSk7XG5cbiAgICAgICAgICAgIC8vIGFkZCBkYXRhXG4gICAgICAgICAgICB0ZW1wLmlubmVySFRNTCA9IGRhdGE7XG5cbiAgICAgICAgICAgIHRlbXAub25jbGljayA9IEludGVyYWN0LnRvZ2dsZUNsaWNrZWQ7XG5cbiAgICAgICAgICAgIC8vIHJlcGxhY2UgZXhpc3RpbmcgZWxlbWVudCB3aXRoIG5ld1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZXBsYWNlQ2hpbGQodGVtcCwgZWxlbSk7XG4gICAgICAgICAgICBpZih+ZS5pbmRleE9mKCdoZWFkZXInKSkgUGl6YXp6LmNoZWNrKCk7XG4gICAgICAgICAgICBpZih+ZS5pbmRleE9mKCdhc2lkZScpKSBBZ2UuY2FsYygpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGluaXQ6ICgpID0+IHtcbiAgICAgICAgaWYgKFJlcXVlc3QuaXNJbmRleCgpKSBQYXJzZXIuZmV0Y2hDb250ZW50KCk7XG4gICAgICAgIGlmIChSZXF1ZXN0LmlzUGFnZSgnL3N0YXRzLycpKXtcbiAgICAgICAgICAgIFBhcnNlci5mZXRjaEdpZ3MoKTtcbiAgICAgICAgICAgIFBhcnNlci5mZXRjaEJlZXIoKTtcblxuICAgICAgICAgICAgY29uc3QgaGFzaCA9IGRvY3VtZW50LmxvY2F0aW9uLmhhc2g7XG4gICAgICAgICAgICBpZiAoaGFzaCkge1xuICAgICAgICAgICAgICAgIGxldCByZWxMaW5rID0gw6koJ2FbaHJlZj1cIicrIGhhc2ggKydcIl0nKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmVsTGluay5jbGljaygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG59O1xuXG5jb25zdCBJbnRlcmFjdCA9IHtcblxuICAgIHRvZ2dsZUNsaWNrZWQ6IChlKSA9PiB7XG4gICAgICAgIGNvbnN0IHBhcmVudCA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQubm9kZU5hbWU7XG4gICAgICAgIGNvbnN0IGRpdiA9IGUudGFyZ2V0LmNsYXNzTGlzdDtcbiAgICAgICAgaWYocGFyZW50ID09ICdIRUFERVInIHx8IHBhcmVudCA9PSAnTUFJTicgfHwgZGl2ID09ICdsb2NhdGUnKXtcbiAgICAgICAgICAgIGNvbnN0IGVsID0gw6koJ2hlYWRlcicpO1xuICAgICAgICAgICAgZWwuY2xhc3NOYW1lID09ICdjbGlja2VkJyA/IGVsLmNsYXNzTmFtZSA9ICdyZXZlcnNlJyA6IGVsLmNsYXNzTmFtZSA9ICdjbGlja2VkJztcbiAgICAgICAgfVxuICAgIH1cblxufTtcblxuY29uc3QgQWdlID0ge1xuXG4gICAgY2FsYzogKCkgPT4ge1xuICAgICAgICBjb25zdCBlbCA9IMOpKCd0aW1lJyk7XG4gICAgICAgIGNvbnN0IHRpbWUgPSBlbC5nZXRBdHRyaWJ1dGUoJ2RhdGV0aW1lJyk7XG4gICAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICAgICAgY29uc3QgbW9udGggPSB0b2RheS5nZXRNb250aCgpKzEgPD0gOSA/ICcnK3RvZGF5LmdldE1vbnRoKCkrMSA6IHRvZGF5LmdldE1vbnRoKCkrMTtcblxuICAgICAgICBsZXQgbm93ID0gW1xuICAgICAgICAgICAgdG9kYXkuZ2V0RnVsbFllYXIoKSxcbiAgICAgICAgICAgIG1vbnRoLFxuICAgICAgICAgICAgcGFyc2VJbnQoKCcwJyArIHRvZGF5LmdldERhdGUoKSkuc2xpY2UoLTIpKVxuICAgICAgICBdO1xuICAgICAgICBsZXQgYmlydGggPSBbXG4gICAgICAgICAgICB0aW1lLnNsaWNlKDAsNCksXG4gICAgICAgICAgICB0aW1lLnNsaWNlKDUsNyksXG4gICAgICAgICAgICB0aW1lLnNsaWNlKDgsMTApXG4gICAgICAgIF07XG5cbiAgICAgICAgbm93ID0gbm93LmpvaW4oJycpO1xuICAgICAgICBiaXJ0aCA9IGJpcnRoLmpvaW4oJycpO1xuXG4gICAgICAgIGNvbnN0IGFnZSA9IChub3cgLSBiaXJ0aCkudG9TdHJpbmcoKS5zbGljZSgwLDIpO1xuICAgICAgICBlbC5pbm5lckhUTUwgPSBhZ2UgKyAnLCc7XG4gICAgfVxuXG59O1xuXG5jb25zdCBSZXF1ZXN0ID0ge1xuXG4gICAgaXNJbmRleDogKCkgPT4ge1xuICAgICAgICBpZiAoZG9jdW1lbnQubG9jYXRpb24ucGF0aG5hbWUgPT0gJy8nKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBpc1BhZ2U6ICh1cmwpID0+IHtcbiAgICAgICAgaWYgKGRvY3VtZW50LmxvY2F0aW9uLnBhdGhuYW1lID09IHVybCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbn07XG5cbmNvbnN0IFRhYmxlcyA9IHtcbiAgICAvLyBOT1QgVVNFRCBPTiBNQUlOIFBBR0VcblxuICAgIGdpZ0xpc3Q6IChuYW1lLCBsb2NhdGlvbiwgZGF0ZSkgPT4ge1xuICAgICAgICBjb25zdCBmcmFnID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgICBjb25zdCBsaXN0ID0gw6koJyNnaWdsaXN0IHRib2R5Jyk7XG4gICAgICAgIGxldCBnaWcgPSBgPHRkIGNsYXNzPVwibWRsLWRhdGEtdGFibGVfX2NlbGwtLW5vbi1udW1lcmljIGdpZy1uYW1lXCI+XG4gICAgICAgICAgICAgICAgJHtuYW1lfVxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDx0ZCBjbGFzcz1cIm1kbC1kYXRhLXRhYmxlX19jZWxsLS1ub24tbnVtZXJpYyBnaWctbG9jYXRpb25cIj5cbiAgICAgICAgICAgICAgICAke2xvY2F0aW9ufVxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDx0ZCBjbGFzcz1cImdpZy1kYXRlXCI+JHtkYXRlfTwvdGQ+YDtcblxuICAgICAgICBjb25zdCB0ciA9IMOnKCd0cicpO1xuICAgICAgICB0ci5pbm5lckhUTUwgPSBnaWc7XG4gICAgICAgIGZyYWcuYXBwZW5kQ2hpbGQodHIpO1xuICAgICAgICBsaXN0LmFwcGVuZENoaWxkKGZyYWcpO1xuICAgIH0sXG5cbiAgICBiZWVyTGlzdDogKGJyZXdlcnksIGJOYW1lLCBiVHlwZSwgYkFidiwgYlJhdGluZywgYkRhdGUpID0+IHtcbiAgICAgICAgY29uc3QgZnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgY29uc3QgbGlzdCA9IMOpKCcjYmVlcmxpc3QgdGJvZHknKTtcbiAgICAgICAgbGV0IGJyZXcgPSBgPHRkIGNsYXNzPVwibWRsLWRhdGEtdGFibGVfX2NlbGwtLW5vbi1udW1lcmljIGJyZXdlcnlcIj5cbiAgICAgICAgICAgICAgICAke2JyZXdlcnl9XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwibWRsLWRhdGEtdGFibGVfX2NlbGwtLW5vbi1udW1lcmljIGJlZXItbmFtZVwiPlxuICAgICAgICAgICAgICAgICR7Yk5hbWV9XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwibWRsLWRhdGEtdGFibGVfX2NlbGwtLW5vbi1udW1lcmljIGJlZXItdHlwZVwiPlxuICAgICAgICAgICAgICAgICR7YlR5cGV9XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwiYmVlci1hYnZcIj4ke2JBYnZ9PC90ZD5cbiAgICAgICAgICAgIDx0ZCBjbGFzcz1cImJlZXItcmF0aW5nXCI+JHtiUmF0aW5nfTwvdGQ+XG4gICAgICAgICAgICA8dGQgY2xhc3M9XCJiZWVyLWRhdGVcIj4ke2JEYXRlfTwvdGQ+YDtcblxuICAgICAgICBjb25zdCB0ciA9IMOnKCd0cicpO1xuICAgICAgICB0ci5pbm5lckhUTUwgPSBicmV3O1xuICAgICAgICBmcmFnLmFwcGVuZENoaWxkKHRyKTtcbiAgICAgICAgbGlzdC5hcHBlbmRDaGlsZChmcmFnKTtcbiAgICB9XG5cbn07XG5cbmNvbnN0IFBpemF6eiA9IHtcbiAgICAvLyBmYWxsYmFja3MgZm9yIHZpc3VhbCBnb29kaWVzXG4gICAgY2hlY2s6ICgpID0+IHtcbiAgICAgICAgbGV0IG4gPSBuYXZpZ2F0b3IudXNlckFnZW50O1xuICAgICAgICAvLyB5ZWFoIHllYWgsIHNob3VsZG4ndCB1c2UgYnJvd3NlciBzbmlmZmluZywgYnV0IHdoYXRldmVyLi4uXG4gICAgICAgIGNvbnN0IGJyb3dzZXIgPSAobi5pbmRleE9mKCdGaXJlZm94JykgIT0gLTEgfHwgbi5pbmRleE9mKCdTYWZhcmknKSAhPSAtMSk7XG4gICAgICAgIGNvbnN0IGNocm9tZSA9IG4uaW5kZXhPZignQ2hyb21lJykgIT0gLTE7XG5cbiAgICAgICAgaWYgKGJyb3dzZXIgJiYgIWNocm9tZSkge1xuICAgICAgICAgICAgbGV0IHN2Z1JlcGxhY2UgPSDDpygnaW1nJyk7XG4gICAgICAgICAgICBjb25zdCBpbWFnZVJlcGxhY2VtZW50ID0gJ3NyYy9pbWcvbG9nb3R5cGUuc3ZnJztcbiAgICAgICAgICAgIHN2Z1JlcGxhY2Uuc2V0QXR0cmlidXRlKCdzcmMnLCBpbWFnZVJlcGxhY2VtZW50KTtcblxuICAgICAgICAgICAgY29uc3Qgc3ZnID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ290eXBlJyk7XG4gICAgICAgICAgICBjb25zdCBoZWFkZXIgPSDDqSgnaGVhZGVyJyk7XG5cbiAgICAgICAgICAgIGhlYWRlci5yZXBsYWNlQ2hpbGQoc3ZnUmVwbGFjZSwgc3ZnKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKCkgPT4ge1xuICAgIFJlbmRlci5pbml0KCk7XG59KTtcbiJdfQ==
