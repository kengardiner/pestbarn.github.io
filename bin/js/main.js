"use strict";var é=function(e){return document.querySelector(e)},ç=function(e){return document.createElement(e)},Parser=function(){function e(e){var t={ajax:function(e,t){var n=new Promise(function(n,r){var a=new XMLHttpRequest,i=t;a.open(e,i),a.send(),a.onload=function(){this.status>=200&&this.status<300?n(this.response):r(this.statusText)},a.onerror=function(){r(this.statusText)}});return n}};return{get:function(){return t.ajax("GET",e)}}}return{fetchContent:function(){function t(t,n){var r=n?t:"bin/js/json/"+t+".json",a={success:function(e){e=n?e:JSON.parse(e),n?Render.getPart(e,n):Render.buildList(e,t)},error:function(e){throw new Error(e)}};e(r).get().then(a.success).catch(a.error)}var n=new Map([["header","bin/partials/header.html"],[".contact","bin/partials/contact.html"],["aside","bin/partials/aside.html"]]),r=["experience"],a=!0,i=!1,s=void 0;try{for(var o,c=n[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var d=o.value;t(d[1],d[0])}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}var l=!0,u=!1,g=void 0;try{for(var f,m=r[Symbol.iterator]();!(l=(f=m.next()).done);l=!0){var h=f.value;t(h)}}catch(e){u=!0,g=e}finally{try{!l&&m.return&&m.return()}finally{if(u)throw g}}},fetchGigs:function(){var t="//spreadsheets.google.com/feeds/list/1Tf2vRy6me9F3knQSA5FpfvrTLuNetlkd0Mmb2P20Jqo/1/public/values?alt=json",n={success:function(e){var t=JSON.parse(e),n=t.feed.entry,r=t.feed.updated.$t;r="Last updated: "+r.substr(0,10),é("#attended-gigs .mdl-spinner").remove(),é("#gigs .mdl-tooltip").innerHTML=r;var a=document.getElementById("giglist");for(var i in n)if(i>0&&Tables.gigList(n[i].gsx$headline.$t,n[i].gsx$text.$t,n[i].gsx$startdate.$t),i==n.length-1){sorttable.makeSortable(a);var s={valueNames:["gig-name","gig-location","gig-date"]};new List("attended-gigs",s)}},error:function(e){throw new Error(e)}};e(t).get().then(n.success).catch(n.error)},fetchBeer:function(){var t="//spreadsheets.google.com/feeds/list/1a056ruITWMr8oeJECb8QM6ePe00IqTTEIkrkhY-QeMI/1/public/values?alt=json",n={success:function(e){var t=JSON.parse(e),n=t.feed.entry,r=t.feed.updated.$t;r="Last updated: "+r.substr(0,10),é("#untappd-stats .mdl-spinner").remove(),é("#beers .mdl-tooltip").innerHTML=r;var a=document.getElementById("beerlist");for(var i in n){var s=n[i].gsx$createdat.$t;if(s=s.substr(0,10),i>0&&Tables.beerList(n[i].gsx$breweryname.$t,n[i].gsx$beername.$t,n[i].gsx$beertype.$t,n[i].gsx$beerabv.$t,n[i].gsx$ratingscore.$t,s),i==n.length-1){sorttable.makeSortable(a);var o={valueNames:["brewery","beer-name","beer-type","beer-abv","beer-rating","beer-date"]};new List("untappd-stats",o)}}},error:function(e){throw new Error(e)}};e(t).get().then(n.success).catch(n.error)}}}(),Render={settings:{createEl:"div",parentEl:"main"},buildList:function(e,t){function n(e,t,n){return e=ç(e),e.appendChild(document.createTextNode(t)),n&&e.setAttribute("href","//"+t),e}e=e.items;var r=é("."+t),a=ç("ul"),i=!0,s=!1,o=void 0;try{for(var c,d=e[Symbol.iterator]();!(i=(c=d.next()).done);i=!0){for(var l=c.value,u=ç("li"),g=[n("h2",l.title),n("h3",l.position),n("time",l.dateFrom),n("span","—"),n("time",l.dateTo),l.url&&n("a",l.url,1)],f=document.createDocumentFragment(),m=0;m<g.length;m++)g[m]&&f.appendChild(g[m]);u.appendChild(f),a.appendChild(u)}}catch(e){s=!0,o=e}finally{try{!i&&d.return&&d.return()}finally{if(s)throw o}}r.appendChild(a)},getPart:function(e,t){if(~t.indexOf(".")){t=t.substr(1);var n=ç(Render.settings.createEl);n.classList.add(t),n.innerHTML=e,n.onclick=Interact.toggleClicked;var r=é(Render.settings.parentEl);r.appendChild(n)}else{var a=é(t);n=ç(t),n.innerHTML=e,n.onclick=Interact.toggleClicked,document.body.replaceChild(n,a),~t.indexOf("aside")&&Age.calc()}},init:function(){if(Request.isIndex()&&Parser.fetchContent(),Request.isPage("/stats/")){Parser.fetchGigs(),Parser.fetchBeer();var e=document.location.hash;e&&!function(){var t=é('a[href="'+e+'"]');window.addEventListener("load",function(){t.click()})}()}}},Interact={toggleClicked:function(){var e=(void 0).nodeName;if("HEADER"==e||"contact"==(void 0).classList){var t=é("header");"clicked"==t.className?t.className="reverse":t.className="clicked"}}},Age={calc:function(){var e=é("time"),t=e.getAttribute("datetime"),n=new Date,r=[n.getFullYear(),n.getMonth()+1,("0"+n.getDate()).slice(-2)],a=[t.slice(0,4),t.slice(5,7),t.slice(8,10)];r=r.join(""),a=a.join("");var i=(r-a).toString().slice(0,2);e.innerHTML=i+","}},Request={isIndex:function(){if("/"==document.location.pathname)return!0},isPage:function(e){if(document.location.pathname==e)return!0}},Tables={gigList:function(e,t,n){var r=document.createDocumentFragment(),a=é("#giglist tbody"),i='<td class="mdl-data-table__cell--non-numeric gig-name">\n                '+e+'\n            </td>\n            <td class="mdl-data-table__cell--non-numeric gig-location">\n                '+t+'\n            </td>\n            <td class="gig-date">'+n+"</td>",s=ç("tr");s.innerHTML=i,r.appendChild(s),a.appendChild(r)},beerList:function(e,t,n,r,a,i){var s=document.createDocumentFragment(),o=é("#beerlist tbody"),c='<td class="mdl-data-table__cell--non-numeric brewery">\n                '+e+'\n            </td>\n            <td class="mdl-data-table__cell--non-numeric beer-name">\n                '+t+'\n            </td>\n            <td class="mdl-data-table__cell--non-numeric beer-type">\n                '+n+'\n            </td>\n            <td class="beer-abv">'+r+'</td>\n            <td class="beer-rating">'+a+'</td>\n            <td class="beer-date">'+i+"</td>",d=ç("tr");d.innerHTML=c,s.appendChild(d),o.appendChild(s)}};window.addEventListener("DOMContentLoaded",function(){Render.init()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9zcmMvanMvbWFpbi5qcyJdLCJuYW1lcyI6WyLDqSIsInNlbGVjdG9yIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiw6ciLCJjcmVhdGVFbGVtZW50IiwiJGh0dHAiLCJ1cmwiLCJjb3JlIiwiYWpheCIsIm1ldGhvZCIsInByb21pc2UiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImNsaWVudCIsIlhNTEh0dHBSZXF1ZXN0IiwidXJpIiwib3BlbiIsInNlbmQiLCJvbmxvYWQiLCJzdGF0dXMiLCJ0aGlzIiwib25lcnJvciIsInN0YXR1c1RleHQiLCJnZXQiLCJmZXRjaENvbnRlbnQiLCJmZXRjaEZpbGUiLCJmIiwiZSIsImZpbGUiLCJzdWNjZXNzIiwiZGF0YSIsIkpTT04iLCJwYXJzZSIsIlJlbmRlciIsImdldFBhcnQiLCJidWlsZExpc3QiLCJlcnJvciIsIkVycm9yIiwidGhlbiIsImNhbGxiYWNrIiwiY2F0Y2giLCJwYXJ0aWFscyIsIk1hcCIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24iLCJfZGlkSXRlcmF0b3JFcnJvciIsIl9pdGVyYXRvckVycm9yIiwidW5kZWZpbmVkIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm5leHQiLCJkb25lIiwicGFydCIsInZhbHVlIiwiZXJyIiwicmV0dXJuIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIiLCJfZGlkSXRlcmF0b3JFcnJvcjIiLCJfaXRlcmF0b3JFcnJvcjIiLCJfc3RlcDIiLCJfaXRlcmF0b3IyIiwiZmlsZXMiLCJmZXRjaEdpZ3MiLCJnaWdzIiwiY2VsbHMiLCJ0aXRsZSIsImVudHJ5IiwiZmVlZCIsInVwZGF0ZWQiLCIkdCIsInN1YnN0ciIsInJlbW92ZSIsImlubmVySFRNTCIsInNvcnQiLCJnZXRFbGVtZW50QnlJZCIsInQiLCJUYWJsZXMiLCJnaWdMaXN0IiwiZ3N4JGhlYWRsaW5lIiwiZ3N4JHRleHQiLCJnc3gkc3RhcnRkYXRlIiwibGVuZ3RoIiwic29ydHRhYmxlIiwibWFrZVNvcnRhYmxlIiwib3B0aW9ucyIsInZhbHVlTmFtZXMiLCJMaXN0IiwiZmV0Y2hCZWVyIiwiZ3N4JGNyZWF0ZWRhdCIsImdzeCRiZWVyYWJ2IiwiZ3N4JHJhdGluZ3Njb3JlIiwiZGF0ZVRyaW0iLCJiZWVyIiwiZWxlbWVudCIsImNvbnRlbnQiLCJhdHRyIiwic2V0QXR0cmlidXRlIiwiaXRlbXMiLCJ1bCIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zIiwiX2RpZEl0ZXJhdG9yRXJyb3IzIiwiX2l0ZXJhdG9yRXJyb3IzIiwiX3N0ZXAzIiwiX2l0ZXJhdG9yMyIsInNldHRpbmdzIiwibiIsInRlbXAiLCJidWlsZCIsImRhdGVGcm9tIiwiZGF0ZVRvIiwiZG9jRnJhZyIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJpIiwiY3JlYXRlRWwiLCJhcHBlbmRDaGlsZCIsImxpIiwicGFyZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwib25jbGljayIsIkludGVyYWN0IiwidG9nZ2xlQ2xpY2tlZCIsInBhcmVudEVsIiwiZWxlbSIsImJvZHkiLCJyZXBsYWNlQ2hpbGQiLCJpbmRleE9mIiwiQWdlIiwiY2FsYyIsImluaXQiLCJSZXF1ZXN0IiwiaXNJbmRleCIsIlBhcnNlciIsImlzUGFnZSIsImhhc2giLCJsb2NhdGlvbiIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZWxMaW5rIiwiY2xpY2siLCJjbGlja2VkIiwibm9kZU5hbWUiLCJlbCIsImNsYXNzTmFtZSIsInRpbWUiLCJnZXRBdHRyaWJ1dGUiLCJ0b2RheSIsIkRhdGUiLCJub3ciLCJnZXREYXRlIiwic2xpY2UiLCJiaXJ0aCIsImpvaW4iLCJhZ2UiLCJ0b1N0cmluZyIsInBhdGhuYW1lIiwibmFtZSIsImRhdGUiLCJmcmFnIiwidHIiLCJsaXN0IiwiYmVlckxpc3QiLCJicmV3ZXJ5IiwiYk5hbWUiLCJiVHlwZSIsImJBYnYiLCJiUmF0aW5nIiwiYkRhdGUiLCJicmV3Il0sIm1hcHBpbmdzIjoi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QUFBNEMsSUFXTHRCLFFBQUFDLGlCQUFBLG1CQUFBLFdBQ0FzQixPQUFHdkYiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciDDqSA9IHNlbGVjdG9yID0+IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xudmFyIMOnID0gc2VsZWN0b3IgPT4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChzZWxlY3Rvcik7XG5cbi8qIGdsb2JhbCBzb3J0dGFibGUsIExpc3QgKi9cblxudmFyIFBhcnNlciA9ICgoKSA9PiB7XG5cbiAgICBmdW5jdGlvbiAkaHR0cCh1cmwpe1xuICAgICAgICB2YXIgY29yZSA9IHtcbiAgICAgICAgICAgIGFqYXg6IChtZXRob2QsIHVybCkgPT4ge1xuICAgICAgICAgICAgICAgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjbGllbnQgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVyaSA9IHVybDtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50Lm9wZW4obWV0aG9kLCB1cmkpO1xuICAgICAgICAgICAgICAgICAgICBjbGllbnQuc2VuZCgpO1xuICAgICAgICAgICAgICAgICAgICBjbGllbnQub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID49IDIwMCAmJiB0aGlzLnN0YXR1cyA8IDMwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5yZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCh0aGlzLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBjbGllbnQub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCh0aGlzLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgJ2dldCc6ICgpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29yZS5hamF4KCdHRVQnLCB1cmwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgZmV0Y2hDb250ZW50OiAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgcGFydGlhbHMgPSBuZXcgTWFwKFtcbiAgICAgICAgICAgICAgICBbJ2hlYWRlcicsICdiaW4vcGFydGlhbHMvaGVhZGVyLmh0bWwnXSxcbiAgICAgICAgICAgICAgICBbJy5jb250YWN0JywgJ2Jpbi9wYXJ0aWFscy9jb250YWN0Lmh0bWwnXSxcbiAgICAgICAgICAgICAgICBbJ2FzaWRlJywgJ2Jpbi9wYXJ0aWFscy9hc2lkZS5odG1sJ11cbiAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgbGV0IGZpbGVzID0gW1xuICAgICAgICAgICAgICAgICdleHBlcmllbmNlJ1xuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcGFydCBvZiBwYXJ0aWFscykge1xuICAgICAgICAgICAgICAgIGZldGNoRmlsZShwYXJ0WzFdLCBwYXJ0WzBdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgICAgICAgICAgIGZldGNoRmlsZShmaWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIGZldGNoRmlsZShmLCBlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZpbGUgPSBlID8gZiA6ICdiaW4vanMvanNvbi8nK2YrJy5qc29uJztcbiAgICAgICAgICAgICAgICB2YXIgY2FsbGJhY2sgPSB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGUgPyBkYXRhIDogSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVuZGVyLmdldFBhcnQoZGF0YSwgZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgUmVuZGVyLmJ1aWxkTGlzdChkYXRhLCBmKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAkaHR0cChmaWxlKS5nZXQoKVxuICAgICAgICAgICAgICAgIC50aGVuKGNhbGxiYWNrLnN1Y2Nlc3MpXG4gICAgICAgICAgICAgICAgLmNhdGNoKGNhbGxiYWNrLmVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZmV0Y2hHaWdzOiAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgZ2lncyA9ICcvL3NwcmVhZHNoZWV0cy5nb29nbGUuY29tL2ZlZWRzL2xpc3QvMVRmMnZSeTZtZTlGM2tuUVNBNUZwZnZyVEx1TmV0bGtkME1tYjJQMjBKcW8vMS9wdWJsaWMvdmFsdWVzP2FsdD1qc29uJztcblxuICAgICAgICAgICAgdmFyIGNhbGxiYWNrID0ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2VsbHMgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBjZWxscy5mZWVkLmVudHJ5O1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZCA9IGNlbGxzLmZlZWQudXBkYXRlZC4kdDtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZCA9IGBMYXN0IHVwZGF0ZWQ6ICR7dXBkYXRlZC5zdWJzdHIoMCwxMCl9YDtcbiAgICAgICAgICAgICAgICAgICAgw6koJyNhdHRlbmRlZC1naWdzIC5tZGwtc3Bpbm5lcicpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICDDqSgnI2dpZ3MgLm1kbC10b29sdGlwJykuaW5uZXJIVE1MID0gdXBkYXRlZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNvcnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2lnbGlzdCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHQgaW4gdGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ID4gMCkgVGFibGVzLmdpZ0xpc3QodGl0bGVbdF0uZ3N4JGhlYWRsaW5lLiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVbdF0uZ3N4JHRleHQuJHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZVt0XS5nc3gkc3RhcnRkYXRlLiR0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ID09IHRpdGxlLmxlbmd0aC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ydHRhYmxlLm1ha2VTb3J0YWJsZShzb3J0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVOYW1lczogWydnaWctbmFtZScsICdnaWctbG9jYXRpb24nLCAnZ2lnLWRhdGUnXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IExpc3QoJ2F0dGVuZGVkLWdpZ3MnLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICRodHRwKGdpZ3MpLmdldCgpXG4gICAgICAgICAgICAudGhlbihjYWxsYmFjay5zdWNjZXNzKVxuICAgICAgICAgICAgLmNhdGNoKGNhbGxiYWNrLmVycm9yKTtcbiAgICAgICAgfSxcbiAgICAgICAgZmV0Y2hCZWVyOiAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgYmVlciA9ICcvL3NwcmVhZHNoZWV0cy5nb29nbGUuY29tL2ZlZWRzL2xpc3QvMWEwNTZydUlUV01yOG9lSkVDYjhRTTZlUGUwMElxVFRFSWtya2hZLVFlTUkvMS9wdWJsaWMvdmFsdWVzP2FsdD1qc29uJztcblxuICAgICAgICAgICAgdmFyIGNhbGxiYWNrID0ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2VsbHMgPSBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBjZWxscy5mZWVkLmVudHJ5O1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXBkYXRlZCA9IGNlbGxzLmZlZWQudXBkYXRlZC4kdDtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZCA9IGBMYXN0IHVwZGF0ZWQ6ICR7dXBkYXRlZC5zdWJzdHIoMCwxMCl9YDtcbiAgICAgICAgICAgICAgICAgICAgw6koJyN1bnRhcHBkLXN0YXRzIC5tZGwtc3Bpbm5lcicpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICDDqSgnI2JlZXJzIC5tZGwtdG9vbHRpcCcpLmlubmVySFRNTCA9IHVwZGF0ZWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzb3J0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JlZXJsaXN0Jyk7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgdCBpbiB0aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGVUcmltID0gdGl0bGVbdF0uZ3N4JGNyZWF0ZWRhdC4kdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVUcmltID0gZGF0ZVRyaW0uc3Vic3RyKDAsMTApO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQgPiAwKSBUYWJsZXMuYmVlckxpc3QodGl0bGVbdF0uZ3N4JGJyZXdlcnluYW1lLiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVbdF0uZ3N4JGJlZXJuYW1lLiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVbdF0uZ3N4JGJlZXJ0eXBlLiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVbdF0uZ3N4JGJlZXJhYnYuJHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZVt0XS5nc3gkcmF0aW5nc2NvcmUuJHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlVHJpbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodCA9PSB0aXRsZS5sZW5ndGgtMSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ydHRhYmxlLm1ha2VTb3J0YWJsZShzb3J0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVOYW1lczogWydicmV3ZXJ5JywgJ2JlZXItbmFtZScsICdiZWVyLXR5cGUnLCAnYmVlci1hYnYnLCAnYmVlci1yYXRpbmcnLCAnYmVlci1kYXRlJ11cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBMaXN0KCd1bnRhcHBkLXN0YXRzJywgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAkaHR0cChiZWVyKS5nZXQoKVxuICAgICAgICAgICAgLnRoZW4oY2FsbGJhY2suc3VjY2VzcylcbiAgICAgICAgICAgIC5jYXRjaChjYWxsYmFjay5lcnJvcik7XG4gICAgICAgIH1cblxuICAgIH07XG5cbn0pKCk7XG5cbnZhciBSZW5kZXIgPSB7XG5cbiAgICBzZXR0aW5nczoge1xuICAgICAgICBjcmVhdGVFbDogJ2RpdicsXG4gICAgICAgIHBhcmVudEVsOiAnbWFpbidcbiAgICB9LFxuXG4gICAgYnVpbGRMaXN0OiAoZGF0YSwgZikgPT4ge1xuICAgICAgICBkYXRhID0gZGF0YS5pdGVtcztcbiAgICAgICAgdmFyIHBhcmVudCA9IMOpKCcuJysgZik7XG4gICAgICAgIHZhciB1bCA9IMOnKCd1bCcpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGJ1aWxkKGVsZW1lbnQsIGNvbnRlbnQsIGF0dHIpIHtcbiAgICAgICAgICAgIGVsZW1lbnQgPSDDpyhlbGVtZW50KTtcbiAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY29udGVudCkpO1xuICAgICAgICAgICAgYXR0ciAmJiBlbGVtZW50LnNldEF0dHJpYnV0ZSgnaHJlZicsICcvLycgKyBjb250ZW50KTtcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChjb25zdCBuIG9mIGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBsaSA9IMOnKCdsaScpO1xuXG4gICAgICAgICAgICB2YXIgdGVtcCA9IFtcbiAgICAgICAgICAgICAgICBidWlsZCgnaDInLCBuLnRpdGxlKSxcbiAgICAgICAgICAgICAgICBidWlsZCgnaDMnLCBuLnBvc2l0aW9uKSxcbiAgICAgICAgICAgICAgICBidWlsZCgndGltZScsIG4uZGF0ZUZyb20pLFxuICAgICAgICAgICAgICAgIGJ1aWxkKCdzcGFuJywgJ+KAlCcpLFxuICAgICAgICAgICAgICAgIGJ1aWxkKCd0aW1lJywgbi5kYXRlVG8pLFxuICAgICAgICAgICAgICAgIG4udXJsICYmIGJ1aWxkKCdhJywgbi51cmwsIDEpXG4gICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICB2YXIgZG9jRnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0ZW1wLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGVtcFtpXSAmJiBkb2NGcmFnLmFwcGVuZENoaWxkKHRlbXBbaV0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsaS5hcHBlbmRDaGlsZChkb2NGcmFnKTtcbiAgICAgICAgICAgIHVsLmFwcGVuZENoaWxkKGxpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZCh1bCk7XG4gICAgfSxcblxuICAgIGdldFBhcnQ6IChkYXRhLCBlKSA9PiB7XG4gICAgICAgIGlmICh+ZS5pbmRleE9mKCcuJykpIHtcblxuICAgICAgICAgICAgLy8gZSByZWZlcnMgdG8gYSBjbGFzc25hbWVcbiAgICAgICAgICAgIGUgPSBlLnN1YnN0cigxKTtcblxuICAgICAgICAgICAgLy8gY3JlYXRpbmcgYSBkaXYgd2l0aCBjbGFzc25hbWUgZVxuICAgICAgICAgICAgdmFyIHRlbXAgPSDDpyhSZW5kZXIuc2V0dGluZ3MuY3JlYXRlRWwpO1xuICAgICAgICAgICAgdGVtcC5jbGFzc0xpc3QuYWRkKGUpO1xuXG4gICAgICAgICAgICAvLyBhZGQgZGF0YSBhbmQgYXR0YWNoIGNsaWNrIGhhbmRsZXJcbiAgICAgICAgICAgIHRlbXAuaW5uZXJIVE1MID0gZGF0YTtcbiAgICAgICAgICAgIHRlbXAub25jbGljayA9IEludGVyYWN0LnRvZ2dsZUNsaWNrZWQ7XG5cbiAgICAgICAgICAgIC8vIGFwcGVuZCB0byBwYXJlbnQgPG1haW4+XG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gw6koUmVuZGVyLnNldHRpbmdzLnBhcmVudEVsKTtcbiAgICAgICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZCh0ZW1wKTtcblxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAvLyBlIHJlZmVycyB0byBhbiBleGlzdGluZyBlbGVtZW50XG4gICAgICAgICAgICB2YXIgZWxlbSA9IMOpKGUpO1xuXG4gICAgICAgICAgICAvLyBjcmVhdGUgdGhlIChuZXcpIGVsZW1lbnRcbiAgICAgICAgICAgIHRlbXAgPSDDpyhlKTtcblxuICAgICAgICAgICAgLy8gYWRkIGRhdGFcbiAgICAgICAgICAgIHRlbXAuaW5uZXJIVE1MID0gZGF0YTtcblxuICAgICAgICAgICAgdGVtcC5vbmNsaWNrID0gSW50ZXJhY3QudG9nZ2xlQ2xpY2tlZDtcblxuICAgICAgICAgICAgLy8gcmVwbGFjZSBleGlzdGluZyBlbGVtZW50IHdpdGggbmV3XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlcGxhY2VDaGlsZCh0ZW1wLCBlbGVtKTtcbiAgICAgICAgICAgIGlmKH5lLmluZGV4T2YoJ2FzaWRlJykpIEFnZS5jYWxjKCk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgaW5pdDogKCkgPT4ge1xuICAgICAgICBpZiAoUmVxdWVzdC5pc0luZGV4KCkpIFBhcnNlci5mZXRjaENvbnRlbnQoKTtcbiAgICAgICAgaWYgKFJlcXVlc3QuaXNQYWdlKCcvc3RhdHMvJykpe1xuICAgICAgICAgICAgUGFyc2VyLmZldGNoR2lncygpO1xuICAgICAgICAgICAgUGFyc2VyLmZldGNoQmVlcigpO1xuXG4gICAgICAgICAgICB2YXIgaGFzaCA9IGRvY3VtZW50LmxvY2F0aW9uLmhhc2g7XG4gICAgICAgICAgICBpZiAoaGFzaCkge1xuICAgICAgICAgICAgICAgIGxldCByZWxMaW5rID0gw6koJ2FbaHJlZj1cIicrIGhhc2ggKydcIl0nKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmVsTGluay5jbGljaygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG59O1xuXG52YXIgSW50ZXJhY3QgPSB7XG5cbiAgICB0b2dnbGVDbGlja2VkOiAoKSA9PiB7XG4gICAgICAgIHZhciBjbGlja2VkID0gdGhpcy5ub2RlTmFtZTtcbiAgICAgICAgaWYoY2xpY2tlZCA9PSAnSEVBREVSJ3x8dGhpcy5jbGFzc0xpc3QgPT0gJ2NvbnRhY3QnKXtcbiAgICAgICAgICAgIHZhciBlbCA9IMOpKCdoZWFkZXInKTtcbiAgICAgICAgICAgIGVsLmNsYXNzTmFtZSA9PSAnY2xpY2tlZCcgPyBlbC5jbGFzc05hbWUgPSAncmV2ZXJzZScgOiBlbC5jbGFzc05hbWUgPSAnY2xpY2tlZCc7XG4gICAgICAgIH1cbiAgICB9XG5cbn07XG5cbnZhciBBZ2UgPSB7XG5cbiAgICBjYWxjOiAoKSA9PiB7XG4gICAgICAgIHZhciBlbCA9IMOpKCd0aW1lJyk7XG4gICAgICAgIHZhciB0aW1lID0gZWwuZ2V0QXR0cmlidXRlKCdkYXRldGltZScpO1xuXG4gICAgICAgIHZhciB0b2RheSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIHZhciBub3cgPSBbXG4gICAgICAgICAgICB0b2RheS5nZXRGdWxsWWVhcigpLFxuICAgICAgICAgICAgdG9kYXkuZ2V0TW9udGgoKSsxLFxuICAgICAgICAgICAgKCcwJyArIHRvZGF5LmdldERhdGUoKSkuc2xpY2UoLTIpXG4gICAgICAgIF07XG4gICAgICAgIHZhciBiaXJ0aCA9IFtcbiAgICAgICAgICAgIHRpbWUuc2xpY2UoMCw0KSxcbiAgICAgICAgICAgIHRpbWUuc2xpY2UoNSw3KSxcbiAgICAgICAgICAgIHRpbWUuc2xpY2UoOCwxMClcbiAgICAgICAgXTtcblxuICAgICAgICBub3cgPSBub3cuam9pbignJyk7XG4gICAgICAgIGJpcnRoID0gYmlydGguam9pbignJyk7XG5cbiAgICAgICAgdmFyIGFnZSA9IChub3cgLSBiaXJ0aCkudG9TdHJpbmcoKS5zbGljZSgwLDIpO1xuICAgICAgICBlbC5pbm5lckhUTUwgPSBhZ2UgKyAnLCc7XG4gICAgfVxuXG59O1xuXG52YXIgUmVxdWVzdCA9IHtcblxuICAgIGlzSW5kZXg6ICgpID0+IHtcbiAgICAgICAgaWYgKGRvY3VtZW50LmxvY2F0aW9uLnBhdGhuYW1lID09ICcvJykge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgaXNQYWdlOiAodXJsKSA9PiB7XG4gICAgICAgIGlmIChkb2N1bWVudC5sb2NhdGlvbi5wYXRobmFtZSA9PSB1cmwpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG59O1xuXG52YXIgVGFibGVzID0ge1xuICAgIC8vIE5PVCBVU0VEIE9OIE1BSU4gUEFHRVxuXG4gICAgZ2lnTGlzdDogKG5hbWUsIGxvY2F0aW9uLCBkYXRlKSA9PiB7XG4gICAgICAgIHZhciBmcmFnID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuICAgICAgICB2YXIgbGlzdCA9IMOpKCcjZ2lnbGlzdCB0Ym9keScpO1xuICAgICAgICB2YXIgZ2lnID0gYDx0ZCBjbGFzcz1cIm1kbC1kYXRhLXRhYmxlX19jZWxsLS1ub24tbnVtZXJpYyBnaWctbmFtZVwiPlxuICAgICAgICAgICAgICAgICR7bmFtZX1cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8dGQgY2xhc3M9XCJtZGwtZGF0YS10YWJsZV9fY2VsbC0tbm9uLW51bWVyaWMgZ2lnLWxvY2F0aW9uXCI+XG4gICAgICAgICAgICAgICAgJHtsb2NhdGlvbn1cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8dGQgY2xhc3M9XCJnaWctZGF0ZVwiPiR7ZGF0ZX08L3RkPmA7XG5cbiAgICAgICAgdmFyIHRyID0gw6coJ3RyJyk7XG4gICAgICAgIHRyLmlubmVySFRNTCA9IGdpZztcbiAgICAgICAgZnJhZy5hcHBlbmRDaGlsZCh0cik7XG4gICAgICAgIGxpc3QuYXBwZW5kQ2hpbGQoZnJhZyk7XG4gICAgfSxcblxuICAgIGJlZXJMaXN0OiAoYnJld2VyeSwgYk5hbWUsIGJUeXBlLCBiQWJ2LCBiUmF0aW5nLCBiRGF0ZSkgPT4ge1xuICAgICAgICB2YXIgZnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgdmFyIGxpc3QgPSDDqSgnI2JlZXJsaXN0IHRib2R5Jyk7XG5cbiAgICAgICAgdmFyIGJyZXcgPSBgPHRkIGNsYXNzPVwibWRsLWRhdGEtdGFibGVfX2NlbGwtLW5vbi1udW1lcmljIGJyZXdlcnlcIj5cbiAgICAgICAgICAgICAgICAke2JyZXdlcnl9XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwibWRsLWRhdGEtdGFibGVfX2NlbGwtLW5vbi1udW1lcmljIGJlZXItbmFtZVwiPlxuICAgICAgICAgICAgICAgICR7Yk5hbWV9XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwibWRsLWRhdGEtdGFibGVfX2NlbGwtLW5vbi1udW1lcmljIGJlZXItdHlwZVwiPlxuICAgICAgICAgICAgICAgICR7YlR5cGV9XG4gICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwiYmVlci1hYnZcIj4ke2JBYnZ9PC90ZD5cbiAgICAgICAgICAgIDx0ZCBjbGFzcz1cImJlZXItcmF0aW5nXCI+JHtiUmF0aW5nfTwvdGQ+XG4gICAgICAgICAgICA8dGQgY2xhc3M9XCJiZWVyLWRhdGVcIj4ke2JEYXRlfTwvdGQ+YDtcblxuICAgICAgICB2YXIgdHIgPSDDpygndHInKTtcbiAgICAgICAgdHIuaW5uZXJIVE1MID0gYnJldztcbiAgICAgICAgZnJhZy5hcHBlbmRDaGlsZCh0cik7XG4gICAgICAgIGxpc3QuYXBwZW5kQ2hpbGQoZnJhZyk7XG4gICAgfVxuXG59O1xuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcbiAgICBSZW5kZXIuaW5pdCgpO1xufSk7XG4iXX0=
