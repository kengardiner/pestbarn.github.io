"use strict";var é=function(e){return document.querySelector(e)},ç=function(e){return document.createElement(e)},Parser=function(){function e(e){var t={ajax:function(e,t){var n=new Promise(function(n,r){var a=new XMLHttpRequest,i=t;a.open(e,i),a.send(),a.onload=function(){this.status>=200&&this.status<300?n(this.response):r(this.statusText)},a.onerror=function(){r(this.statusText)}});return n}};return{get:function(){return t.ajax("GET",e)}}}return{fetchContent:function(){function t(t,n){var r=n?t:"bin/js/json/"+t+".json",a={success:function(e){e=n?e:JSON.parse(e),n?Render.getPart(e,n):Render.buildList(e,t)},error:function(e){throw new Error(e)}};e(r).get().then(a.success).catch(a.error)}var n=new Map([["header","bin/partials/header.html"],[".contact","bin/partials/contact.html"],["aside","bin/partials/aside.html"]]),r=["experience"],a=!0,i=!1,s=void 0;try{for(var o,c=n[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var d=o.value;t(d[1],d[0])}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}var l=!0,u=!1,g=void 0;try{for(var f,m=r[Symbol.iterator]();!(l=(f=m.next()).done);l=!0){var h=f.value;t(h)}}catch(e){u=!0,g=e}finally{try{!l&&m.return&&m.return()}finally{if(u)throw g}}},fetchGigs:function(){var t="//spreadsheets.google.com/feeds/list/1Tf2vRy6me9F3knQSA5FpfvrTLuNetlkd0Mmb2P20Jqo/1/public/values?alt=json",n={success:function(e){var t=JSON.parse(e),n=t.feed.entry,r=t.feed.updated.$t;r="Last updated: "+r.substr(0,10),é("#attended-gigs .mdl-spinner").remove(),é("#gigs .mdl-tooltip").innerHTML=r;var a=document.getElementById("giglist");for(var i in n){var s=[n[i].gsx$headline.$t,n[i].gsx$text.$t,n[i].gsx$startdate.$t],o=s[0],c=s[1],d=s[2];if(i>0&&Tables.gigList(o,c,d),i==n.length-1){sorttable.makeSortable(a);var l={valueNames:["gig-name","gig-location","gig-date"]};new List("attended-gigs",l)}}},error:function(e){throw new Error(e)}};e(t).get().then(n.success).catch(n.error)},fetchBeer:function(){var t="//spreadsheets.google.com/feeds/list/1a056ruITWMr8oeJECb8QM6ePe00IqTTEIkrkhY-QeMI/1/public/values?alt=json",n={success:function(e){var t=JSON.parse(e),n=t.feed.entry,r=t.feed.updated.$t;r="Last updated: "+r.substr(0,10),é("#untappd-stats .mdl-spinner").remove(),é("#beers .mdl-tooltip").innerHTML=r;var a=document.getElementById("beerlist");for(var i in n){var s=[n[i].gsx$breweryname.$t,n[i].gsx$beername.$t,n[i].gsx$beertype.$t,n[i].gsx$beerabv.$t,n[i].gsx$ratingscore.$t,n[i].gsx$createdat.$t.substr(0,10)],o=s[0],c=s[1],d=s[2],l=s[3],u=s[4],g=s[5];if(i>0&&Tables.beerList(o,c,d,l,u,g),i==n.length-1){sorttable.makeSortable(a);var f={valueNames:["brewery","beer-name","beer-type","beer-abv","beer-rating","beer-date"]};new List("untappd-stats",f)}}},error:function(e){throw new Error(e)}};e(t).get().then(n.success).catch(n.error)}}}(),Render={settings:{createEl:"div",parentEl:"main"},buildList:function(e,t){function n(e,t,n){return e=ç(e),e.appendChild(document.createTextNode(t)),n&&e.setAttribute("href","//"+t),e}e=e.items;var r=é("."+t),a=ç("ul"),i=!0,s=!1,o=void 0;try{for(var c,d=e[Symbol.iterator]();!(i=(c=d.next()).done);i=!0){for(var l=c.value,u=ç("li"),g=[n("h2",l.title),n("h3",l.position),n("time",l.dateFrom),n("span","—"),n("time",l.dateTo),l.url&&n("a",l.url,1)],f=document.createDocumentFragment(),m=0;m<g.length;m++)g[m]&&f.appendChild(g[m]);u.appendChild(f),a.appendChild(u)}}catch(e){s=!0,o=e}finally{try{!i&&d.return&&d.return()}finally{if(s)throw o}}r.appendChild(a)},getPart:function(e,t){if(~t.indexOf(".")){t=t.substr(1);var n=ç(Render.settings.createEl);n.classList.add(t),n.innerHTML=e,n.onclick=Interact.toggleClicked;var r=é(Render.settings.parentEl);r.appendChild(n)}else{var a=é(t),i=ç(t);i.innerHTML=e,i.onclick=Interact.toggleClicked,document.body.replaceChild(i,a),~t.indexOf("header")&&Pizazz.check(),~t.indexOf("aside")&&Age.calc()}},init:function(){if(Request.isIndex()&&Parser.fetchContent(),Request.isPage("/stats/")){Parser.fetchGigs(),Parser.fetchBeer();var e=document.location.hash;e&&!function(){var t=é('a[href="'+e+'"]');window.addEventListener("load",function(){t.click()})}()}}},Interact={toggleClicked:function(e){var t=e.target.parentElement.nodeName,n=e.target.classList;if("HEADER"==t||"MAIN"==t||"locate"==n){var r=é("header");"clicked"==r.className?r.className="reverse":r.className="clicked"}}},Age={calc:function(){var e=é("time"),t=e.getAttribute("datetime"),n=new Date,r=n.getMonth()+1<=9?""+n.getMonth()+1:n.getMonth()+1,a=[n.getFullYear(),r,parseInt(("0"+n.getDate()).slice(-2))],i=[t.slice(0,4),t.slice(5,7),t.slice(8,10)];a=a.join(""),i=i.join("");var s=(a-i).toString().slice(0,2);e.innerHTML=s+","}},Request={isIndex:function(){if("/"==document.location.pathname)return!0},isPage:function(e){if(document.location.pathname==e)return!0}},Tables={gigList:function(e,t,n){var r=document.createDocumentFragment(),a=é("#giglist tbody"),i='<td class="mdl-data-table__cell--non-numeric gig-name">\n                '+e+'\n            </td>\n            <td class="mdl-data-table__cell--non-numeric gig-location">\n                '+t+'\n            </td>\n            <td class="gig-date">'+n+"</td>",s=ç("tr");s.innerHTML=i,r.appendChild(s),a.appendChild(r)},beerList:function(e,t,n,r,a,i){var s=document.createDocumentFragment(),o=é("#beerlist tbody"),c='<td class="mdl-data-table__cell--non-numeric brewery">\n                '+e+'\n            </td>\n            <td class="mdl-data-table__cell--non-numeric beer-name">\n                '+t+'\n            </td>\n            <td class="mdl-data-table__cell--non-numeric beer-type">\n                '+n+'\n            </td>\n            <td class="beer-abv">'+r+'</td>\n            <td class="beer-rating">'+a+'</td>\n            <td class="beer-date">'+i+"</td>",d=ç("tr");d.innerHTML=c,s.appendChild(d),o.appendChild(s)}},Pizazz={check:function(){var e=navigator.userAgent,t=e.indexOf("Firefox")!=-1||e.indexOf("Safari")!=-1,n=e.indexOf("Chrome")!=-1;if(t&&!n){var r=ç("img"),a="src/img/logotype.svg";r.setAttribute("src",a);var i=document.getElementById("logotype"),s=é("header");s.replaceChild(r,i)}}};window.addEventListener("DOMContentLoaded",function(){Render.init()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiw6kiLCJzZWxlY3RvciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIsOnIiwiY3JlYXRlRWxlbWVudCIsIiRodHRwIiwidXJsIiwiY29yZSIsImFqYXgiLCJtZXRob2QiLCJwcm9taXNlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJjbGllbnQiLCJYTUxIdHRwUmVxdWVzdCIsInVyaSIsIm9wZW4iLCJzZW5kIiwib25sb2FkIiwic3RhdHVzIiwidGhpcyIsIm9uZXJyb3IiLCJzdGF0dXNUZXh0IiwiZ2V0IiwiZmV0Y2hDb250ZW50IiwiZmV0Y2hGaWxlIiwiZiIsImUiLCJmaWxlIiwic3VjY2VzcyIsImRhdGEiLCJKU09OIiwicGFyc2UiLCJSZW5kZXIiLCJnZXRQYXJ0IiwiYnVpbGRMaXN0IiwiZXJyb3IiLCJFcnJvciIsInRoZW4iLCJjYWxsYmFjayIsImNhdGNoIiwicGFydGlhbHMiLCJNYXAiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uIiwiX2RpZEl0ZXJhdG9yRXJyb3IiLCJfaXRlcmF0b3JFcnJvciIsInVuZGVmaW5lZCIsIl9zdGVwIiwiX2l0ZXJhdG9yIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJuZXh0IiwiZG9uZSIsInBhcnQiLCJ2YWx1ZSIsImVyciIsInJldHVybiIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yIiwiX2RpZEl0ZXJhdG9yRXJyb3IyIiwiX2l0ZXJhdG9yRXJyb3IyIiwiX3N0ZXAyIiwiX2l0ZXJhdG9yMiIsImZpbGVzIiwiZmV0Y2hHaWdzIiwiZ2lncyIsImNlbGxzIiwidGl0bGUiLCJlbnRyeSIsImZlZWQiLCJ1cGRhdGVkIiwiJHQiLCJzdWJzdHIiLCJyZW1vdmUiLCJpbm5lckhUTUwiLCJzb3J0IiwiZ2V0RWxlbWVudEJ5SWQiLCJ0IiwiX3JlZiIsImdzeCRoZWFkbGluZSIsImdzeCR0ZXh0IiwiZ3N4JHN0YXJ0ZGF0ZSIsIm5hbWUiLCJsb2NhdGlvbiIsImRhdGUiLCJUYWJsZXMiLCJnaWdMaXN0IiwibGVuZ3RoIiwic29ydHRhYmxlIiwibWFrZVNvcnRhYmxlIiwib3B0aW9ucyIsInZhbHVlTmFtZXMiLCJMaXN0IiwiYmVlciIsIl9yZWYyIiwiZ3N4JGJyZXdlcnluYW1lIiwiZ3N4JGJlZXJ0eXBlIiwiYnJld2VyeSIsImJOYW1lIiwiYlR5cGUiLCJiZWVyTGlzdCIsImJBYnYiLCJiUmF0aW5nIiwiZGF0ZVRyaW0iLCJzZXR0aW5ncyIsImNyZWF0ZUVsIiwicGFyZW50RWwiLCJidWlsZCIsImVsZW1lbnQiLCJjb250ZW50IiwiYXR0ciIsImFwcGVuZENoaWxkIiwiY3JlYXRlVGV4dE5vZGUiLCJzZXRBdHRyaWJ1dGUiLCJpdGVtcyIsInBhcmVudCIsInVsIiwiX3N0ZXAzIiwiX2l0ZXJhdG9yMyIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zIiwibiIsImxpIiwidGVtcCIsInBvc2l0aW9uIiwiZGF0ZUZyb20iLCJkYXRlVG8iLCJjcmVhdGVEb2N1bWVudEZyYWdtZW50IiwiaSIsImRvY0ZyYWciLCJpbmRleE9mIiwiY2xhc3NMaXN0IiwiYWRkIiwib25jbGljayIsImVsZW0iLCJJbnRlcmFjdCIsInRvZ2dsZUNsaWNrZWQiLCJib2R5IiwicmVwbGFjZUNoaWxkIiwiUGl6YXp6IiwiY2hlY2siLCJBZ2UiLCJjYWxjIiwiaW5pdCIsIlJlcXVlc3QiLCJpc0luZGV4IiwiUGFyc2VyIiwiaXNQYWdlIiwiZmV0Y2hCZWVyIiwicmVsTGluayIsImhhc2giLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwiY2xpY2siLCJ0YXJnZXQiLCJwYXJlbnRFbGVtZW50Iiwibm9kZU5hbWUiLCJkaXYiLCJlbCIsImNsYXNzTmFtZSIsInRpbWUiLCJnZXRBdHRyaWJ1dGUiLCJ0b2RheSIsIkRhdGUiLCJnZXRNb250aCIsIm1vbnRoIiwicGFyc2VJbnQiLCJzbGljZSIsImJpcnRoIiwibm93Iiwiam9pbiIsImFnZSIsInRvU3RyaW5nIiwicGF0aG5hbWUiLCJmcmFnIiwidHIiLCJnaWciLCJsaXN0IiwiYkRhdGUiLCJicmV3IiwiY2hyb21lIiwic3ZnUmVwbGFjZSIsImltYWdlUmVwbGFjZW1lbnQiLCJzdmciLCJoZWFkZXIiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiXSwibWFwcGluZ3MiOiJZQUFBLElBQU1BLEdBQUksU0FBQUMsR0FBQSxNQUFZQyxVQUFTQyxjQUFjRixJQUN2Q0csRUFBSSxTQUFBSCxHQUFBLE1BQVlDLFVBQVNHLGNBQWNKLElBQXZDRyxPQUFJLFdBQVYsUUFBQUUsR0FBQUMsR0FPUSxHQUFNQyxJQUxkQyxLQUFBLFNBQUFDLEVBQUFILEdBT2dCLEdBQU1JLEdBQVUsR0FBSUMsU0FBUSxTQUFTQyxFQUFTQyxHQUw5QyxHQUFNQyxHQUFBLEdBQUFDLGdCQU9JQyxFQUFNVixDQUxiQSxHQUFJVyxLQUFBUixFQUFBTyxHQUNGRixFQUFBSSxPQUNISixFQUFBSyxPQUFDVixXQUNHQyxLQUFVVSxRQUFZLEtBQUFDLEtBQVNULE9BQVNDLElBQ3BDQyxFQUFTTyxLQUFJTixVQUVaRSxFQUFLUixLQUFRTyxhQUdoQkYsRUFBQVEsUUFBU0YsV0FDTFIsRUFBQUEsS0FBUVcsY0FHWCxPQUFBYixJQUdERyxRQUNIVyxJQUFBLFdBQ0osTUFmRGpCLEdBQUFDLEtBQUEsTUFBQUYsS0FvQkosT0FFQ21CLGFBQUEsV0FlNEIsUUFBQUMsR0FBQUMsRUFBQUMsR0FPekIsR0FBSUMsR0FBT0QsRUFBSUQsRUFBSSxlQUFlQSxFQUFFLFFBTnBDRCxHQUNISSxRQUFBLFNBQUFDLEdBWGVBLEVBQUFILEVBQUFHLEVBQUFDLEtBQUFDLE1BQUFGLEdBQUFILEVBQUFNLE9BQUFDLFFBQUFKLEVBQUFILEdBQUFNLE9BQUFFLFVBQUFMLEVBQUFKLElBQUFVLE1BQUEsU0FBQU4sR0FBQSxLQUFBLElBQUFPLE9BQUFQLElBQUExQixHQUFBd0IsR0FBQUwsTUFBQWUsS0FBQUMsRUFBQVYsU0FBQVcsTUFBQUQsRUFBQUgsT0FUcEIsR0FBQUssR0FBQSxHQUFBQyxPQUtILFNBQUEsNkJBT1ks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Y3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xuY29uc3Qgw6cgPSBzZWxlY3RvciA9PiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHNlbGVjdG9yKTtcblxuLyogZ2xvYmFsIHNvcnR0YWJsZSwgTGlzdCAqL1xuXG5jb25zdCBQYXJzZXIgPSAoKCkgPT4ge1xuXG4gICAgZnVuY3Rpb24gJGh0dHAodXJsKXtcbiAgICAgICAgY29uc3QgY29yZSA9IHtcbiAgICAgICAgICAgIGFqYXg6IChtZXRob2QsIHVybCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2xpZW50ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVyaSA9IHVybDtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50Lm9wZW4obWV0aG9kLCB1cmkpO1xuICAgICAgICAgICAgICAgICAgICBjbGllbnQuc2VuZCgpO1xuICAgICAgICAgICAgICAgICAgICBjbGllbnQub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID49IDIwMCAmJiB0aGlzLnN0YXR1cyA8IDMwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5yZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCh0aGlzLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBjbGllbnQub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCh0aGlzLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgJ2dldCc6ICgpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29yZS5hamF4KCdHRVQnLCB1cmwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgZmV0Y2hDb250ZW50OiAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgcGFydGlhbHMgPSBuZXcgTWFwKFtcbiAgICAgICAgICAgICAgICBbJ2hlYWRlcicsICdiaW4vcGFydGlhbHMvaGVhZGVyLmh0bWwnXSxcbiAgICAgICAgICAgICAgICBbJy5jb250YWN0JywgJ2Jpbi9wYXJ0aWFscy9jb250YWN0Lmh0bWwnXSxcbiAgICAgICAgICAgICAgICBbJ2FzaWRlJywgJ2Jpbi9wYXJ0aWFscy9hc2lkZS5odG1sJ11cbiAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgbGV0IGZpbGVzID0gW1xuICAgICAgICAgICAgICAgICdleHBlcmllbmNlJ1xuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcGFydCBvZiBwYXJ0aWFscykge1xuICAgICAgICAgICAgICAgIGZldGNoRmlsZShwYXJ0WzFdLCBwYXJ0WzBdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgICAgICAgICAgIGZldGNoRmlsZShmaWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZ1bmN0aW9uIGZldGNoRmlsZShmLCBlKSB7XG4gICAgICAgICAgICAgICAgbGV0IGZpbGUgPSBlID8gZiA6ICdiaW4vanMvanNvbi8nK2YrJy5qc29uJztcbiAgICAgICAgICAgICAgICBjb25zdCBjYWxsYmFjayA9IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0gZSA/IGRhdGEgOiBKU09OLnBhcnNlKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZW5kZXIuZ2V0UGFydChkYXRhLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBSZW5kZXIuYnVpbGRMaXN0KGRhdGEsIGYpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBlcnJvcjogZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICRodHRwKGZpbGUpLmdldCgpXG4gICAgICAgICAgICAgICAgLnRoZW4oY2FsbGJhY2suc3VjY2VzcylcbiAgICAgICAgICAgICAgICAuY2F0Y2goY2FsbGJhY2suZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBmZXRjaEdpZ3M6ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGdpZ3MgPSAnLy9zcHJlYWRzaGVldHMuZ29vZ2xlLmNvbS9mZWVkcy9saXN0LzFUZjJ2Unk2bWU5RjNrblFTQTVGcGZ2clRMdU5ldGxrZDBNbWIyUDIwSnFvLzEvcHVibGljL3ZhbHVlcz9hbHQ9anNvbic7XG5cbiAgICAgICAgICAgIGNvbnN0IGNhbGxiYWNrID0ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjZWxscyA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpdGxlID0gY2VsbHMuZmVlZC5lbnRyeTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHVwZGF0ZWQgPSBjZWxscy5mZWVkLnVwZGF0ZWQuJHQ7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZWQgPSBgTGFzdCB1cGRhdGVkOiAke3VwZGF0ZWQuc3Vic3RyKDAsMTApfWA7XG4gICAgICAgICAgICAgICAgICAgIMOpKCcjYXR0ZW5kZWQtZ2lncyAubWRsLXNwaW5uZXInKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgw6koJyNnaWdzIC5tZGwtdG9vbHRpcCcpLmlubmVySFRNTCA9IHVwZGF0ZWQ7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNvcnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2lnbGlzdCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHQgaW4gdGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBbbmFtZSwgbG9jYXRpb24sIGRhdGVdID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlW3RdLmdzeCRoZWFkbGluZS4kdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZVt0XS5nc3gkdGV4dC4kdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZVt0XS5nc3gkc3RhcnRkYXRlLiR0XG4gICAgICAgICAgICAgICAgICAgICAgICBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodCA+IDApIFRhYmxlcy5naWdMaXN0KG5hbWUsIGxvY2F0aW9uLCBkYXRlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQgPT0gdGl0bGUubGVuZ3RoLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3J0dGFibGUubWFrZVNvcnRhYmxlKHNvcnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlTmFtZXM6IFsnZ2lnLW5hbWUnLCAnZ2lnLWxvY2F0aW9uJywgJ2dpZy1kYXRlJ11cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBMaXN0KCdhdHRlbmRlZC1naWdzJywgb3B0aW9ucyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAkaHR0cChnaWdzKS5nZXQoKVxuICAgICAgICAgICAgLnRoZW4oY2FsbGJhY2suc3VjY2VzcylcbiAgICAgICAgICAgIC5jYXRjaChjYWxsYmFjay5lcnJvcik7XG4gICAgICAgIH0sXG4gICAgICAgIGZldGNoQmVlcjogKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgYmVlciA9ICcvL3NwcmVhZHNoZWV0cy5nb29nbGUuY29tL2ZlZWRzL2xpc3QvMWEwNTZydUlUV01yOG9lSkVDYjhRTTZlUGUwMElxVFRFSWtya2hZLVFlTUkvMS9wdWJsaWMvdmFsdWVzP2FsdD1qc29uJztcblxuICAgICAgICAgICAgY29uc3QgY2FsbGJhY2sgPSB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbGxzID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGl0bGUgPSBjZWxscy5mZWVkLmVudHJ5O1xuICAgICAgICAgICAgICAgICAgICBsZXQgdXBkYXRlZCA9IGNlbGxzLmZlZWQudXBkYXRlZC4kdDtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZCA9IGBMYXN0IHVwZGF0ZWQ6ICR7dXBkYXRlZC5zdWJzdHIoMCwxMCl9YDtcbiAgICAgICAgICAgICAgICAgICAgw6koJyN1bnRhcHBkLXN0YXRzIC5tZGwtc3Bpbm5lcicpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICDDqSgnI2JlZXJzIC5tZGwtdG9vbHRpcCcpLmlubmVySFRNTCA9IHVwZGF0ZWQ7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNvcnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmVlcmxpc3QnKTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCB0IGluIHRpdGxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZXdlcnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYk5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYlR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYkFidixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiUmF0aW5nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVUcmltXG4gICAgICAgICAgICAgICAgICAgICAgICBdID0gW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlW3RdLmdzeCRicmV3ZXJ5bmFtZS4kdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZVt0XS5nc3gkYmVlcm5hbWUuJHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGVbdF0uZ3N4JGJlZXJ0eXBlLiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlW3RdLmdzeCRiZWVyYWJ2LiR0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlW3RdLmdzeCRyYXRpbmdzY29yZS4kdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZVt0XS5nc3gkY3JlYXRlZGF0LiR0LnN1YnN0cigwLDEwKVxuICAgICAgICAgICAgICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQgPiAwKSBUYWJsZXMuYmVlckxpc3QoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJld2VyeSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiQWJ2LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJSYXRpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVRyaW1cbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodCA9PSB0aXRsZS5sZW5ndGgtMSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ydHRhYmxlLm1ha2VTb3J0YWJsZShzb3J0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZU5hbWVzOiBbJ2JyZXdlcnknLCAnYmVlci1uYW1lJywgJ2JlZXItdHlwZScsICdiZWVyLWFidicsICdiZWVyLXJhdGluZycsICdiZWVyLWRhdGUnXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IExpc3QoJ3VudGFwcGQtc3RhdHMnLCBvcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICRodHRwKGJlZXIpLmdldCgpXG4gICAgICAgICAgICAudGhlbihjYWxsYmFjay5zdWNjZXNzKVxuICAgICAgICAgICAgLmNhdGNoKGNhbGxiYWNrLmVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgfTtcblxufSkoKTtcblxuY29uc3QgUmVuZGVyID0ge1xuXG4gICAgc2V0dGluZ3M6IHtcbiAgICAgICAgY3JlYXRlRWw6ICdkaXYnLFxuICAgICAgICBwYXJlbnRFbDogJ21haW4nXG4gICAgfSxcblxuICAgIGJ1aWxkTGlzdDogKGRhdGEsIGYpID0+IHtcbiAgICAgICAgZGF0YSA9IGRhdGEuaXRlbXM7XG4gICAgICAgIGNvbnN0IHBhcmVudCA9IMOpKCcuJysgZik7XG4gICAgICAgIGNvbnN0IHVsID0gw6coJ3VsJyk7XG5cbiAgICAgICAgZnVuY3Rpb24gYnVpbGQoZWxlbWVudCwgY29udGVudCwgYXR0cikge1xuICAgICAgICAgICAgZWxlbWVudCA9IMOnKGVsZW1lbnQpO1xuICAgICAgICAgICAgZWxlbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjb250ZW50KSk7XG4gICAgICAgICAgICBhdHRyICYmIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdocmVmJywgJy8vJyArIGNvbnRlbnQpO1xuICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgZGF0YSkge1xuICAgICAgICAgICAgY29uc3QgbGkgPSDDpygnbGknKTtcblxuICAgICAgICAgICAgbGV0IHRlbXAgPSBbXG4gICAgICAgICAgICAgICAgYnVpbGQoJ2gyJywgbi50aXRsZSksXG4gICAgICAgICAgICAgICAgYnVpbGQoJ2gzJywgbi5wb3NpdGlvbiksXG4gICAgICAgICAgICAgICAgYnVpbGQoJ3RpbWUnLCBuLmRhdGVGcm9tKSxcbiAgICAgICAgICAgICAgICBidWlsZCgnc3BhbicsICfigJQnKSxcbiAgICAgICAgICAgICAgICBidWlsZCgndGltZScsIG4uZGF0ZVRvKSxcbiAgICAgICAgICAgICAgICBuLnVybCAmJiBidWlsZCgnYScsIG4udXJsLCAxKVxuICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgY29uc3QgZG9jRnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0ZW1wLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGVtcFtpXSAmJiBkb2NGcmFnLmFwcGVuZENoaWxkKHRlbXBbaV0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsaS5hcHBlbmRDaGlsZChkb2NGcmFnKTtcbiAgICAgICAgICAgIHVsLmFwcGVuZENoaWxkKGxpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZCh1bCk7XG4gICAgfSxcblxuICAgIGdldFBhcnQ6IChkYXRhLCBlKSA9PiB7XG4gICAgICAgIGlmICh+ZS5pbmRleE9mKCcuJykpIHtcblxuICAgICAgICAgICAgLy8gZSByZWZlcnMgdG8gYSBjbGFzc25hbWVcbiAgICAgICAgICAgIGUgPSBlLnN1YnN0cigxKTtcblxuICAgICAgICAgICAgLy8gY3JlYXRpbmcgYSBkaXYgd2l0aCBjbGFzc25hbWUgZVxuICAgICAgICAgICAgbGV0IHRlbXAgPSDDpyhSZW5kZXIuc2V0dGluZ3MuY3JlYXRlRWwpO1xuICAgICAgICAgICAgdGVtcC5jbGFzc0xpc3QuYWRkKGUpO1xuXG4gICAgICAgICAgICAvLyBhZGQgZGF0YSBhbmQgYXR0YWNoIGNsaWNrIGhhbmRsZXJcbiAgICAgICAgICAgIHRlbXAuaW5uZXJIVE1MID0gZGF0YTtcbiAgICAgICAgICAgIHRlbXAub25jbGljayA9IEludGVyYWN0LnRvZ2dsZUNsaWNrZWQ7XG5cbiAgICAgICAgICAgIC8vIGFwcGVuZCB0byBwYXJlbnQgPG1haW4+XG4gICAgICAgICAgICBjb25zdCBwYXJlbnQgPSDDqShSZW5kZXIuc2V0dGluZ3MucGFyZW50RWwpO1xuICAgICAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKHRlbXApO1xuXG4gICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgIC8vIGUgcmVmZXJzIHRvIGFuIGV4aXN0aW5nIGVsZW1lbnRcbiAgICAgICAgICAgIGNvbnN0IGVsZW0gPSDDqShlKTtcblxuICAgICAgICAgICAgLy8gY3JlYXRlIHRoZSAobmV3KSBlbGVtZW50XG4gICAgICAgICAgICBsZXQgdGVtcCA9IMOnKGUpO1xuXG4gICAgICAgICAgICAvLyBhZGQgZGF0YVxuICAgICAgICAgICAgdGVtcC5pbm5lckhUTUwgPSBkYXRhO1xuXG4gICAgICAgICAgICB0ZW1wLm9uY2xpY2sgPSBJbnRlcmFjdC50b2dnbGVDbGlja2VkO1xuXG4gICAgICAgICAgICAvLyByZXBsYWNlIGV4aXN0aW5nIGVsZW1lbnQgd2l0aCBuZXdcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVwbGFjZUNoaWxkKHRlbXAsIGVsZW0pO1xuICAgICAgICAgICAgaWYofmUuaW5kZXhPZignaGVhZGVyJykpIFBpemF6ei5jaGVjaygpO1xuICAgICAgICAgICAgaWYofmUuaW5kZXhPZignYXNpZGUnKSkgQWdlLmNhbGMoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBpbml0OiAoKSA9PiB7XG4gICAgICAgIGlmIChSZXF1ZXN0LmlzSW5kZXgoKSkgUGFyc2VyLmZldGNoQ29udGVudCgpO1xuICAgICAgICBpZiAoUmVxdWVzdC5pc1BhZ2UoJy9zdGF0cy8nKSl7XG4gICAgICAgICAgICBQYXJzZXIuZmV0Y2hHaWdzKCk7XG4gICAgICAgICAgICBQYXJzZXIuZmV0Y2hCZWVyKCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGhhc2ggPSBkb2N1bWVudC5sb2NhdGlvbi5oYXNoO1xuICAgICAgICAgICAgaWYgKGhhc2gpIHtcbiAgICAgICAgICAgICAgICBsZXQgcmVsTGluayA9IMOpKCdhW2hyZWY9XCInKyBoYXNoICsnXCJdJyk7XG4gICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJlbExpbmsuY2xpY2soKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufTtcblxuY29uc3QgSW50ZXJhY3QgPSB7XG5cbiAgICB0b2dnbGVDbGlja2VkOiAoZSkgPT4ge1xuICAgICAgICBjb25zdCBwYXJlbnQgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50Lm5vZGVOYW1lO1xuICAgICAgICBjb25zdCBkaXYgPSBlLnRhcmdldC5jbGFzc0xpc3Q7XG4gICAgICAgIGlmKHBhcmVudCA9PSAnSEVBREVSJyB8fCBwYXJlbnQgPT0gJ01BSU4nIHx8IGRpdiA9PSAnbG9jYXRlJyl7XG4gICAgICAgICAgICBjb25zdCBlbCA9IMOpKCdoZWFkZXInKTtcbiAgICAgICAgICAgIGVsLmNsYXNzTmFtZSA9PSAnY2xpY2tlZCcgPyBlbC5jbGFzc05hbWUgPSAncmV2ZXJzZScgOiBlbC5jbGFzc05hbWUgPSAnY2xpY2tlZCc7XG4gICAgICAgIH1cbiAgICB9XG5cbn07XG5cbmNvbnN0IEFnZSA9IHtcblxuICAgIGNhbGM6ICgpID0+IHtcbiAgICAgICAgY29uc3QgZWwgPSDDqSgndGltZScpO1xuICAgICAgICBjb25zdCB0aW1lID0gZWwuZ2V0QXR0cmlidXRlKCdkYXRldGltZScpO1xuICAgICAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGNvbnN0IG1vbnRoID0gdG9kYXkuZ2V0TW9udGgoKSsxIDw9IDkgPyAnJyt0b2RheS5nZXRNb250aCgpKzEgOiB0b2RheS5nZXRNb250aCgpKzE7XG5cbiAgICAgICAgbGV0IG5vdyA9IFtcbiAgICAgICAgICAgIHRvZGF5LmdldEZ1bGxZZWFyKCksXG4gICAgICAgICAgICBtb250aCxcbiAgICAgICAgICAgIHBhcnNlSW50KCgnMCcgKyB0b2RheS5nZXREYXRlKCkpLnNsaWNlKC0yKSlcbiAgICAgICAgXTtcbiAgICAgICAgbGV0IGJpcnRoID0gW1xuICAgICAgICAgICAgdGltZS5zbGljZSgwLDQpLFxuICAgICAgICAgICAgdGltZS5zbGljZSg1LDcpLFxuICAgICAgICAgICAgdGltZS5zbGljZSg4LDEwKVxuICAgICAgICBdO1xuXG4gICAgICAgIG5vdyA9IG5vdy5qb2luKCcnKTtcbiAgICAgICAgYmlydGggPSBiaXJ0aC5qb2luKCcnKTtcblxuICAgICAgICBjb25zdCBhZ2UgPSAobm93IC0gYmlydGgpLnRvU3RyaW5nKCkuc2xpY2UoMCwyKTtcbiAgICAgICAgZWwuaW5uZXJIVE1MID0gYWdlICsgJywnO1xuICAgIH1cblxufTtcblxuY29uc3QgUmVxdWVzdCA9IHtcblxuICAgIGlzSW5kZXg6ICgpID0+IHtcbiAgICAgICAgaWYgKGRvY3VtZW50LmxvY2F0aW9uLnBhdGhuYW1lID09ICcvJykge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgaXNQYWdlOiAodXJsKSA9PiB7XG4gICAgICAgIGlmIChkb2N1bWVudC5sb2NhdGlvbi5wYXRobmFtZSA9PSB1cmwpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG59O1xuXG5jb25zdCBUYWJsZXMgPSB7XG4gICAgLy8gTk9UIFVTRUQgT04gTUFJTiBQQUdFXG5cbiAgICBnaWdMaXN0OiAobmFtZSwgbG9jYXRpb24sIGRhdGUpID0+IHtcbiAgICAgICAgY29uc3QgZnJhZyA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgY29uc3QgbGlzdCA9IMOpKCcjZ2lnbGlzdCB0Ym9keScpO1xuICAgICAgICBsZXQgZ2lnID0gYDx0ZCBjbGFzcz1cIm1kbC1kYXRhLXRhYmxlX19jZWxsLS1ub24tbnVtZXJpYyBnaWctbmFtZVwiPlxuICAgICAgICAgICAgICAgICR7bmFtZX1cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8dGQgY2xhc3M9XCJtZGwtZGF0YS10YWJsZV9fY2VsbC0tbm9uLW51bWVyaWMgZ2lnLWxvY2F0aW9uXCI+XG4gICAgICAgICAgICAgICAgJHtsb2NhdGlvbn1cbiAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8dGQgY2xhc3M9XCJnaWctZGF0ZVwiPiR7ZGF0ZX08L3RkPmA7XG5cbiAgICAgICAgY29uc3QgdHIgPSDDpygndHInKTtcbiAgICAgICAgdHIuaW5uZXJIVE1MID0gZ2lnO1xuICAgICAgICBmcmFnLmFwcGVuZENoaWxkKHRyKTtcbiAgICAgICAgbGlzdC5hcHBlbmRDaGlsZChmcmFnKTtcbiAgICB9LFxuXG4gICAgYmVlckxpc3Q6IChicmV3ZXJ5LCBiTmFtZSwgYlR5cGUsIGJBYnYsIGJSYXRpbmcsIGJEYXRlKSA9PiB7XG4gICAgICAgIGNvbnN0IGZyYWcgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgIGNvbnN0IGxpc3QgPSDDqSgnI2JlZXJsaXN0IHRib2R5Jyk7XG4gICAgICAgIGxldCBicmV3ID0gYDx0ZCBjbGFzcz1cIm1kbC1kYXRhLXRhYmxlX19jZWxsLS1ub24tbnVtZXJpYyBicmV3ZXJ5XCI+XG4gICAgICAgICAgICAgICAgJHticmV3ZXJ5fVxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDx0ZCBjbGFzcz1cIm1kbC1kYXRhLXRhYmxlX19jZWxsLS1ub24tbnVtZXJpYyBiZWVyLW5hbWVcIj5cbiAgICAgICAgICAgICAgICAke2JOYW1lfVxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDx0ZCBjbGFzcz1cIm1kbC1kYXRhLXRhYmxlX19jZWxsLS1ub24tbnVtZXJpYyBiZWVyLXR5cGVcIj5cbiAgICAgICAgICAgICAgICAke2JUeXBlfVxuICAgICAgICAgICAgPC90ZD5cbiAgICAgICAgICAgIDx0ZCBjbGFzcz1cImJlZXItYWJ2XCI+JHtiQWJ2fTwvdGQ+XG4gICAgICAgICAgICA8dGQgY2xhc3M9XCJiZWVyLXJhdGluZ1wiPiR7YlJhdGluZ308L3RkPlxuICAgICAgICAgICAgPHRkIGNsYXNzPVwiYmVlci1kYXRlXCI+JHtiRGF0ZX08L3RkPmA7XG5cbiAgICAgICAgY29uc3QgdHIgPSDDpygndHInKTtcbiAgICAgICAgdHIuaW5uZXJIVE1MID0gYnJldztcbiAgICAgICAgZnJhZy5hcHBlbmRDaGlsZCh0cik7XG4gICAgICAgIGxpc3QuYXBwZW5kQ2hpbGQoZnJhZyk7XG4gICAgfVxuXG59O1xuXG5jb25zdCBQaXphenogPSB7XG4gICAgLy8gZmFsbGJhY2tzIGZvciB2aXN1YWwgZ29vZGllc1xuICAgIGNoZWNrOiAoKSA9PiB7XG4gICAgICAgIGxldCBuID0gbmF2aWdhdG9yLnVzZXJBZ2VudDtcbiAgICAgICAgLy8geWVhaCB5ZWFoLCBzaG91bGRuJ3QgdXNlIGJyb3dzZXIgc25pZmZpbmcsIGJ1dCB3aGF0ZXZlci4uLlxuICAgICAgICBjb25zdCBicm93c2VyID0gKG4uaW5kZXhPZignRmlyZWZveCcpICE9IC0xIHx8IG4uaW5kZXhPZignU2FmYXJpJykgIT0gLTEpO1xuICAgICAgICBjb25zdCBjaHJvbWUgPSBuLmluZGV4T2YoJ0Nocm9tZScpICE9IC0xO1xuXG4gICAgICAgIGlmIChicm93c2VyICYmICFjaHJvbWUpIHtcbiAgICAgICAgICAgIGxldCBzdmdSZXBsYWNlID0gw6coJ2ltZycpO1xuICAgICAgICAgICAgY29uc3QgaW1hZ2VSZXBsYWNlbWVudCA9ICdzcmMvaW1nL2xvZ290eXBlLnN2Zyc7XG4gICAgICAgICAgICBzdmdSZXBsYWNlLnNldEF0dHJpYnV0ZSgnc3JjJywgaW1hZ2VSZXBsYWNlbWVudCk7XG5cbiAgICAgICAgICAgIGNvbnN0IHN2ZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dvdHlwZScpO1xuICAgICAgICAgICAgY29uc3QgaGVhZGVyID0gw6koJ2hlYWRlcicpO1xuXG4gICAgICAgICAgICBoZWFkZXIucmVwbGFjZUNoaWxkKHN2Z1JlcGxhY2UsIHN2Zyk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcbiAgICBSZW5kZXIuaW5pdCgpO1xufSk7XG4iXX0=
